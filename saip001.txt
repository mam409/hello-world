mike was here

USE [master]
GOONSTRAINT [DF_detail_check_timestamp]  DEFAULT (getdate()),
 CONSTRAINT [aaa_detail_check_target_PK] PRIMARY KEY NONCLUSTERED 
(
	[DataVersion] ASC,
	[Fund] ASC,
	[market] ASC,
	[LOB] ASC,
	[Segment] ASC,
	[Product] ASC,
	[yr] ASC,
	[bus_unit] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 80) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[history_LE]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[history_LE](
	[DataVersion] [varchar](15) NOT NULL,
	[sai_id] [int] NOT NULL,
	[Fund] [varchar](2) NOT NULL,
	[market] [varchar](30) NOT NULL,
	[LOB] [varchar](2) NOT NULL,
	[Segment] [varchar](15) NOT NULL,
	[Product] [varchar](15) NOT NULL,
	[med_pmpm] [decimal](9, 5) NOT NULL,
	[rx_pmpm] [decimal](9, 5) NOT NULL,
	[original_create_dt] [datetime] NULL,
	[Last_Updated_dt] [datetime] NULL,
	[last_updated_by] [varchar](50) NULL,
	[Comments] [varchar](255) NULL,
	[qb_record_id] [int] NULL,
	[history_date_added] [datetime] NULL CONSTRAINT [DF_t_hLE_date_added_dt]  DEFAULT (getdate()),
 CONSTRAINT [aaaaat_histLE_PK] PRIMARY KEY NONCLUSTERED 
(
	[DataVersion] ASC,
	[sai_id] ASC,
	[Fund] ASC,
	[market] ASC,
	[LOB] ASC,
	[Segment] ASC,
	[Product] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 80) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[history_membership]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[history_membership](
	[DataVersion] [varchar](15) NOT NULL,
	[company] [varchar](15) NOT NULL,
	[fund] [varchar](2) NOT NULL,
	[market] [varchar](30) NOT NULL,
	[lob] [varchar](2) NOT NULL,
	[segment] [varchar](15) NOT NULL,
	[product] [varchar](15) NOT NULL,
	[yrmo] [varchar](15) NOT NULL,
	[med_mems] [int] NOT NULL,
	[rx_mems] [int] NOT NULL,
	[plan_mkt_cd] [varchar](6) NOT NULL,
 CONSTRAINT [aaaaat_hmembership_new_regions_PK] PRIMARY KEY NONCLUSTERED 
(
	[DataVersion] ASC,
	[company] ASC,
	[fund] ASC,
	[market] ASC,
	[lob] ASC,
	[segment] ASC,
	[product] ASC,
	[yrmo] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 80) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[history_targets]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[history_targets](
	[DataVersion] [varchar](15) NOT NULL,
	[market] [varchar](30) NOT NULL,
	[bus_unit] [varchar](25) NOT NULL,
	[company] [varchar](15) NOT NULL,
	[fund] [varchar](15) NOT NULL,
	[lob] [varchar](15) NOT NULL,
	[segment] [varchar](15) NOT NULL,
	[product] [varchar](15) NOT NULL,
	[yr] [int] NOT NULL,
	[target_based_on_med_mem] [decimal](10, 6) NOT NULL,
	[target_based_on_rx_mem] [decimal](10, 6) NOT NULL,
 CONSTRAINT [aaaaat_history_targets_PK] PRIMARY KEY NONCLUSTERED 
(
	[DataVersion] ASC,
	[market] ASC,
	[bus_unit] ASC,
	[company] ASC,
	[fund] ASC,
	[lob] ASC,
	[segment] ASC,
	[product] ASC,
	[yr] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 80) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[lku_market]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[lku_market](
	[market] [varchar](30) NOT NULL,
	[Desc] [varchar](255) NOT NULL,
	[reg] [varchar](15) NOT NULL,
	[plan_mkt_cd] [varchar](6) NOT NULL,
	[NatDb_Nm] [varchar](30) NOT NULL,
	[MajMkt_Nm] [varchar](30) NOT NULL,
	[MajMkt_Id] [varchar](2) NOT NULL,
	[State] [varchar](2) NOT NULL,
	[emis_market_name] [varchar](50) NOT NULL,
	[old_region] [char](2) NULL,
	[MajMkt_Nm_Commercial] [varchar](30) NULL,
	[MajMkt_Nm_Medicare] [varchar](30) NULL,
	[reg_Commercial] [varchar](15) NULL,
	[reg_Medicare] [varchar](15) NULL,
PRIMARY KEY CLUSTERED 
(
	[market] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 80) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[lku_months]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[lku_months](
	[yrmo] [char](6) NOT NULL,
	[first_dt] [datetime] NOT NULL,
	[last_dt] [datetime] NOT NULL,
	[mo_seq] [int] NOT NULL,
	[yr] [smallint] NOT NULL,
	[qtr] [smallint] NOT NULL,
	[yr_qtr] [char](7) NOT NULL,
	[Stop_mo] [char](6) NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[yrmo] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 80) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[lku_product]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[lku_product](
	[LOB] [varchar](2) NOT NULL,
	[Product] [varchar](15) NOT NULL,
	[Desc] [varchar](255) NOT NULL,
 CONSTRAINT [aaaaalku_product_PK] PRIMARY KEY NONCLUSTERED 
(
	[LOB] ASC,
	[Product] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 80) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[lku_region]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[lku_region](
	[reg] [varchar](15) NOT NULL,
	[Desc] [varchar](255) NULL,
PRIMARY KEY CLUSTERED 
(
	[reg] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 80) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[lku_segment]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[lku_segment](
	[Segment] [varchar](15) NOT NULL,
	[Desc] [varchar](255) NOT NULL,
	[Lob] [varchar](2) NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[Segment] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 80) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[lku_status]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[lku_status](
	[Status] [varchar](25) NOT NULL,
	[Sequence] [smallint] NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[Status] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 80) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[lku_System]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[lku_System](
	[id] [int] NOT NULL,
	[Start_YYYYMM_Report] [varchar](255) NULL,
	[Stop_YYYYMM_Report] [varchar](255) NULL,
	[version] [varchar](255) NULL,
	[Current_Year] [varchar](4) NULL,
	[sai_data_location] [varchar](255) NULL,
	[execdb_current_year] [smallint] NULL,
 CONSTRAINT [PK_lku_System] PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 80) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[lku_System_SqlServer]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[lku_System_SqlServer](
	[id] [int] NOT NULL,
	[version_updater] [varchar](50) NOT NULL,
	[version_flex] [varchar](50) NOT NULL,
	[version_membership] [varchar](50) NOT NULL,
	[version_sai_pivot] [varchar](50) NOT NULL,
	[version_market_xtab] [varchar](50) NOT NULL,
 CONSTRAINT [PK_lkuSystem_SqlServer] PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 80) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[lku_users]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[lku_users](
	[AetnaId] [varchar](7) NOT NULL,
	[DisplayName] [varchar](75) NOT NULL,
	[UserEmail] [varchar](100) NOT NULL,
	[UserLastName] [varchar](50) NOT NULL,
	[UserFirstName] [varchar](50) NOT NULL,
	[switchboard_where_statement] [varchar](255) NULL,
	[user_bus_unit] [varchar](30) NULL,
	[user_bus_unit2] [varchar](30) NULL,
	[added_by] [varchar](50) NULL,
	[added_date] [datetime] NULL CONSTRAINT [DF_lku_users_added_date]  DEFAULT (getdate()),
	[Active_Employee] [bit] NULL CONSTRAINT [DF_lku_users_Active_Employee]  DEFAULT ((1)),
	[access_level] [varchar](10) NULL,
 CONSTRAINT [aaaat_AetnaId_PK] PRIMARY KEY NONCLUSTERED 
(
	[AetnaId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 80) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[lku_work_grp]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[lku_work_grp](
	[work_grp] [varchar](50) NOT NULL,
	[work_grp_alt_name] [varchar](50) NOT NULL,
	[wg_lead] [varchar](50) NOT NULL,
	[wg_reporting_lead] [varchar](50) NOT NULL,
	[bus_unit] [varchar](50) NOT NULL,
	[Business_Unit_Description] [varchar](255) NOT NULL,
	[bus_unit_lead] [varchar](50) NOT NULL,
	[Business_Unit_Alt_Name] [varchar](50) NOT NULL,
	[memmo_denom] [varchar](255) NOT NULL,
	[Members_and_Medical_Cost_-_Local_Market] [varchar](255) NOT NULL,
	[reg] [varchar](15) NOT NULL,
	[database] [varchar](255) NOT NULL,
	[bus_unit_display_name] [varchar](50) NULL,
	[roll_me_up_to_this_display_name] [varchar](50) NULL,
	[display_order] [numeric](3, 1) NULL,
PRIMARY KEY CLUSTERED 
(
	[work_grp] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 80) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[n_membership]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[n_membership](
	[company] [varchar](15) NOT NULL,
	[fund] [char](2) NOT NULL,
	[market] [varchar](30) NOT NULL,
	[lob] [char](2) NOT NULL,
	[segment] [varchar](15) NOT NULL,
	[product] [varchar](15) NOT NULL,
	[yrmo] [varchar](15) NOT NULL,
	[med_mems] [int] NOT NULL,
	[rx_mems] [int] NOT NULL,
	[plan_mkt_cd] [varchar](6) NOT NULL,
 CONSTRAINT [aaaaat_membership_nocat_PK] PRIMARY KEY CLUSTERED 
(
	[company] ASC,
	[fund] ASC,
	[market] ASC,
	[lob] ASC,
	[segment] ASC,
	[product] ASC,
	[yrmo] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 80) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[rcw_var_date]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[rcw_var_date](
	[DisplayName] [varchar](75) NULL,
	[added_date] [date] NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[rcw_var_embedded_blk]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[rcw_var_embedded_blk](
	[DisplayName] [varchar](75) NULL,
	[Active_Employee] [smallint] NULL
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[t_LE]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[t_LE](
	[sai_id] [int] NOT NULL,
	[Fund] [varchar](2) NOT NULL,
	[market] [varchar](30) NOT NULL,
	[LOB] [varchar](2) NOT NULL,
	[Segment] [varchar](15) NOT NULL,
	[Product] [varchar](15) NOT NULL,
	[med_pmpm] [decimal](9, 5) NOT NULL,
	[rx_pmpm] [decimal](9, 5) NOT NULL,
	[original_create_dt] [datetime] NOT NULL CONSTRAINT [DF_1t_LE_original_create_dt]  DEFAULT (getdate()),
	[Last_Updated_dt] [datetime] NOT NULL CONSTRAINT [DF_t_1LE_Last_Updated_dt]  DEFAULT (getdate()),
	[last_updated_by] [varchar](50) NULL,
	[Comments] [varchar](255) NULL,
	[qb_record_id] [int] NULL,
 CONSTRAINT [aaaaa1t_LE_PK] PRIMARY KEY CLUSTERED 
(
	[sai_id] ASC,
	[Fund] ASC,
	[market] ASC,
	[LOB] ASC,
	[Segment] ASC,
	[Product] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 80) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[t_LE_test]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[t_LE_test](
	[sai_id] [int] NOT NULL,
	[Fund] [varchar](2) NOT NULL,
	[market] [varchar](30) NOT NULL,
	[LOB] [varchar](2) NOT NULL,
	[Segment] [varchar](15) NOT NULL,
	[Product] [varchar](15) NOT NULL,
	[med_pmpm] [float] NOT NULL,
	[rx_pmpm] [float] NOT NULL,
	[original_create_dt] [datetime] NULL CONSTRAINT [DF_t_LE_original_create_dtbbb]  DEFAULT (getdate()),
	[Last_Updated_dt] [datetime] NULL CONSTRAINT [DF_t_LE_Last_Updated_dtbbb]  DEFAULT (getdate()),
	[last_updated_by] [varchar](50) NULL,
	[Comments] [varchar](255) NULL,
	[qb_record_id] [int] NULL,
 CONSTRAINT [aaaaat_LE_PKbbb] PRIMARY KEY NONCLUSTERED 
(
	[sai_id] ASC,
	[Fund] ASC,
	[market] ASC,
	[LOB] ASC,
	[Segment] ASC,
	[Product] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 80) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[t_SAI]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[t_SAI](
	[sai_id] [int] IDENTITY(1,1) NOT NULL,
	[Company] [varchar](15) NOT NULL,
	[sai_name] [varchar](250) NOT NULL,
	[sai_description] [varchar](250) NOT NULL,
	[Implementation_Date_Target] [datetime] NOT NULL,
	[Savings_Realization_Start_Date] [varchar](7) NOT NULL,
	[work_grp] [varchar](50) NOT NULL,
	[sai_owner] [varchar](50) NOT NULL,
	[Status] [varchar](25) NOT NULL,
	[Confidence_Level] [varchar](25) NULL,
	[SGA_Funding_Required] [bit] NOT NULL DEFAULT ((0)),
	[SR_IT_Required] [bit] NOT NULL DEFAULT ((0)),
	[Affects_Gross_Trend] [bit] NOT NULL DEFAULT ((1)),
	[Synergy] [bit] NOT NULL DEFAULT ((0)),
	[Projected_FI_ACAS_PMPM] [float] NULL DEFAULT ((0)),
	[Projected_FI_HMO_PMPM] [float] NULL DEFAULT ((0)),
	[Projected_SI_ACAS_PMPM] [float] NULL DEFAULT ((0)),
	[Projected_SI_HMO_PMPM] [float] NULL DEFAULT ((0)),
	[Projected_Medicare_Group_PMPM] [float] NULL DEFAULT ((0)),
	[Projected_Medicare_Retiree_PMPM] [float] NULL DEFAULT ((0)),
	[Projected_HIX_HPO_PMPM] [float] NULL DEFAULT ((0)),
	[fi] [bit] NOT NULL DEFAULT ((0)),
	[si] [bit] NOT NULL DEFAULT ((0)),
	[medicare_ind] [bit] NOT NULL DEFAULT ((0)),
	[hix_ind] [bit] NOT NULL DEFAULT ((0)),
	[SAI_Sizing_Supplement_Document] [varchar](255) NULL,
	[original_create_dt] [datetime] NULL DEFAULT (getdate()),
	[Last_Updated_dt] [datetime] NULL DEFAULT (getdate()),
	[last_updated_by] [varchar](50) NULL,
	[QB_SAI_ID] [varchar](25) NULL,
	[Medical_Cost_Category] [varchar](25) NOT NULL,
	[Unit_Cost_or_Utilization] [varchar](25) NOT NULL,
	[Comments] [varchar](255) NULL,
	[app_name] [varchar](25) NULL,
	[qb_record_id] [int] NULL,
	[geog_type] [varchar](25) NULL,
	[based_on_dollars] [bit] NOT NULL DEFAULT ((0)),
	[tags] [varchar](255) NULL,
	[CBU_Ind] [bit] NOT NULL CONSTRAINT [DF_t_SAI_CBU_Ind]  DEFAULT ((0)),
	[Projected_CBU_HPO_PMPM] [float] NULL CONSTRAINT [DF_t_SAI_Projected_CBU_HPO_PMPM]  DEFAULT ((0)),
 CONSTRAINT [aaaaat_SAI_PK] PRIMARY KEY NONCLUSTERED 
(
	[sai_id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 80) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[t_targets]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[t_targets](
	[market] [varchar](30) NOT NULL,
	[bus_unit] [varchar](25) NOT NULL,
	[company] [varchar](15) NOT NULL,
	[fund] [varchar](15) NOT NULL,
	[lob] [varchar](15) NOT NULL,
	[segment] [varchar](15) NOT NULL,
	[product] [varchar](15) NOT NULL,
	[yr] [int] NOT NULL,
	[target_based_on_med_mem] [decimal](10, 6) NOT NULL,
	[target_based_on_rx_mem] [decimal](10, 6) NOT NULL,
 CONSTRAINT [aaaaat_targets_PK] PRIMARY KEY NONCLUSTERED 
(
	[market] ASC,
	[bus_unit] ASC,
	[company] ASC,
	[fund] ASC,
	[lob] ASC,
	[segment] ASC,
	[product] ASC,
	[yr] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 80) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[tbl_Tableau_Chunk_Geographic]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[tbl_Tableau_Chunk_Geographic](
	[ZIP_CD] [nvarchar](255) NULL,
	[PLAN_MKT_CD] [nvarchar](255) NULL,
	[Plan_Market] [nvarchar](255) NULL,
	[Market_Head] [nvarchar](255) NULL,
	[Market_Head_Medicare] [nvarchar](255) NULL,
	[Territory] [nvarchar](255) NULL,
	[Territory_Medicare] [nvarchar](255) NULL,
	[Company] [nvarchar](255) NULL,
	[Medical_or_Rx] [nvarchar](255) NULL,
	[Business_Unit] [nvarchar](255) NULL,
	[LOB_Seg_Prod] [nvarchar](255) NULL,
	[monthly_membership] [float] NULL,
	[Dollars] [float] NULL,
	[Dollars_Target] [float] NULL,
	[SAI_Name_and_No] [nvarchar](255) NULL
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[tbl_Tableau_Chunk_Membership]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[tbl_Tableau_Chunk_Membership](
	[ZIP_CD] [nvarchar](255) NULL,
	[PLAN_MKT_CD] [nvarchar](255) NULL,
	[Plan_Market] [nvarchar](255) NULL,
	[Market_Head] [nvarchar](255) NULL,
	[Market_Head_Medicare] [nvarchar](255) NULL,
	[Territory] [nvarchar](255) NULL,
	[Territory_Medicare] [nvarchar](255) NULL,
	[Company] [nvarchar](255) NULL,
	[Medical_or_Rx] [nvarchar](255) NULL,
	[Business_Unit] [nvarchar](255) NULL,
	[LOB_Seg_Prod] [nvarchar](255) NULL,
	[monthly_membership] [float] NULL,
	[Dollars] [float] NULL,
	[Dollars_Target] [float] NULL,
	[SAI_Name_and_No] [nvarchar](255) NULL
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[tbl_Tableau_Chunk_Target_Dollars]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[tbl_Tableau_Chunk_Target_Dollars](
	[ZIP_CD] [nvarchar](255) NULL,
	[plan_mkt_cd] [nvarchar](255) NULL,
	[Plan_Market] [nvarchar](255) NULL,
	[Market_Head] [nvarchar](255) NULL,
	[Market_Head_Medicare] [nvarchar](255) NULL,
	[Territory] [nvarchar](255) NULL,
	[Territory_Medicare] [nvarchar](255) NULL,
	[Company] [nvarchar](255) NULL,
	[Medical_or_Rx] [nvarchar](255) NULL,
	[Business_Unit] [nvarchar](255) NULL,
	[LOB_Seg_Prod] [nvarchar](255) NULL,
	[monthly_membership] [float] NULL,
	[Dollars] [float] NULL,
	[Dollars_Target] [float] NULL,
	[SAI_Name_and_No] [nvarchar](255) NULL
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[zzJul31lku_System_data]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[zzJul31lku_System_data](
	[id] [smallint] NOT NULL,
	[version] [varchar](25) NOT NULL,
	[updater_version] [varchar](25) NOT NULL,
	[reporting_version] [varchar](25) NOT NULL,
	[asof] [datetime] NOT NULL,
	[archive_date] [datetime] NOT NULL,
	[subcat] [varchar](25) NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 80) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[zzJul31q_mem_year_con]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[zzJul31q_mem_year_con](
	[company] [varchar](15) NOT NULL,
	[fund] [varchar](15) NOT NULL,
	[lob] [varchar](15) NOT NULL,
	[segment] [varchar](15) NOT NULL,
	[yr] [varchar](4) NOT NULL,
	[med_mems_con] [int] NOT NULL,
	[rx_mems_con] [int] NOT NULL,
 CONSTRAINT [aaaaaq_mem_year_con_PK] PRIMARY KEY NONCLUSTERED 
(
	[company] ASC,
	[fund] ASC,
	[lob] ASC,
	[segment] ASC,
	[yr] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 80) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[zzJul31t_membership]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[zzJul31t_membership](
	[Category] [varchar](15) NOT NULL,
	[company] [varchar](15) NOT NULL,
	[fund] [varchar](2) NOT NULL,
	[reg] [varchar](15) NOT NULL,
	[MH] [varchar](50) NOT NULL,
	[market] [varchar](30) NOT NULL,
	[lob] [varchar](2) NOT NULL,
	[segment] [varchar](15) NOT NULL,
	[product] [varchar](15) NOT NULL,
	[yrmo] [varchar](15) NOT NULL,
	[med_mems] [int] NOT NULL,
	[rx_mems] [int] NOT NULL,
	[plan_mkt_cd] [varchar](6) NOT NULL,
 CONSTRAINT [aaaaat_membership_new_regions_PK] PRIMARY KEY NONCLUSTERED 
(
	[Category] ASC,
	[company] ASC,
	[fund] ASC,
	[reg] ASC,
	[MH] ASC,
	[market] ASC,
	[lob] ASC,
	[segment] ASC,
	[product] ASC,
	[yrmo] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 80) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[zzJuly31q_mem_year_reg]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[zzJuly31q_mem_year_reg](
	[company] [varchar](15) NOT NULL,
	[fund] [varchar](15) NOT NULL,
	[reg] [varchar](15) NOT NULL,
	[lob] [varchar](15) NOT NULL,
	[segment] [varchar](15) NOT NULL,
	[yr] [varchar](4) NOT NULL,
	[med_mems_reg] [int] NOT NULL,
	[rx_mems_reg] [int] NOT NULL,
 CONSTRAINT [aaaaaq_mem_year_reg_PK] PRIMARY KEY NONCLUSTERED 
(
	[company] ASC,
	[fund] ASC,
	[reg] ASC,
	[lob] ASC,
	[segment] ASC,
	[yr] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 80) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[zzjunk_admin_snapshot_AFTER]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[zzjunk_admin_snapshot_AFTER](
	[sai_id] [int] NOT NULL,
	[Fund] [nvarchar](15) NOT NULL,
	[market] [nvarchar](30) NOT NULL,
	[LOB] [nvarchar](15) NOT NULL,
	[Segment] [nvarchar](15) NOT NULL,
	[Product] [nvarchar](15) NOT NULL,
	[yr] [nvarchar](7) NOT NULL,
	[med_doll] [float] NOT NULL,
	[rx_doll] [float] NOT NULL,
	[med_mem] [int] NOT NULL,
	[rx_mem] [int] NOT NULL,
 CONSTRAINT [aaaaaadmin_snapshot_AFTER_PK] PRIMARY KEY NONCLUSTERED 
(
	[sai_id] ASC,
	[Fund] ASC,
	[market] ASC,
	[LOB] ASC,
	[Segment] ASC,
	[Product] ASC,
	[yr] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 80) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[zzjunk_admin_snapshot_BEFORE]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[zzjunk_admin_snapshot_BEFORE](
	[sai_id] [int] NOT NULL,
	[Fund] [nvarchar](15) NOT NULL,
	[market] [nvarchar](30) NOT NULL,
	[LOB] [nvarchar](15) NOT NULL,
	[Segment] [nvarchar](15) NOT NULL,
	[Product] [nvarchar](15) NOT NULL,
	[yr] [nvarchar](7) NOT NULL,
	[med_doll] [float] NOT NULL,
	[rx_doll] [float] NOT NULL,
	[med_mem] [int] NOT NULL,
	[rx_mem] [int] NOT NULL,
 CONSTRAINT [aaaaaadmin_snapshot_BEFORE_PK] PRIMARY KEY NONCLUSTERED 
(
	[sai_id] ASC,
	[Fund] ASC,
	[market] ASC,
	[LOB] ASC,
	[Segment] ASC,
	[Product] ASC,
	[yr] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 80) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[zzjunk_q_LE_dollar_check_detail]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[zzjunk_q_LE_dollar_check_detail](
	[sai_id] [int] NOT NULL,
	[Fund] [nvarchar](15) NOT NULL,
	[reg] [nvarchar](15) NOT NULL,
	[market] [nvarchar](35) NOT NULL,
	[LOB] [nvarchar](15) NOT NULL,
	[Segment] [nvarchar](15) NOT NULL,
	[Product] [nvarchar](15) NOT NULL,
	[yrmo] [nvarchar](7) NOT NULL,
	[Start_mo] [nvarchar](7) NOT NULL,
	[Stop_mo] [nvarchar](7) NOT NULL,
	[yr] [nvarchar](7) NOT NULL,
	[med_pmpm] [float] NULL,
	[rx_pmpm] [float] NULL,
	[med_mems] [float] NULL,
	[rx_mems] [float] NULL,
	[med_doll] [float] NULL,
	[rx_doll] [float] NULL,
 CONSTRAINT [aaaaaq_LE_dollar_check_detail] PRIMARY KEY NONCLUSTERED 
(
	[Fund] ASC,
	[reg] ASC,
	[market] ASC,
	[LOB] ASC,
	[Segment] ASC,
	[Product] ASC,
	[yrmo] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 80) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  View [dbo].[q_le_last_updated]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE VIEW [dbo].[q_le_last_updated]
AS
select t.sai_id, t.last_updated_by AS le_last_updated_by,t.le_last_updated_dt
 from (
		SELECT         dbo.t_LE.sai_id,  dbo.t_LE.last_updated_by, dbo.t_LE.last_updated_dt AS le_last_updated_dt,
						 ROW_NUMBER() OVER (PARTITION BY sai_id ORDER BY last_updated_dt DESC) rnk
		FROM            dbo.t_LE 
	 ) t ---left JOIN dbo.lku_users ON t.last_updated_by = lku_users.aetnaid
 where rnk = 1  



GO
/****** Object:  View [dbo].[q_sai]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO










CREATE VIEW [dbo].[q_sai]
AS
SELECT        t.*, 
                     

  IsNull(sai_users.DisplayName , t.sai_owner) AS sai_owner_name, 
								 
   IsNull(lastupdate_users.DisplayName, t.last_updated_by) AS last_updated_by_name, 

                         q_le_last_updated.le_last_updated_dt, q_le_last_updated.le_last_updated_by
FROM   (
		SELECT        dbo.t_SAI.sai_id, dbo.t_SAI.Company,  
								 dbo.t_SAI.Savings_Realization_Start_Date, 
								 dbo.t_sai.sai_description,	 				
								dbo.t_SAI.Implementation_Date_Target,
								 cast (substring(dbo.t_SAI.Savings_Realization_Start_Date,1, 4) as smallint) AS savings_start_year,
								 cast (substring(dbo.t_SAI.Savings_Realization_Start_Date,5, 2) as smallint) AS savings_start_month,
								 dbo.t_SAI.work_grp,
								  dbo.t_SAI.Status, 
								 dbo.t_SAI.sai_owner, dbo.t_SAI.Confidence_Level,  dbo.t_SAI.Affects_Gross_Trend, dbo.t_SAI.Synergy, 
								 dbo.t_SAI.last_updated_by,dbo.t_SAI.Last_Updated_dt,

								 substring(IIf([Business_Unit_Alt_Name]='N&CS',IIf([lku_work_grp].[work_grp]='NCM','CS',
								 dbo.lku_work_grp.[work_grp]),[Business_Unit_Alt_Name]) + 
								 '-' + cast(dbo.t_SAI.[sai_id] as varchar(9)) + ' - ' + [sai_name],1,253) as SAI_Name_and_No ,
								 
								  
								dbo.lku_work_grp.work_grp_alt_name, dbo.lku_work_grp.bus_unit, dbo.lku_work_grp.bus_unit_lead, 
								 dbo.t_SAI.Medical_Cost_Category, dbo.t_SAI.Unit_Cost_or_Utilization, 
								 --IIF(Status in ( 'Active','Implemented'), 1, 0) AS Active, 
								-- IIF(Status = 'Ideation', 1, 0) AS Pipeline, 
								 IIF(Status in ('Ideation','Active','Implemented'), 1, 0) AS Active_or_Idea,
								-- IIF(Status in ('Active', 'Implemented'), 'Y', 'N') AS ActiveYN, 
								-- IIF(Status = 'Ideation', 'Y', 'N') AS PipelineYN, 
								-- IIF(Status in ('Ideation','Active','Implemented'), 'Y', 'N') AS Active_or_IdeaYN,
								  lku_work_grp.Business_Unit_Alt_Name
		FROM            dbo.t_SAI INNER JOIN
								 dbo.lku_work_grp ON t_SAI.work_grp = dbo.lku_work_grp.work_grp
								   		) t
 LEFT OUTER JOIN
                         dbo.lku_users AS sai_users ON t.sai_owner = sai_users.AetnaId  LEFT OUTER JOIN
                         q_le_last_updated ON t.sai_id = q_le_last_updated.sai_id    LEFT OUTER JOIN
                         dbo.lku_users AS lastupdate_users ON t.last_updated_by = lastupdate_users.AetnaId











GO
/****** Object:  View [dbo].[q_LE]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO




CREATE VIEW [dbo].[q_LE]
AS
SELECT         dbo.t_LE.Fund, dbo.t_LE.market, dbo.t_LE.LOB, dbo.t_LE.Segment, dbo.t_LE.Product, dbo.t_LE.med_pmpm, dbo.t_LE.rx_pmpm, 
                     
						  q_SAI.*,
                         lku_months.yrmo AS start_mo, lku_months.Stop_mo,lku_months.yr as savings_start_yr
				

FROM            dbo.lku_months INNER JOIN
                         dbo.q_sai q_SAI ON lku_months.yrmo = q_SAI.Savings_Realization_Start_Date INNER JOIN
                         dbo.t_LE ON q_SAI.sai_id = t_LE.sai_id 







GO
/****** Object:  View [dbo].[q_membership]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO









CREATE VIEW [dbo].[q_membership]
AS
SELECT          t.company, t.fund, 

case when t.lob='CP' then dbo.lku_market.reg_Commercial else dbo.lku_market.reg_Medicare end as reg, 
case when t.lob='CP' then dbo.lku_market.MajMkt_Nm_Commercial else lku_market.MajMkt_Nm_Medicare end as MH, 
 
lku_market.MajMkt_Nm_Medicare as MH_ME,lku_market.reg_Medicare as reg_ME,
dbo.lku_market.MajMkt_Nm_Commercial as MH_CP,dbo.lku_market.reg_Commercial as reg_CP,
t.market,t.lob, t.segment, t.product, t.yrmo, t.med_mems, t.rx_mems, t.plan_mkt_cd, lku_months.mo_seq, lku_market.State, 
 CASE WHEN segment in ('Hix','CB') THEN 'IN' else t.lob END AS Level1, 
 CASE WHEN segment in ('Hix','CB') THEN CONCAT('in_',segment) 
      WHEN lob = 'cp' THEN CONCAT('cp_', [product])  ELSE CONCAT('me_', [segment]) END AS Level2,

	lku_months.yr
FROM            dbo.n_membership t inner JOIN
                         dbo.lku_market ON t.plan_mkt_cd = lku_market.plan_mkt_cd LEFT OUTER JOIN
                         dbo.lku_months ON t.yrmo = lku_months.yrmo










GO
/****** Object:  View [dbo].[q_Reporting]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO




CREATE VIEW [dbo].[q_Reporting]
AS
SELECT le.company, le.fund, le.reg, le.reg_CP,le.reg_ME,le.state, le.mh, le.mh_CP,le.mh_ME,le.market, le.lob,
 le.segment, le.product, le.yrmo, 
le.yr, 
le.sai_id, q_SAI.SAI_Name_and_No,  med_doll+rx_doll AS doll, le.med_doll, le.rx_doll, 
le.med_mems, le.rx_mems, le.plan_mkt_cd, q_SAI.Status, q_SAI.work_grp, q_SAI.bus_unit, q_SAI.bus_unit_lead, 
q_SAI.sai_description,q_SAI.Implementation_Date_Target,q_SAI.Last_Updated_dt,q_SAI.last_updated_by,
IIf(le.yr>q_SAI.Savings_Start_year, q_sai.savings_start_month -1,13-q_sai.savings_start_month) AS sai_mos, 
IIf(le.yr>q_SAI.Savings_Start_year,'Y','N') AS carryover_ind, 
q_SAI.savings_start_year, q_SAI.Active_or_Idea,
  q_SAI.Savings_Realization_Start_Date, q_SAI.Confidence_Level,  q_sai.Medical_Cost_Category,q_sai.Unit_Cost_or_Utilization,
  q_SAI.Affects_Gross_Trend,  q_SAI.sai_owner, q_SAI.sai_owner_name,  q_SAI.synergy,  q_SAI.le_last_updated_dt,
    q_SAI.le_last_updated_by,  le.Level1, le.Level2, q_sai.Business_Unit_Alt_Name
	
FROM (
	SELECT        q_LE.LOB, q_LE.Company, q_LE.market, q_LE.Product, q_LE.Segment, q_LE.Fund, q_membership.yrmo, q_LE.sai_id,  [med_pmpm] * [med_mems]  AS med_doll,  [rx_pmpm] * [rx_mems] AS rx_doll, 
							 q_membership.med_mems, q_membership.rx_mems, q_membership.MH, q_membership.reg, 
							  q_membership.MH_CP, q_membership.reg_CP, q_membership.MH_ME, q_membership.reg_ME,
							  q_membership.State, q_membership.plan_mkt_cd, 
							 q_membership.Level1, q_membership.Level2,lku_months.yr
	FROM            dbo.q_LE INNER JOIN
							 dbo.q_membership ON q_LE.Company = q_membership.company AND q_LE.Segment = q_membership.segment AND q_LE.Product = q_membership.product AND 
							 q_LE.Fund = q_membership.fund AND q_LE.LOB = q_membership.lob AND q_LE.market = q_membership.market
					inner join lku_months on lku_months.yrmo = dbo.q_membership.yrmo
	WHERE           lku_months.yrmo BETWEEN q_le.Start_mo AND q_le.Stop_mo AND [med_mems]+ [rx_pmpm] > 0

 ) le 


 INNER JOIN q_SAI ON le.sai_id = q_SAI.sai_id 
 --- where q_SAI.sai_id =3977 
















GO
/****** Object:  View [dbo].[q_Rptg]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO











CREATE VIEW [dbo].[q_Rptg]
AS


	SELECT			
					le.sai_id, le.work_grp, max(le.[work_grp_alt_name]) as work_grp_alt_name, le.bus_unit,
					 max(le.Business_Unit_Alt_Name) as Business_Unit_Alt_Name, max(le.sai_owner_name) sai_owner_name,
					max(le.SAI_Name_and_No) SAI_Name_and_No,le.Status,le.start_mo,le.Active_or_Idea,
					mm.company, mm.fund, mm.market, mm.lob, mm.segment, mm.product, dosmo.yr, mm.plan_mkt_cd,
					max(case when dosmo.yr > le.savings_start_yr then 'Y' else 'N' end) AS carryover_ind, 
                    min(le.savings_start_yr) as savings_start_yr, count(dosmo.yrmo) as sai_mos,
					max(le.start_mo) as savings_start_mo,
					sum(mm.med_mems) as med_memmo, sum(mm.rx_mems) rx_memmo, max(le.med_pmpm) med_pmpm, max(le.rx_pmpm) rx_pmpm,
					sum(le.rx_pmpm*mm.rx_mems + le.med_pmpm*mm.med_mems) as doll
	FROM                    (
							select q_LE.sai_id,q_le.SAI_Name_and_No,q_LE.fund,q_LE.market,q_LE.lob,q_LE.segment,q_LE.product,
									q_LE.med_pmpm, q_LE.rx_pmpm,q_LE.Last_Updated_dt, q_LE.last_updated_by, 
									q_LE.start_mo, q_LE.Stop_mo,q_LE.savings_start_yr,q_LE.sai_owner_name,
									q_LE.company, q_LE.work_grp,q_LE.Status,q_le.Active_or_Idea,
									q_le.work_grp_alt_name,q_le.bus_unit,q_le.Business_Unit_Alt_Name
							FROM dbo.q_LE q_LE  
						---	WHERE q_LE.start_mo >= '201602' 
						) le 
						
				INNER JOIN dbo.lku_months dosmo ON dosmo.yrmo between le.Start_mo and le.stop_mo
				INNER JOIN dbo.n_membership mm 
				ON mm.Company = le.Company AND mm.fund = le.Fund AND mm.market = le.market AND mm.lob = le.LOB AND 
                mm.segment = le.Segment AND mm.product = le.Product and mm.yrmo = dosmo.yrmo
				and mm.med_mems + mm.rx_mems > 0 

				---inner join dbo.lku_work_grp wg on wg.work_grp = le.work_grp
				---where le.sai_id<3977 and le.market='Houston' and le.product='HMO'
	GROUP BY	le.sai_id, le.work_grp, le.bus_unit,le.start_mo,le.Status,le.Active_or_Idea,
				mm.company, mm.fund, mm.market, mm.lob, mm.segment, mm.product, dosmo.yr, mm.plan_mkt_cd			





















GO
/****** Object:  View [dbo].[q_reports_market_xtab_sub_CP]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO








CREATE VIEW [dbo].[q_reports_market_xtab_sub_CP]
AS
 
with mkt_doll_sub as (
	SELECT t.Company, t.market , market.reg_Commercial as reg,market.MajMkt_Nm_Commercial as mh,  t.yr AS period, 
	t.savings_start_yr,t.sai_Id, t.SAI_Name_and_No, t.lob ,  IIf(t.lob='ME' Or t.segment in ('Hix','cb'),t.segment,t.Product) AS LobSeg,
	t.fund,t.savings_start_mo,t.sai_owner_name,t.Status,
	t.bus_unit, t.Business_Unit_Alt_Name,
	 Sum(t.doll) AS doll,sum(0) as med_memmo, sum(0) as rx_memmo	--- ,sum(t.med_memmo*12/cast(t.sai_mos as decimal(7,5))) as med_memmo
	 ---,sum(t.rx_memmo*12/cast(t.sai_mos as decimal(7,5))) as rx_memmo
	FROM q_Rptg t inner JOIN  dbo.lku_market market ON t.market = market.market 
	WHERE fund = 'FI' and Active_or_Idea=1 
	GROUP BY  t.Company, t.market , market.reg_Commercial,market.MajMkt_Nm_Commercial,  t.yr , 
	t.savings_start_yr,t.sai_Id, t.SAI_Name_and_No, t.lob ,  IIf(t.lob='ME' Or t.segment in ('Hix','cb'),t.segment,t.Product) ,
	t.fund,t.savings_start_mo,t.sai_owner_name,t.Status,
	t.bus_unit, t.Business_Unit_Alt_Name
)
,mkt_doll as (
    select Company, market , reg, mh,  period, 
			savings_start_yr,sai_Id, SAI_Name_and_No, lob , Lobseg, 
			fund,savings_start_mo,sai_owner_name,Status,
			bus_unit, Business_Unit_Alt_Name,
			doll, med_memmo, rx_memmo
    from mkt_doll_sub

	UNION

	SELECT t.Company, t.market , reg, mh,  period, 
			t.savings_start_yr,t.sai_Id, t.SAI_Name_and_No, t.lob , 
		 case when t.lob='ME' then '<All>' 
			          when t.LobSeg in ('HMO','PPO') then 'HMO_PPO'
					  else 'IVL' end as Lobseg,
			t.fund,t.savings_start_mo,t.sai_owner_name,t.Status,
			t.bus_unit, t.Business_Unit_Alt_Name,
			Sum(t.doll) AS doll, sum(t.med_memmo) as med_memmo, sum(t.rx_memmo) as rx_memmo
	FROM mkt_doll_sub t 
	---WHERE ((t.LobSeg in ('hmo','ppo') and t.lob = 'CP') or t.lob = 'ME')
	GROUP BY  t.Company, t.market , reg,mh,  t.period , 
			t.savings_start_yr,t.sai_Id, t.SAI_Name_and_No, t.lob ,  
			 case when t.lob='ME' then '<All>' 
			          when t.LobSeg in ('HMO','PPO') then 'HMO_PPO'
					  else 'IVL' end ,
			t.fund,t.savings_start_mo,t.sai_owner_name,t.Status,
			t.bus_unit, t.Business_Unit_Alt_Name

 )
	SELECT
		 t.Company, t.reg + '_' + t.mh + '_' + t.market as mkt,  t.period, 
		 t.savings_start_yr,t.sai_Id, t.SAI_Name_and_No, t.lob , t.LobSeg,
		 t.fund,t.savings_start_mo,t.sai_owner_name,t.Status,
		 t.bus_unit, t.Business_Unit_Alt_Name,
		 Sum(t.doll) AS doll, sum(t.med_memmo) as med_memmo, sum(t.rx_memmo) as rx_memmo
	FROM mkt_doll t 
	GROUP BY
		  t.Company,  t.reg + '_' + t.mh + '_' + t.market ,  t.period, 
		  t.savings_start_yr,t.sai_Id, t.SAI_Name_and_No, t.lob ,  t.LobSeg,
	      t.fund,t.savings_start_mo,t.sai_owner_name,t.Status,
	      t.bus_unit, t.Business_Unit_Alt_Name

	UNION 

	SELECT
		 t.Company, t.reg + '_' + t.mh as mkt,  t.period, 
		 t.savings_start_yr,t.sai_Id, t.SAI_Name_and_No, t.lob , t.LobSeg,
		 t.fund,t.savings_start_mo,t.sai_owner_name,t.Status,
		 t.bus_unit, t.Business_Unit_Alt_Name,
		 Sum(t.doll) AS doll, sum(t.med_memmo) as med_memmo, sum(t.rx_memmo) as rx_memmo
	FROM mkt_doll t 
	GROUP BY
		  t.Company, t.reg + '_' + t.mh ,  t.period, 
		  t.savings_start_yr,t.sai_Id, t.SAI_Name_and_No, t.lob ,  t.LobSeg,
	      t.fund,t.savings_start_mo,t.sai_owner_name,t.Status,
	      t.bus_unit, t.Business_Unit_Alt_Name

	UNION 
		SELECT
		 t.Company, t.reg  as mkt,  t.period, 
		 t.savings_start_yr,t.sai_Id, t.SAI_Name_and_No, t.lob , t.LobSeg,
		 t.fund,t.savings_start_mo,t.sai_owner_name,t.Status,
		 t.bus_unit, t.Business_Unit_Alt_Name,
		 Sum(t.doll) AS doll, sum(t.med_memmo) as med_memmo, sum(t.rx_memmo) as rx_memmo
	FROM mkt_doll t 
	GROUP BY
		  t.Company, t.reg  ,  t.period, 
		  t.savings_start_yr,t.sai_Id, t.SAI_Name_and_No, t.lob ,  t.LobSeg,
	      t.fund,t.savings_start_mo,t.sai_owner_name,t.Status,
	      t.bus_unit, t.Business_Unit_Alt_Name

	UNION 
		SELECT
		 t.Company, '_cons' as mkt,  t.period, 
		 t.savings_start_yr,t.sai_Id, t.SAI_Name_and_No, t.lob , t.LobSeg,
		 t.fund,t.savings_start_mo,t.sai_owner_name,t.Status,
		 t.bus_unit, t.Business_Unit_Alt_Name,
		 Sum(t.doll) AS doll, sum(t.med_memmo) as med_memmo, sum(t.rx_memmo) as rx_memmo
	FROM mkt_doll t 
	GROUP BY
		  t.Company,  t.period, 
		  t.savings_start_yr,t.sai_Id, t.SAI_Name_and_No, t.lob ,  t.LobSeg,
	      t.fund,t.savings_start_mo,t.sai_owner_name,t.Status,
	      t.bus_unit, t.Business_Unit_Alt_Name


















GO
/****** Object:  View [dbo].[q_reports_market_xtab_sub_ME]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO








CREATE VIEW [dbo].[q_reports_market_xtab_sub_ME]
AS
 
with mkt_doll_sub as (
	SELECT t.Company, t.market , market.reg_Medicare as reg,market.MajMkt_Nm_Medicare as mh,  t.yr AS period, 
	t.savings_start_yr,t.sai_Id, t.SAI_Name_and_No, t.lob ,  IIf(t.lob='ME' Or t.segment in ('Hix','cb'),t.segment,t.Product) AS LobSeg,
	t.fund,t.savings_start_mo,t.sai_owner_name,t.Status,
	t.bus_unit, t.Business_Unit_Alt_Name,
	 Sum(t.doll) AS doll,sum(0) as med_memmo, sum(0) as rx_memmo	--- ,sum(t.med_memmo*12/cast(t.sai_mos as decimal(7,5))) as med_memmo
	 ---,sum(t.rx_memmo*12/cast(t.sai_mos as decimal(7,5))) as rx_memmo
	FROM q_Rptg t inner JOIN  dbo.lku_market market ON t.market = market.market 
	WHERE fund = 'FI' and Active_or_Idea=1 
	GROUP BY  t.Company, t.market , market.reg_Medicare,market.MajMkt_Nm_Medicare,  t.yr , 
	t.savings_start_yr,t.sai_Id, t.SAI_Name_and_No, t.lob ,  IIf(t.lob='ME' Or t.segment in ('Hix','cb'),t.segment,t.Product) ,
	t.fund,t.savings_start_mo,t.sai_owner_name,t.Status,
	t.bus_unit, t.Business_Unit_Alt_Name
)
,mkt_doll as (
    select Company, market , reg, mh,  period, 
			savings_start_yr,sai_Id, SAI_Name_and_No, lob , Lobseg, 
			fund,savings_start_mo,sai_owner_name,Status,
			bus_unit, Business_Unit_Alt_Name,
			doll, med_memmo, rx_memmo
    from mkt_doll_sub

	UNION

	SELECT t.Company, t.market , reg, mh,  period, 
			t.savings_start_yr,t.sai_Id, t.SAI_Name_and_No, t.lob ,
			 case when t.lob='ME' then '<All>' 
			          when t.LobSeg in ('HMO','PPO') then 'HMO_PPO'
					  else 'IVL' end as Lobseg,
			t.fund,t.savings_start_mo,t.sai_owner_name,t.Status,
			t.bus_unit, t.Business_Unit_Alt_Name,
			Sum(t.doll) AS doll, sum(t.med_memmo) as med_memmo, sum(t.rx_memmo) as rx_memmo
	FROM mkt_doll_sub t 
	---WHERE ((t.LobSeg in ('hmo','ppo') and t.lob = 'CP') or t.lob = 'ME')
	GROUP BY  t.Company, t.market , reg,mh,  t.period , 
			t.savings_start_yr,t.sai_Id, t.SAI_Name_and_No, t.lob , 
			 case when t.lob='ME' then '<All>' 
			          when t.LobSeg in ('HMO','PPO') then 'HMO_PPO'
					  else 'IVL' end , 
			t.fund,t.savings_start_mo,t.sai_owner_name,t.Status,
			t.bus_unit, t.Business_Unit_Alt_Name

 )
	SELECT
		 t.Company, t.reg + '_' + t.mh + '_' + t.market as mkt,  t.period, 
		 t.savings_start_yr,t.sai_Id, t.SAI_Name_and_No, t.lob , t.LobSeg,
		 t.fund,t.savings_start_mo,t.sai_owner_name,t.Status,
		 t.bus_unit, t.Business_Unit_Alt_Name,
		 Sum(t.doll) AS doll, sum(t.med_memmo) as med_memmo, sum(t.rx_memmo) as rx_memmo
	FROM mkt_doll t 
	GROUP BY
		  t.Company,  t.reg + '_' + t.mh + '_' + t.market ,  t.period, 
		  t.savings_start_yr,t.sai_Id, t.SAI_Name_and_No, t.lob ,  t.LobSeg,
	      t.fund,t.savings_start_mo,t.sai_owner_name,t.Status,
	      t.bus_unit, t.Business_Unit_Alt_Name

	UNION 

	SELECT
		 t.Company, t.reg + '_' + t.mh as mkt,  t.period, 
		 t.savings_start_yr,t.sai_Id, t.SAI_Name_and_No, t.lob , t.LobSeg,
		 t.fund,t.savings_start_mo,t.sai_owner_name,t.Status,
		 t.bus_unit, t.Business_Unit_Alt_Name,
		 Sum(t.doll) AS doll, sum(t.med_memmo) as med_memmo, sum(t.rx_memmo) as rx_memmo
	FROM mkt_doll t 
	GROUP BY
		  t.Company, t.reg + '_' + t.mh ,  t.period, 
		  t.savings_start_yr,t.sai_Id, t.SAI_Name_and_No, t.lob ,  t.LobSeg,
	      t.fund,t.savings_start_mo,t.sai_owner_name,t.Status,
	      t.bus_unit, t.Business_Unit_Alt_Name

	UNION 
		SELECT
		 t.Company, t.reg  as mkt,  t.period, 
		 t.savings_start_yr,t.sai_Id, t.SAI_Name_and_No, t.lob , t.LobSeg,
		 t.fund,t.savings_start_mo,t.sai_owner_name,t.Status,
		 t.bus_unit, t.Business_Unit_Alt_Name,
		 Sum(t.doll) AS doll, sum(t.med_memmo) as med_memmo, sum(t.rx_memmo) as rx_memmo
	FROM mkt_doll t 
	GROUP BY
		  t.Company, t.reg  ,  t.period, 
		  t.savings_start_yr,t.sai_Id, t.SAI_Name_and_No, t.lob ,  t.LobSeg,
	      t.fund,t.savings_start_mo,t.sai_owner_name,t.Status,
	      t.bus_unit, t.Business_Unit_Alt_Name

	UNION 
		SELECT
		 t.Company, '_cons' as mkt,  t.period, 
		 t.savings_start_yr,t.sai_Id, t.SAI_Name_and_No, t.lob , t.LobSeg,
		 t.fund,t.savings_start_mo,t.sai_owner_name,t.Status,
		 t.bus_unit, t.Business_Unit_Alt_Name,
		 Sum(t.doll) AS doll, sum(t.med_memmo) as med_memmo, sum(t.rx_memmo) as rx_memmo
	FROM mkt_doll t 
	GROUP BY
		  t.Company,  t.period, 
		  t.savings_start_yr,t.sai_Id, t.SAI_Name_and_No, t.lob ,  t.LobSeg,
	      t.fund,t.savings_start_mo,t.sai_owner_name,t.Status,
	      t.bus_unit, t.Business_Unit_Alt_Name


















GO
/****** Object:  View [dbo].[adm_ExecDB_doll]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO










CREATE VIEW [dbo].[adm_ExecDB_doll]
AS
/* commercial first */
with tsub as (
		SELECT t.sai_id, 'allbu' as bus_unit, t.Fund, t.mkt, t.period, 
			   case when t.lobseg In ('HMO_PPO') then 'Core' when t.LobSeg in ('IVL') then 'IVL' else t.LobSeg end AS seg,
				Sum(t.doll) AS doll,  
				max(t.SAI_Name_and_No) AS sai_nm
		FROM dbo.q_reports_market_xtab_sub_CP t inner join  lku_System s on t.period in (s.execdb_current_year -1, s.execdb_current_year)
		WHERE Len(mkt)>2 And t.lobseg In ('HMO_PPO')
		GROUP BY t.sai_id, t.Fund, t.mkt, t.period,t.LobSeg 
		having Sum(t.doll) >0 

		UNION  /* Medicare */
		SELECT t.sai_id, 'allbu' as bus_unit, t.Fund, t.mkt, t.period,  t.LobSeg  AS seg,
				Sum(t.doll) AS doll,  
				max(t.SAI_Name_and_No) AS sai_nm 
		FROM dbo.q_reports_market_xtab_sub_ME t inner join  lku_System s on t.period in (s.execdb_current_year -1, s.execdb_current_year)  
		WHERE Len(mkt)>2 And t.lob In ('ME')
		GROUP BY t.sai_id, t.Fund, t.mkt, t.period,t.LobSeg 
		having Sum(t.doll) >0 

		UNION
		/* LNMEU business unit */
		SELECT t.sai_id,t.bus_unit, t.Fund, t.mkt, t.period, 
			   case when t.lobseg In ('HMO_PPO') then 'Core' when t.LobSeg in ('IVL') then 'IVL' else t.LobSeg end AS seg,
				Sum(t.doll) AS doll, 
				max(t.SAI_Name_and_No) AS sai_nm
		FROM dbo.q_reports_market_xtab_sub_CP t inner join  lku_System s on t.period in (s.execdb_current_year -1, s.execdb_current_year)
		WHERE Len(mkt)>2 And t.lobseg In ('HMO_PPO') and t.bus_unit='LNMEU'
		GROUP BY t.sai_id,t.bus_unit, t.Fund, t.mkt, t.period,t.LobSeg 
		having Sum(t.doll) >0 

		UNION
		SELECT t.sai_id, t.bus_unit, t.Fund, t.mkt, t.period,  t.LobSeg  AS seg,
				Sum(t.doll) AS doll,  
				max(t.SAI_Name_and_No) AS sai_nm
		FROM dbo.q_reports_market_xtab_sub_ME t inner join  lku_System s on t.period in (s.execdb_current_year -1, s.execdb_current_year)  
		WHERE Len(mkt)>2 And t.lob In ('ME') and t.bus_unit='LNMEU'
		GROUP BY t.sai_id, t.bus_unit,t.Fund, t.mkt, t.period,t.LobSeg 
		having Sum(t.doll) >0
)

select trnk.* 
from  ( select tsub.*, ROW_NUMBER() over(partition by  bus_unit, fund, mkt, period, seg ORDER BY doll desc) as rnk from tsub) trnk
where trnk.rnk <= 10 




GO
/****** Object:  View [dbo].[q_reports_market_xtab_mem_CP]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO










CREATE VIEW [dbo].[q_reports_market_xtab_mem_CP]
AS

with mkt_sub as (
	SELECT Company, reg_CP as reg, mh_cp as mh, market ,  yr AS period, 
	lob,IIf([lob]  = 'ME' Or [segment] in ('Hix' ,'cb'),[segment],[Product]) AS LobSeg, fund, Sum(med_mems) AS med_mems, Sum(rx_mems) AS rx_mems
	FROM q_membership
	WHERE fund = 'FI'
	GROUP BY Company, reg_cp,mh_cp, market,  yr, lob,IIf([lob]  = 'ME' Or [segment] in ('Hix' ,'cb'),[segment],[Product]) , fund
)
,mkt as (
    select Company, market , reg, mh,  period, lob , Lobseg, fund,med_mems, rx_mems
    from mkt_sub

	UNION

	select Company, market , reg, mh,  period, lob ,
				case when t.lob='ME' then '<All>' 
			          when t.LobSeg in ('HMO','PPO') then 'HMO_PPO'
					  else 'IVL' end as Lobseg,
	  fund,sum(med_mems) med_mems, sum(rx_mems) rx_mems
    from mkt_sub t
	---WHERE ((LobSeg in ('HMO','PPO') and lob = 'CP') or lob='ME')
	GROUP BY Company, market , reg, mh,  period, lob , 
				case when t.lob='ME' then '<All>' 
			          when t.LobSeg in ('HMO','PPO') then 'HMO_PPO'
					  else 'IVL' end, fund
)

	SELECT   Company, reg + '_' + mh + '_' + market AS Mkt,  period, lob, lobseg, fund, Sum(med_mems) AS med_mems, Sum(rx_mems) AS rx_mems
	FROM mkt
	GROUP BY Company, reg + '_' + mh + '_' + market,         period,  lob, lobseg, fund
 
UNION
	SELECT   Company, reg + '_' + mh AS Mkt,  period, lob, lobseg, fund, Sum(med_mems) AS med_mems, Sum(rx_mems) AS rx_mems
	FROM mkt
	GROUP BY Company, reg + '_' + mh,   period,  lob, lobseg, fund
UNION
	SELECT   Company, reg  AS Mkt,  period, lob, lobseg, fund, Sum(med_mems) AS med_mems, Sum(rx_mems) AS rx_mems
	FROM mkt
	GROUP BY Company, reg,   period,  lob, lobseg, fund
UNION
	SELECT   Company,  '_cons' AS Mkt, period, lob, lobseg, fund, Sum(med_mems) AS med_mems, Sum(rx_mems) AS rx_mems
	FROM mkt
	GROUP BY Company,   period,  lob, lobseg, fund







GO
/****** Object:  View [dbo].[q_reports_market_xtab_mem_ME]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO










CREATE VIEW [dbo].[q_reports_market_xtab_mem_ME]
AS

with mkt_sub as (
	SELECT Company, reg_ME as reg, mh_me as mh, market ,  yr AS period, 
	lob,IIf([lob]  = 'ME' Or [segment] in ('Hix' ,'cb'),[segment],[Product]) AS LobSeg, fund, Sum(med_mems) AS med_mems, Sum(rx_mems) AS rx_mems
	FROM q_membership
	WHERE fund = 'FI'
	GROUP BY Company, reg_me,mh_me, market,  yr, lob,IIf([lob]  = 'ME' Or [segment] in ('Hix' ,'cb'),[segment],[Product]) , fund
)
,mkt as (
    select Company, market , reg, mh,  period, lob , Lobseg, fund,med_mems, rx_mems
    from mkt_sub

	UNION

	select Company, market , reg, mh,  period, lob ,
	 case when t.lob='ME' then '<All>' 
			          when t.LobSeg in ('HMO','PPO') then 'HMO_PPO'
					  else 'IVL' end as Lobseg,
	  fund,sum(med_mems) med_mems, sum(rx_mems) rx_mems
    from mkt_sub t
	---WHERE ((LobSeg in ('HMO','PPO') and lob = 'CP') or lob='ME')
	GROUP BY Company, market , reg, mh,  period, lob ,
	          case when t.lob='ME' then '<All>' 
			       when t.LobSeg in ('HMO','PPO') then 'HMO_PPO'
				    else 'IVL' end , fund
)

	SELECT   Company, reg + '_' + mh + '_' + market AS Mkt,  period, lob, lobseg, fund, Sum(med_mems) AS med_mems, Sum(rx_mems) AS rx_mems
	FROM mkt
	GROUP BY Company, reg + '_' + mh + '_' + market,         period,  lob, lobseg, fund
 
UNION
	SELECT   Company, reg + '_' + mh AS Mkt,  period, lob, lobseg, fund, Sum(med_mems) AS med_mems, Sum(rx_mems) AS rx_mems
	FROM mkt
	GROUP BY Company, reg + '_' + mh,   period,  lob, lobseg, fund
UNION
	SELECT   Company, reg  AS Mkt,  period, lob, lobseg, fund, Sum(med_mems) AS med_mems, Sum(rx_mems) AS rx_mems
	FROM mkt
	GROUP BY Company, reg,   period,  lob, lobseg, fund
UNION
	SELECT   Company,  '_cons' AS Mkt, period, lob, lobseg, fund, Sum(med_mems) AS med_mems, Sum(rx_mems) AS rx_mems
	FROM mkt
	GROUP BY Company,   period,  lob, lobseg, fund







GO
/****** Object:  View [dbo].[adm_ExecDB_mem]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO




CREATE VIEW [dbo].[adm_ExecDB_mem]
AS
/* commercial first */
SELECT t.Fund, t.mkt, t.period, 
case when t.lobseg In ('HMO_PPO') then 'Core' when t.LobSeg in ('IVL') then 'IVL' else t.LobSeg end AS seg, Sum(t.med_mems) AS mm
FROM dbo.q_reports_market_xtab_mem_CP t inner join  lku_System s on t.period in (s.execdb_current_year -1, s.execdb_current_year)
WHERE t.lobseg In ('HMO_PPO')
GROUP BY t.Fund, t.mkt, t.period, case when t.lobseg In ('HMO_PPO') then 'Core' when t.LobSeg in ('IVL') then 'IVL' else t.LobSeg end 
having Sum(t.med_mems) > 0 

UNION  /* Medicare */

SELECT t.Fund, t.mkt, t.period, t.LobSeg AS seg, Sum(t.med_mems) AS mm
FROM dbo.q_reports_market_xtab_mem_ME t inner join  lku_System s on t.period in (s.execdb_current_year -1, s.execdb_current_year)
WHERE t.lob = 'ME'
GROUP BY t.Fund, t.mkt, t.period, t.LobSeg 
having Sum(t.med_mems) > 0 
;




GO
/****** Object:  View [dbo].[zzadm_015_doll]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO





CREATE VIEW [dbo].[zzadm_015_doll]
AS

SELECT sai_id, SAI_Name_and_No, QB_SAI_ID, Status, Company AS Company, Fund AS Fund, '_con' AS mkt, yr AS period, lob, IIf([lob]='ME' Or [segment]='Hix' Or [segment]='cb',[segment],[Product]) AS LobSeg, bus_unit, Sum(doll) AS doll, bus_unit_display_name, Business_Unit_Alt_Name
FROM q_Reporting
WHERE active_or_idea=1 and sai_id between 1000 and 1200 
GROUP BY sai_id, SAI_Name_and_No, QB_SAI_ID, Status, Company, Fund, yr, lob, IIf([lob]='ME' Or [segment]='Hix' Or [segment]='cb',[segment],[Product]), bus_unit, bus_unit_display_name, Business_Unit_Alt_Name

UNION

 SELECT sai_id, SAI_Name_and_No, QB_SAI_ID, Status, Company AS Company, Fund AS Fund, [Reg] + '__' + [mh] AS mkt, yr AS period, lob, IIf([lob]='ME' Or [segment]='Hix' Or [segment]='cb',[segment],[Product]) AS LobSeg, bus_unit, Sum(doll) AS doll, bus_unit_display_name, Business_Unit_Alt_Name
FROM q_Reporting
WHERE active_or_idea=1 and sai_id between 1000 and 1200 
GROUP BY sai_id, SAI_Name_and_No, QB_SAI_ID, Status, Company, Fund, [Reg] + '__' + [mh], yr, lob, IIf([lob]='ME' Or [segment]='Hix' Or [segment]='cb',[segment],[Product]), bus_unit, bus_unit_display_name, Business_Unit_Alt_Name
 
 UNION

 SELECT sai_id, SAI_Name_and_No, QB_SAI_ID, Status, Company AS Company, Fund AS Fund, [Reg] + '_' + [market] AS mkt, yr AS period, lob, IIf([lob]='ME' Or [segment]='Hix' Or [segment]='cb',[segment],[Product]) AS LobSeg, bus_unit, Sum(doll) AS doll, bus_unit_display_name, Business_Unit_Alt_Name
FROM q_Reporting
WHERE active_or_idea=1 and sai_id between 1000 and 1200 
GROUP BY sai_id, SAI_Name_and_No, QB_SAI_ID, Status, Company, Fund, [Reg] + '_' + [market], yr, lob, IIf([lob]='ME' Or [segment]='Hix' Or [segment]='cb',[segment],[Product]), bus_unit, bus_unit_display_name, Business_Unit_Alt_Name
 

UNION
 
SELECT sai_id, SAI_Name_and_No, QB_SAI_ID, Status, Company AS Company, Fund AS Fund, Reg AS mkt, yr AS period, lob, IIf([lob]='ME' Or [segment]='Hix' Or [segment]='cb',[segment],[Product]) AS LobSeg, bus_unit, Sum(doll) AS doll, bus_unit_display_name, Business_Unit_Alt_Name
FROM q_Reporting
WHERE active_or_idea=1 and sai_id between 1000 and 1200 
GROUP BY sai_id, SAI_Name_and_No, QB_SAI_ID, Status, Company, Fund, Reg, yr, lob, IIf([lob]='ME' Or [segment]='Hix' Or [segment]='cb',[segment],[Product]), bus_unit, bus_unit_display_name, Business_Unit_Alt_Name
 





GO
/****** Object:  View [dbo].[zzadm_015_mem]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE VIEW [dbo].[zzadm_015_mem]
AS


SELECT Company AS Company, Fund AS Fund, 
case when [category]='mkt' then [reg] + '_' + [market] when [category]='mh' then [reg] + '__' + [mh] when [category]='reg' then [reg] when [category]='con' then '_con'
  else 'bad' end AS Mkt,

 yr AS period, lob, IIf([lob]='ME' Or [segment]='Hix' Or [segment]='cb',[segment],[Product]) AS LobSeg, Category AS mem_level, Sum(med_mems) AS med_mems, Sum(rx_mems) AS rx_mems
FROM q_membership
WHERE fund In ('FI')
GROUP BY Company, Fund, 
case when [category]='mkt' then [reg] + '_' + [market] when [category]='mh' then [reg] + '__' + [mh] when [category]='reg' then [reg] when [category]='con' then '_con'
  else 'bad' end,
 yr, lob, IIf([lob]='ME' Or [segment]='Hix' Or [segment]='cb',[segment],[Product]), Category;



GO
/****** Object:  View [dbo].[zzq_adm_015_lob_manual_crosstab]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO








CREATE VIEW [dbo].[zzq_adm_015_lob_manual_crosstab]
AS

With

Part1 as
(SELECT adm_015_mem_lob.Company,
adm_015_doll_lob.sai_id, 
adm_015_mem_lob.period, 
adm_015_mem_lob.lob, 
adm_015_mem_lob.LobSeg, 
adm_015_mem_lob.Fund, 
adm_015_doll_lob.SAI_Name_and_No, 
adm_015_doll_lob.QB_SAI_ID, 
adm_015_doll_lob.Business_Unit_Alt_Name AS bus_unit, 
adm_015_doll_lob.Status, 
q_sai.Savings_Realization_Start_Date AS savings_start, 
Replace(Replace(adm_015_mem_lob.mkt,'.',''),' ','') AS [MKT_], 
Sum(doll)/Sum(med_mems) AS [pmpm_]

FROM (adm_015_mem_lob 
INNER JOIN adm_015_doll_lob ON (adm_015_mem_lob.LobSeg = adm_015_doll_lob.LobSeg) AND (adm_015_mem_lob.lob = adm_015_doll_lob.lob) AND (adm_015_mem_lob.period = adm_015_doll_lob.period) AND (adm_015_mem_lob.Mkt = adm_015_doll_lob.mkt) AND (adm_015_mem_lob.Fund = adm_015_doll_lob.Fund) AND (adm_015_mem_lob.Company = adm_015_doll_lob.Company)) 
INNER JOIN q_sai ON adm_015_doll_lob.sai_id = q_sai.sai_id

GROUP BY adm_015_mem_lob.Company, adm_015_doll_lob.sai_id, adm_015_mem_lob.period, adm_015_mem_lob.lob, adm_015_mem_lob.LobSeg, adm_015_mem_lob.Fund, adm_015_doll_lob.SAI_Name_and_No, adm_015_doll_lob.QB_SAI_ID, adm_015_doll_lob.Business_Unit_Alt_Name, adm_015_doll_lob.Status, q_sai.Savings_Realization_Start_Date, Replace(Replace(adm_015_mem_lob.mkt,'.',''),' ','')

)

SELECT Part1.Company,
Part1.sai_id, 
Part1.period, 
Part1.lob, 
Part1.LobSeg, 
Part1.Fund, 
Part1.SAI_Name_and_No, 
Part1.QB_SAI_ID, 
Part1.bus_unit, 
Part1.Status, 
Part1.savings_start, 
Part1.MKT_, 
Part1.pmpm_,
IIf([MKT_]='_con',[pmpm_],0) AS _con, 
IIf([MKT_]='ce',[pmpm_],0) AS ce, 
IIf([MKT_]='ce__EMO_IA_SD_SIL_mh',[pmpm_],0) AS ce__EMO_IA_SD_SIL_mh, 
IIf([MKT_]='ce_Iowa',[pmpm_],0) AS ce_Iowa, 
IIf([MKT_]='ce_SouthDakota',[pmpm_],0) AS ce_SouthDakota, 
IIf([MKT_]='ce_StLouis',[pmpm_],0) AS ce_StLouis, 
IIf([MKT_]='ce__KS_ND_NE_WMO_mh',[pmpm_],0) AS ce__KS_ND_NE_WMO_mh, 
IIf([MKT_]='ce_KansasCity',[pmpm_],0) AS ce_KansasCity, 
IIf([MKT_]='ce_Nebraska',[pmpm_],0) AS ce_Nebraska, 
IIf([MKT_]='ce_NorthDakota',[pmpm_],0) AS ce_NorthDakota, 
IIf([MKT_]='ce__OK_TX_mh',[pmpm_],0) AS ce__OK_TX_mh, 
IIf([MKT_]='ce_Austin',[pmpm_],0) AS ce_Austin, 
IIf([MKT_]='ce_CorpusChristi',[pmpm_],0) AS ce_CorpusChristi, 
IIf([MKT_]='ce_Dallas',[pmpm_],0) AS ce_Dallas, 
IIf([MKT_]='ce_ElPaso',[pmpm_],0) AS ce_ElPaso, 
IIf([MKT_]='ce_Houston',[pmpm_],0) AS ce_Houston, 
IIf([MKT_]='ce_Oklahoma',[pmpm_],0) AS ce_Oklahoma, 
IIf([MKT_]='ce_SanAntonio',[pmpm_],0) AS ce_SanAntonio, 
IIf([MKT_]='ma',[pmpm_],0) AS ma, 
IIf([MKT_]='ma__DC_MD_VA_mh',[pmpm_],0) AS ma__DC_MD_VA_mh, 
IIf([MKT_]='ma_DC',[pmpm_],0) AS ma_DC, 
IIf([MKT_]='ma_Maryland',[pmpm_],0) AS ma_Maryland, 
IIf([MKT_]='ma_Virginia',[pmpm_],0) AS ma_Virginia, 
IIf([MKT_]='ma__DE_PA_WV_mh',[pmpm_],0) AS ma__DE_PA_WV_mh, 
IIf([MKT_]='ma_Delaware',[pmpm_],0) AS ma_Delaware, 
IIf([MKT_]='ma_Harrisburg',[pmpm_],0) AS ma_Harrisburg, 
IIf([MKT_]='ma_Philadelphia',[pmpm_],0) AS ma_Philadelphia, 
IIf([MKT_]='ma_Pittsburgh',[pmpm_],0) AS ma_Pittsburgh, 
IIf([MKT_]='ma_WestVirginia',[pmpm_],0) AS ma_WestVirginia, 
IIf([MKT_]='ma__KY_OH_mh',[pmpm_],0) AS ma__KY_OH_mh, 
IIf([MKT_]='ma_Cincinnati',[pmpm_],0) AS ma_Cincinnati, 
IIf([MKT_]='ma_Cleveland',[pmpm_],0) AS ma_Cleveland, 
IIf([MKT_]='ma_Columbus',[pmpm_],0) AS ma_Columbus, 
IIf([MKT_]='ma_Louisville',[pmpm_],0) AS ma_Louisville, 
IIf([MKT_]='ne',[pmpm_],0) AS ne, 
IIf([MKT_]='ne__CT_MA_ME_NH_RI_VT_mh',[pmpm_],0) AS ne__CT_MA_ME_NH_RI_VT_mh, 
IIf([MKT_]='ne_Connecticut',[pmpm_],0) AS ne_Connecticut, 
IIf([MKT_]='ne_Maine',[pmpm_],0) AS ne_Maine, 
IIf([MKT_]='ne_Massachusetts',[pmpm_],0) AS ne_Massachusetts, 
IIf([MKT_]='ne_NewHampshire',[pmpm_],0) AS ne_NewHampshire, 
IIf([MKT_]='ne_RhodeIsland',[pmpm_],0) AS ne_RhodeIsland, 
IIf([MKT_]='ne_Vermont',[pmpm_],0) AS ne_Vermont, 
IIf([MKT_]='ne__IN_MI_MN_NIL_WI_mh',[pmpm_],0) AS ne__IN_MI_MN_NIL_WI_mh, 
IIf([MKT_]='ne_Illinois',[pmpm_],0) AS ne_Illinois, 
IIf([MKT_]='ne_Indianapolis',[pmpm_],0) AS ne_Indianapolis, 
IIf([MKT_]='ne_Michigan',[pmpm_],0) AS ne_Michigan, 
IIf([MKT_]='ne_Minnesota',[pmpm_],0) AS ne_Minnesota, 
IIf([MKT_]='ne_Wisconsin',[pmpm_],0) AS ne_Wisconsin, 
IIf([MKT_]='ne__NY_NJ_mh',[pmpm_],0) AS ne__NY_NJ_mh, 
IIf([MKT_]='ne_NewYork',[pmpm_],0) AS ne_NewYork, 
IIf([MKT_]='ne_NorthernNewJersey',[pmpm_],0) AS ne_NorthernNewJersey, 
IIf([MKT_]='ne_SouthernNewJersey',[pmpm_],0) AS ne_SouthernNewJersey, 
IIf([MKT_]='ne_UpstateNY',[pmpm_],0) AS ne_UpstateNY, 
IIf([MKT_]='se',[pmpm_],0) AS se, 
IIf([MKT_]='se__AL_GA_LA_MS_mh',[pmpm_],0) AS se__AL_GA_LA_MS_mh, 
IIf([MKT_]='se_Alabama',[pmpm_],0) AS se_Alabama, 
IIf([MKT_]='se_Atlanta',[pmpm_],0) AS se_Atlanta, 
IIf([MKT_]='se_Augusta',[pmpm_],0) AS se_Augusta, 
IIf([MKT_]='se_Louisiana',[pmpm_],0) AS se_Louisiana, 
IIf([MKT_]='se_Mississippi',[pmpm_],0) AS se_Mississippi, 
IIf([MKT_]='se__AR_NC_SC_TN_mh',[pmpm_],0) AS se__AR_NC_SC_TN_mh, 
IIf([MKT_]='se_LittleRock',[pmpm_],0) AS se_LittleRock, 
IIf([MKT_]='se_Memphis',[pmpm_],0) AS se_Memphis, 
IIf([MKT_]='se_NCarolina',[pmpm_],0) AS se_NCarolina, 
IIf([MKT_]='se_Nashville',[pmpm_],0) AS se_Nashville, 
IIf([MKT_]='se_SCarolina',[pmpm_],0) AS se_SCarolina, 
IIf([MKT_]='se__FL_mh',[pmpm_],0) AS se__FL_mh, 
IIf([MKT_]='se_Jacksonville',[pmpm_],0) AS se_Jacksonville, 
IIf([MKT_]='se_Orlando',[pmpm_],0) AS se_Orlando, 
IIf([MKT_]='se_SouthFlorida',[pmpm_],0) AS se_SouthFlorida, 
IIf([MKT_]='se_Tampa',[pmpm_],0) AS se_Tampa, 
IIf([MKT_]='we',[pmpm_],0) AS we, 
IIf([MKT_]='we__AK_ID_OR_WA_mh',[pmpm_],0) AS we__AK_ID_OR_WA_mh, 
IIf([MKT_]='we_Alaska',[pmpm_],0) AS we_Alaska, 
IIf([MKT_]='we_Idaho',[pmpm_],0) AS we_Idaho, 
IIf([MKT_]='we_Oregon',[pmpm_],0) AS we_Oregon, 
IIf([MKT_]='we_Washington',[pmpm_],0) AS we_Washington, 
IIf([MKT_]='we__AZ_NM_mh',[pmpm_],0) AS we__AZ_NM_mh, 
IIf([MKT_]='we_Arizona',[pmpm_],0) AS we_Arizona, 
IIf([MKT_]='we_NewMexico',[pmpm_],0) AS we_NewMexico, 
IIf([MKT_]='we__CO_MT_NV_UT_WY_mh',[pmpm_],0) AS we__CO_MT_NV_UT_WY_mh, 
IIf([MKT_]='we_Colorado',[pmpm_],0) AS we_Colorado, 
IIf([MKT_]='we_Montana',[pmpm_],0) AS we_Montana, 
IIf([MKT_]='we_Nevada',[pmpm_],0) AS we_Nevada, 
IIf([MKT_]='we_Utah',[pmpm_],0) AS we_Utah, 
IIf([MKT_]='we_Wyoming',[pmpm_],0) AS we_Wyoming, 
IIf([MKT_]='we__NCA_mh',[pmpm_],0) AS we__NCA_mh, 
IIf([MKT_]='we_CentralValley',[pmpm_],0) AS we_CentralValley, 
IIf([MKT_]='we_Hawaii',[pmpm_],0) AS we_Hawaii, 
IIf([MKT_]='we_NorthernCalifornia',[pmpm_],0) AS we_NorthernCalifornia, 
IIf([MKT_]='we__SCA_mh',[pmpm_],0) AS we__SCA_mh, 
IIf([MKT_]='we_LosAngeles',[pmpm_],0) AS we_LosAngeles, 
IIf([MKT_]='we_SanDiego',[pmpm_],0) AS we_SanDiego

FROM Part1

GROUP BY 
Part1.Company,
Part1.sai_id, 
Part1.period, 
Part1.lob, 
Part1.LobSeg, 
Part1.Fund, 
Part1.SAI_Name_and_No, 
Part1.QB_SAI_ID, 
Part1.bus_unit, 
Part1.Status, 
Part1.savings_start, 
Part1.MKT_, 
Part1.pmpm_






GO
/****** Object:  View [dbo].[zzzzq_Reporting_sub]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO






CREATE VIEW [dbo].[zzzzq_Reporting_sub]
AS

	SELECT        q_LE.LOB, q_LE.Company, q_LE.market, q_LE.Product, q_LE.Segment, q_LE.Fund, q_membership.yrmo,q_membership.yr, q_LE.sai_id,  [med_pmpm] * [med_mems]  AS med_doll,  [rx_pmpm] * [rx_mems] AS rx_doll, 
							 q_membership.med_mems, q_membership.rx_mems, q_membership.MH, q_membership.reg, 
							  q_membership.MH_CP, q_membership.reg_CP, q_membership.MH_ME, q_membership.reg_ME,
							  q_membership.State, q_membership.plan_mkt_cd, 
							 q_membership.Level1, q_membership.Level2
	FROM            dbo.q_LE INNER JOIN
							 dbo.q_membership ON q_LE.Company = q_membership.company AND q_LE.Segment = q_membership.segment AND q_LE.Product = q_membership.product AND 
							 q_LE.Fund = q_membership.fund AND q_LE.LOB = q_membership.lob AND q_LE.market = q_membership.market
	WHERE        q_membership.Category = 'mkt' AND q_membership.yrmo BETWEEN q_le.Start_mo AND q_le.Stop_mo AND [med_mems]+ [rx_pmpm] > 0




GO
/****** Object:  View [dbo].[zzzq_ReportingWSUB]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO








CREATE VIEW [dbo].[zzzq_ReportingWSUB]
AS
SELECT le.company, le.fund, le.reg, le.reg_CP,le.reg_ME,le.state, le.mh, le.mh_CP,le.mh_ME,le.market, le.lob,
 le.segment, le.product, le.yrmo, 
CAST(Left([yrmo],4) AS smallint) AS yr, 
le.sai_id, q_SAI.SAI_Name_and_No, q_SAI.QB_SAI_ID, [med_doll]+[rx_doll] AS doll, le.med_doll, le.rx_doll, 
IIf([q_SAI].[work_grp]='Pharmacy',[rx_mems],[med_mems]) AS mems, 
le.med_mems, le.rx_mems, le.plan_mkt_cd, q_SAI.Status, q_SAI.work_grp, q_SAI.bus_unit, q_SAI.bus_unit_lead, 
IIf(CAST(Left(le.[yrmo],4) AS smallint)>([Savings_Start_year]),CAST(Right([Savings_Realization_Start_Date],2) AS smallint)-1,

13-CAST(Right([Savings_Realization_Start_Date],2) AS smallint)) AS sai_mos, 
IIf(CAST(Left(le.[yrmo],4) AS smallint)>([Savings_Start_year]),'Y','N') AS carryover_ind, 
q_SAI.savings_start_year, q_SAI.Active_or_Idea, q_SAI.Active, q_SAI.Pipeline, q_SAI.ActiveYN, q_SAI.pipelineYN,
 q_SAI.Active_or_IdeaYN, q_SAI.Implementation_Date_Target, q_SAI.Savings_Realization_Start_Date, q_SAI.Confidence_Level, q_SAI.SR_IT_Required,
  q_SAI.SGA_Funding_Required, q_SAI.Affects_Gross_Trend, q_SAI.sai_description, q_SAI.sai_owner, q_SAI.sai_owner_name, q_SAI.Projected_FI_ACAS_PMPM, 
  q_SAI.Projected_FI_HMO_PMPM, q_SAI.Projected_SI_ACAS_PMPM, q_SAI.Projected_SI_HMO_PMPM, q_SAI.Projected_Medicare_Group_PMPM, q_SAI.Projected_Medicare_Retiree_PMPM,
   q_SAI.synergy, q_SAI.Medical_Cost_Category, q_SAI.Unit_Cost_or_Utilization, q_SAI.Last_Updated_dt, q_SAI.last_updated_by_name AS last_updated_by, q_SAI.le_last_updated_dt,
    q_SAI.le_last_updated_by, q_SAI.fi, q_SAI.si, q_SAI.medicare_ind, le.Level1, le.Level2, q_sai.Business_Unit_Alt_Name, q_sai.bus_unit_display_name
FROM q_reporting_sub le 


 INNER JOIN q_SAI ON le.sai_id = q_SAI.sai_id 









GO
/****** Object:  View [dbo].[zzq_adm_015_lobseg_manual_crosstab]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO






CREATE VIEW [dbo].[zzq_adm_015_lobseg_manual_crosstab]
AS

With

Part1 as
(Select 
adm_015_mem.Company, 
adm_015_doll.sai_id, 
adm_015_mem.period, 
adm_015_mem.lob, 
adm_015_mem.LobSeg, 
adm_015_mem.Fund, 
adm_015_doll.SAI_Name_and_No, 
adm_015_doll.QB_SAI_ID, 
adm_015_doll.Business_Unit_Alt_Name AS bus_unit, 
adm_015_doll.Status, 
q_sai.Savings_Realization_Start_Date AS savings_start, 
Replace(Replace([adm_015_mem].[mkt],'.',''),' ','') AS MKT_, 
Sum([doll])/Sum([med_mems]) AS pmpm_

FROM (adm_015_mem 
INNER JOIN adm_015_doll ON (adm_015_mem.Company = adm_015_doll.Company) AND (adm_015_mem.Fund = adm_015_doll.Fund) AND (adm_015_mem.Mkt = adm_015_doll.mkt) AND (adm_015_mem.period = adm_015_doll.period) AND (adm_015_mem.lob = adm_015_doll.lob) AND (adm_015_mem.LobSeg = adm_015_doll.LobSeg)) 
INNER JOIN q_sai ON adm_015_doll.sai_id = q_sai.sai_id

GROUP BY 
adm_015_mem.Company, 
adm_015_doll.sai_id, 
adm_015_mem.period, 
adm_015_mem.lob, 
adm_015_mem.LobSeg, 
adm_015_mem.Fund, 
adm_015_doll.SAI_Name_and_No, 
adm_015_doll.QB_SAI_ID, 
adm_015_doll.Business_Unit_Alt_Name, 
adm_015_doll.Status, 
q_sai.Savings_Realization_Start_Date, 
Replace(Replace([adm_015_mem].[mkt],'.',''),' ','')

)

SELECT 
Part1.Company, 
Part1.sai_id, 
Part1.period, 
Part1.lob, 
Part1.LobSeg, 
Part1.Fund, 
Part1.SAI_Name_and_No, 
Part1.QB_SAI_ID, 
Part1.bus_unit, 
Part1.Status, 
Part1.savings_start, 
Part1.MKT_, 
Part1.pmpm_, 
IIf([MKT_]='_con',[pmpm_],0) AS _con, 
IIf([MKT_]='ce',[pmpm_],0) AS ce, 
IIf([MKT_]='ce__EMO_IA_SD_SIL_mh',[pmpm_],0) AS ce__EMO_IA_SD_SIL_mh, 
IIf([MKT_]='ce_Iowa',[pmpm_],0) AS ce_Iowa, 
IIf([MKT_]='ce_SouthDakota',[pmpm_],0) AS ce_SouthDakota, 
IIf([MKT_]='ce_StLouis',[pmpm_],0) AS ce_StLouis, 
IIf([MKT_]='ce__KS_ND_NE_WMO_mh',[pmpm_],0) AS ce__KS_ND_NE_WMO_mh, 
IIf([MKT_]='ce_KansasCity',[pmpm_],0) AS ce_KansasCity, 
IIf([MKT_]='ce_Nebraska',[pmpm_],0) AS ce_Nebraska, 
IIf([MKT_]='ce_NorthDakota',[pmpm_],0) AS ce_NorthDakota, 
IIf([MKT_]='ce__OK_TX_mh',[pmpm_],0) AS ce__OK_TX_mh, 
IIf([MKT_]='ce_Austin',[pmpm_],0) AS ce_Austin, 
IIf([MKT_]='ce_CorpusChristi',[pmpm_],0) AS ce_CorpusChristi, 
IIf([MKT_]='ce_Dallas',[pmpm_],0) AS ce_Dallas, 
IIf([MKT_]='ce_ElPaso',[pmpm_],0) AS ce_ElPaso, 
IIf([MKT_]='ce_Houston',[pmpm_],0) AS ce_Houston, 
IIf([MKT_]='ce_Oklahoma',[pmpm_],0) AS ce_Oklahoma, 
IIf([MKT_]='ce_SanAntonio',[pmpm_],0) AS ce_SanAntonio, 
IIf([MKT_]='ma',[pmpm_],0) AS ma, 
IIf([MKT_]='ma__DC_MD_VA_mh',[pmpm_],0) AS ma__DC_MD_VA_mh, 
IIf([MKT_]='ma_DC',[pmpm_],0) AS ma_DC, 
IIf([MKT_]='ma_Maryland',[pmpm_],0) AS ma_Maryland, 
IIf([MKT_]='ma_Virginia',[pmpm_],0) AS ma_Virginia, 
IIf([MKT_]='ma__DE_PA_WV_mh',[pmpm_],0) AS ma__DE_PA_WV_mh, 
IIf([MKT_]='ma_Delaware',[pmpm_],0) AS ma_Delaware, 
IIf([MKT_]='ma_Harrisburg',[pmpm_],0) AS ma_Harrisburg, 
IIf([MKT_]='ma_Philadelphia',[pmpm_],0) AS ma_Philadelphia, 
IIf([MKT_]='ma_Pittsburgh',[pmpm_],0) AS ma_Pittsburgh, 
IIf([MKT_]='ma_WestVirginia',[pmpm_],0) AS ma_WestVirginia, 
IIf([MKT_]='ma__KY_OH_mh',[pmpm_],0) AS ma__KY_OH_mh, 
IIf([MKT_]='ma_Cincinnati',[pmpm_],0) AS ma_Cincinnati, 
IIf([MKT_]='ma_Cleveland',[pmpm_],0) AS ma_Cleveland, 
IIf([MKT_]='ma_Columbus',[pmpm_],0) AS ma_Columbus, 
IIf([MKT_]='ma_Louisville',[pmpm_],0) AS ma_Louisville, 
IIf([MKT_]='ne',[pmpm_],0) AS ne, 
IIf([MKT_]='ne__CT_MA_ME_NH_RI_VT_mh',[pmpm_],0) AS ne__CT_MA_ME_NH_RI_VT_mh, 
IIf([MKT_]='ne_Connecticut',[pmpm_],0) AS ne_Connecticut, 
IIf([MKT_]='ne_Maine',[pmpm_],0) AS ne_Maine, 
IIf([MKT_]='ne_Massachusetts',[pmpm_],0) AS ne_Massachusetts, 
IIf([MKT_]='ne_NewHampshire',[pmpm_],0) AS ne_NewHampshire, 
IIf([MKT_]='ne_RhodeIsland',[pmpm_],0) AS ne_RhodeIsland, 
IIf([MKT_]='ne_Vermont',[pmpm_],0) AS ne_Vermont, 
IIf([MKT_]='ne__IN_MI_MN_NIL_WI_mh',[pmpm_],0) AS ne__IN_MI_MN_NIL_WI_mh, 
IIf([MKT_]='ne_Illinois',[pmpm_],0) AS ne_Illinois, 
IIf([MKT_]='ne_Indianapolis',[pmpm_],0) AS ne_Indianapolis, 
IIf([MKT_]='ne_Michigan',[pmpm_],0) AS ne_Michigan, 
IIf([MKT_]='ne_Minnesota',[pmpm_],0) AS ne_Minnesota, 
IIf([MKT_]='ne_Wisconsin',[pmpm_],0) AS ne_Wisconsin, 
IIf([MKT_]='ne__NY_NJ_mh',[pmpm_],0) AS ne__NY_NJ_mh, 
IIf([MKT_]='ne_NewYork',[pmpm_],0) AS ne_NewYork, 
IIf([MKT_]='ne_NorthernNewJersey',[pmpm_],0) AS ne_NorthernNewJersey, 
IIf([MKT_]='ne_SouthernNewJersey',[pmpm_],0) AS ne_SouthernNewJersey, 
IIf([MKT_]='ne_UpstateNY',[pmpm_],0) AS ne_UpstateNY, 
IIf([MKT_]='se',[pmpm_],0) AS se, 
IIf([MKT_]='se__AL_GA_LA_MS_mh',[pmpm_],0) AS se__AL_GA_LA_MS_mh, 
IIf([MKT_]='se_Alabama',[pmpm_],0) AS se_Alabama, 
IIf([MKT_]='se_Atlanta',[pmpm_],0) AS se_Atlanta, 
IIf([MKT_]='se_Augusta',[pmpm_],0) AS se_Augusta, 
IIf([MKT_]='se_Louisiana',[pmpm_],0) AS se_Louisiana, 
IIf([MKT_]='se_Mississippi',[pmpm_],0) AS se_Mississippi, 
IIf([MKT_]='se__AR_NC_SC_TN_mh',[pmpm_],0) AS se__AR_NC_SC_TN_mh, 
IIf([MKT_]='se_LittleRock',[pmpm_],0) AS se_LittleRock, 
IIf([MKT_]='se_Memphis',[pmpm_],0) AS se_Memphis, 
IIf([MKT_]='se_NCarolina',[pmpm_],0) AS se_NCarolina, 
IIf([MKT_]='se_Nashville',[pmpm_],0) AS se_Nashville, 
IIf([MKT_]='se_SCarolina',[pmpm_],0) AS se_SCarolina, 
IIf([MKT_]='se__FL_mh',[pmpm_],0) AS se__FL_mh, 
IIf([MKT_]='se_Jacksonville',[pmpm_],0) AS se_Jacksonville, 
IIf([MKT_]='se_Orlando',[pmpm_],0) AS se_Orlando, 
IIf([MKT_]='se_SouthFlorida',[pmpm_],0) AS se_SouthFlorida, 
IIf([MKT_]='se_Tampa',[pmpm_],0) AS se_Tampa, 
IIf([MKT_]='we',[pmpm_],0) AS we, 
IIf([MKT_]='we__AK_ID_OR_WA_mh',[pmpm_],0) AS we__AK_ID_OR_WA_mh, 
IIf([MKT_]='we_Alaska',[pmpm_],0) AS we_Alaska, 
IIf([MKT_]='we_Idaho',[pmpm_],0) AS we_Idaho, 
IIf([MKT_]='we_Oregon',[pmpm_],0) AS we_Oregon, 
IIf([MKT_]='we_Washington',[pmpm_],0) AS we_Washington, 
IIf([MKT_]='we__AZ_NM_mh',[pmpm_],0) AS we__AZ_NM_mh, 
IIf([MKT_]='we_Arizona',[pmpm_],0) AS we_Arizona, 
IIf([MKT_]='we_NewMexico',[pmpm_],0) AS we_NewMexico, 
IIf([MKT_]='we__CO_MT_NV_UT_WY_mh',[pmpm_],0) AS we__CO_MT_NV_UT_WY_mh, 
IIf([MKT_]='we_Colorado',[pmpm_],0) AS we_Colorado, 
IIf([MKT_]='we_Montana',[pmpm_],0) AS we_Montana, 
IIf([MKT_]='we_Nevada',[pmpm_],0) AS we_Nevada, 
IIf([MKT_]='we_Utah',[pmpm_],0) AS we_Utah, 
IIf([MKT_]='we_Wyoming',[pmpm_],0) AS we_Wyoming, 
IIf([MKT_]='we__NCA_mh',[pmpm_],0) AS we__NCA_mh, 
IIf([MKT_]='we_CentralValley',[pmpm_],0) AS we_CentralValley, 
IIf([MKT_]='we_Hawaii',[pmpm_],0) AS we_Hawaii, 
IIf([MKT_]='we_NorthernCalifornia',[pmpm_],0) AS we_NorthernCalifornia, 
IIf([MKT_]='we__SCA_mh',[pmpm_],0) AS we__SCA_mh, 
IIf([MKT_]='we_LosAngeles',[pmpm_],0) AS we_LosAngeles, 
IIf([MKT_]='we_SanDiego',[pmpm_],0) AS we_SanDiego

FROM Part1

GROUP BY 
Part1.Company, 
Part1.sai_id, 
Part1.period, 
Part1.lob, 
Part1.LobSeg, 
Part1.Fund, 
Part1.SAI_Name_and_No, 
Part1.QB_SAI_ID, 
Part1.bus_unit, 
Part1.Status, 
Part1.savings_start, 
Part1.MKT_,
Part1.pmpm_;





GO
/****** Object:  View [dbo].[q_bus_units]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


CREATE VIEW [dbo].[q_bus_units]
AS
SELECT lku_work_grp.bus_unit, 
lku_work_grp.Business_Unit_Description, 
lku_work_grp.bus_unit_lead, 
lku_work_grp.Business_Unit_Alt_Name
FROM lku_work_grp
GROUP BY lku_work_grp.bus_unit, lku_work_grp.Business_Unit_Description, lku_work_grp.bus_unit_lead, lku_work_grp.Business_Unit_Alt_Name




GO
/****** Object:  View [dbo].[q_membership_yr]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO




CREATE VIEW [dbo].[q_membership_yr]
AS
SELECT        t.company, t.fund, t.market, t.lob, 
                         t.segment, t.product,  t.yr, 
                         t.MH AS MH, t.mh_cp, t.mh_me,t.State, t.reg,t.reg_cp, t.reg_me, t.Level1, t.Level2, 
                         SUM(t.med_mems) AS med_memmos, SUM(t.rx_mems) AS rx_memmos
FROM            dbo.q_membership t  
 
GROUP BY t.company, t.fund, t.market, t.lob, 
                         t.segment, t.product, t.yr, t.MH, t.mh_cp, t.mh_me,
                         t.State, t.reg, t.reg_cp, t.reg_me, t.Level1, t.Level2





GO
/****** Object:  View [dbo].[zzzq_membership_yr_x_bu]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

create VIEW [dbo].[zzzq_membership_yr_x_bu]
AS
SELECT        q_membership_yr.company, q_membership_yr.fund, q_membership_yr.reg, q_membership_yr.MH, 
                         q_membership_yr.State, q_membership_yr.market, q_membership_yr.lob, q_membership_yr.segment, 
                         q_membership_yr.product, q_membership_yr.yr, q_membership_yr.Level1, q_membership_yr.Level2, q_bus_units.bus_unit, 
                         q_membership_yr.med_memmos,   q_membership_yr.rx_memmos
FROM            dbo.q_membership_yr CROSS JOIN
                         q_bus_units


GO
/****** Object:  View [dbo].[xl_membership_pivot]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE VIEW [dbo].[xl_membership_pivot]
	AS
	 SELECT Company, Fund, reg_CP, MH_CP, reg_ME, MH_ME, market, lob, Level1, Level2, segment, product, yr, yrmo, max('<All>') AS work_grp,
		 Sum(q.med_mems) AS med_mems,
		 Sum(q.rx_mems) AS rx_mems 
	FROM q_membership q
	WHERE fund = 'FI' AND yr>=2016
	GROUP BY Company, Fund, reg_CP, MH_CP, reg_ME, MH_ME, market, lob, Level1, Level2, segment, product, yr, yrmo;



GO
/****** Object:  View [dbo].[zzzq_targets_membership_reporting]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO






CREATE VIEW [dbo].[zzzq_targets_membership_reporting]
AS
SELECT q_targets_membership_mh.company, q_targets_membership_mh.fund, q_targets_membership_mh.reg, q_targets_membership_mh.MH, q_targets_membership_mkt.Market, q_targets_membership_mkt.State,  q_targets_membership_mh.lob,
 q_targets_membership_mh.segment, q_targets_membership_mh.product, q_targets_membership_mh.yr, q_bus_units.bus_unit,q_bus_units.Business_Unit_Alt_Name,
	case 
		when [q_targets_membership_mh].[segment]='cb' then 'cb' 
		when q_targets_membership_mh.segment='Hix' then 'hx' 
		when q_targets_membership_mh.lob='cp' then 'cp' 
		else 'me' 
	end AS Level1,
	case 
		when [q_targets_membership_mh].[segment]='cb' then 'cb_cb' 
		when [q_targets_membership_mh].[segment]='Hix' then 'hx_hix' 
		when [q_targets_membership_mh].[lob]='cp' then 'cp_' + [q_targets_membership_mh].[product] 
		else 'me_' + [q_targets_membership_mh].[segment] 
	end AS Level2,
	q_targets_membership_mkt.mktmed_memmos, q_targets_membership_mkt.mktrx_memmos,q_targets_membership_mh.mhmed_memmos, q_targets_membership_mh.mhrx_memmos,  
	q_targets_membership_reg.regmed_memmos, q_targets_membership_reg.regrx_memmos,q_targets_membership_con.conmed_memmos, q_targets_membership_con.conrx_memmos
FROM 
 (
		SELECT t.company, t.fund, t.reg, t.mh, t.market, max(t.state) as [state],t.lob, t.segment, t.product, t.yr, Sum(t.med_memmos) AS mktmed_memmos, Sum(t.rx_memmos) AS mktrx_memmos
		FROM q_membership_yr t 
		GROUP BY t.company, t.fund, t.reg, t.mh, t.market, t.lob, t.segment, t.product, t.yr
) q_targets_membership_mkt 
   

INNER JOIN 
(
		SELECT t.company, t.fund, t.reg, t.mh, t.lob, t.segment, t.product, t.yr, Sum(t.med_memmos) AS mhmed_memmos, Sum(t.rx_memmos) AS mhrx_memmos
		FROM q_membership_yr t 
		GROUP BY t.company, t.fund, t.reg, t.mh, t.lob, t.segment, t.product, t.yr
  ) q_targets_membership_mh 
   ON q_targets_membership_mh.company = q_targets_membership_mkt.company AND q_targets_membership_mh.fund = q_targets_membership_mkt.fund
   AND q_targets_membership_mh.lob = q_targets_membership_mkt.lob AND q_targets_membership_mh.segment = q_targets_membership_mkt.segment
   AND q_targets_membership_mh.product = q_targets_membership_mkt.product AND q_targets_membership_mh.yr = q_targets_membership_mkt.yr
   AND q_targets_membership_mh.reg = q_targets_membership_mkt.reg AND q_targets_membership_mh.mh = q_targets_membership_mkt.mh 

INNER JOIN 
(
		SELECT t.company, t.fund, t.reg, t.lob, t.segment, t.product, t.yr, Sum(t.med_memmos) AS regmed_memmos, Sum(t.rx_memmos) AS regrx_memmos
		FROM q_membership_yr t 
		GROUP BY t.company, t.fund, t.reg, t.lob, t.segment, t.product, t.yr
) q_targets_membership_reg 
   ON q_targets_membership_mh.company = q_targets_membership_reg.company AND q_targets_membership_mh.fund = q_targets_membership_reg.fund
   AND q_targets_membership_mh.lob = q_targets_membership_reg.lob AND q_targets_membership_mh.segment = q_targets_membership_reg.segment
   AND q_targets_membership_mh.product = q_targets_membership_reg.product AND q_targets_membership_mh.yr = q_targets_membership_reg.yr
   AND q_targets_membership_mh.reg = q_targets_membership_reg.reg 
INNER JOIN (
		SELECT t.company, t.fund, t.reg, t.lob, t.segment, t.product, t.yr, Sum(t.med_memmos) AS conmed_memmos, Sum(t.rx_memmos) AS conrx_memmos
		FROM q_membership_yr t 
		GROUP BY t.company, t.fund, t.reg, t.lob, t.segment, t.product, t.yr
) q_targets_membership_con 
   ON q_targets_membership_reg.yr = q_targets_membership_con.yr AND q_targets_membership_reg.product = q_targets_membership_con.product
   AND q_targets_membership_reg.segment = q_targets_membership_con.segment AND q_targets_membership_reg.lob = q_targets_membership_con.lob
   AND q_targets_membership_reg.fund = q_targets_membership_con.fund AND q_targets_membership_reg.company = q_targets_membership_con.company

   CROSS JOIN dbo.q_bus_units q_bus_units 







GO
/****** Object:  View [dbo].[q_targets_reporting_sub]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO









CREATE VIEW [dbo].[q_targets_reporting_sub]
AS
SELECT tt.company, tt.fund, tt.reg, tt.MH,  tt.reg_cp, tt.reg_me, tt.mh_cp,tt.mh_me, tt.Market, tt.State,  tt.lob,
       tt.segment, tt.product, tt.yr,tt.Level1, tt.level2, q_bus_units.bus_unit,q_bus_units.Business_Unit_Alt_Name as bus_unit_nm,
	   tt.med_memmos, tt.rx_memmos
FROM 
 (
		SELECT t.company, t.fund, t.reg, t.mh, t.reg_cp, t.reg_me, t.mh_cp,t.mh_me, t.market, max(t.state) as [state],t.lob, t.segment, t.product, t.yr,
				max(t.Level1) Level1, max(t.Level2) Level2, Sum(t.med_memmos) AS med_memmos, Sum(t.rx_memmos) AS rx_memmos
		FROM q_membership_yr t 
		GROUP BY t.company, t.fund, t.reg, t.mh, t.reg_cp, t.reg_me, t.mh_cp,t.mh_me, t.market, t.lob, t.segment, t.product, t.yr 
) tt 
   

   CROSS JOIN dbo.q_bus_units q_bus_units 










GO
/****** Object:  View [dbo].[q_targets_reporting]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO








CREATE VIEW [dbo].[q_targets_reporting]
AS

select t2.*
	---  ,target_doll/mktmed_memmos AS target_mkt_med, target_doll/mhmed_memmos AS target_mh_med
	---  ,target_doll/regmed_memmos AS target_reg_med, [target_doll]/[conmed_memmos] AS target_con_med

from (
		SELECT t.company, t.fund, t.reg, t.MH,  t.reg_cp, t.reg_me, t.mh_cp,t.mh_me, t.State,
		    t.market, t.lob, t.segment, t.product, t.bus_unit,
		    t.bus_unit_nm, t.yr, t.Level1, t.Level2,
		    Isnull(t_targets.target_based_on_med_mem,0.00)*t.med_memmos + isnull(t_targets.target_based_on_rx_mem,0.00)*t.rx_memmos AS target_doll, 
		    t.med_memmos,t.rx_memmos

		FROM  dbo.q_targets_reporting_sub t left join dbo.t_targets t_targets 
			ON t_targets.yr = t.yr AND t_targets.product = t.product AND t_targets.segment = t.segment 
			AND t_targets.lob = t.lob AND t_targets.market = t.market AND t_targets.fund = t.fund
			AND t_targets.company = t.company and t.bus_unit = t_targets.bus_unit
			where t.med_memmos > 0 
 ) t2














GO
/****** Object:  View [dbo].[zzJUNKxl_savings_pivot]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO










CREATE VIEW [dbo].[zzJUNKxl_savings_pivot]
AS

with sub as (
SELECT m.company,m.fund,m.reg,m.mh,m.market,m.lob,m.Level1,m.Level2,m.segment,m.product,m.yr,m.bus_unit_nm as bus_unit,
					m.target_doll, Isnull(le.med_doll,0.00) + Isnull(le.rx_doll,0.00) as le_doll,m.med_memmos,m.rx_memmos
		from (
				SELECT t.company, t.fund, max(t.reg) reg, max(t.mh) mh, t.market, t.lob, max(Level1) Level1, max(Level2) Level2,
				        t.segment, t.product,  t.yr, t.bus_unit, max(t.bus_unit_nm) as bus_unit_nm
						,Sum(t.target_doll) AS target_doll,sum(t.med_memmos) med_memmos, sum(t.rx_memmos) rx_memmos

				FROM dbo.q_targets_reporting t
				where t.yr >= 2017
				GROUP BY t.company, t.fund, t.market, t.lob,  t.segment, t.product,  t.yr, t.bus_unit
	
			) m left join (
				SELECT r.company, r.fund, max(r.reg) reg, max(r.mh) mh, r.market, r.lob, r.segment, r.product, r.yr, r.bus_unit, 
						Sum(r.med_doll) AS med_doll, Sum(r.rx_doll) AS rx_doll
				FROM q_Reporting r 
				WHERE r.Active_or_Idea=1 and r.yr>=2017
				GROUP BY r.company, r.fund, r.market, r.lob, r.segment, r.product, r.yr, r.bus_unit
			) le 
  
			 ON m.company = le.company AND m.fund = le.fund AND m.market = le.market AND m.lob = le.lob
			  AND m.segment = le.segment AND m.product = le.product AND m.yr = le.yr AND m.bus_unit = le.bus_unit 
      )

		SELECT company, fund, reg, mh, market, lob,Level1, Level2,segment, product, yr, bus_unit 
				,target_doll,le_doll, med_memmos, rx_memmos
		FROM sub
		UNION
	/* summarize without LNMEU */
		SELECT company, fund, reg, mh, market, lob,  max(Level1) Level1, max(Level2) Level2,segment, product, yr, '<All-ex LM>' as bus_unit 
				,Sum(target_doll) AS target_doll,Sum(le_doll) AS le_doll,max(med_memmos) med_memmos, max(rx_memmos) rx_memmos
		FROM sub
		where bus_unit not in ('LM','LNMEU') 
		GROUP BY company, fund, reg, mh, market, lob, segment, product, yr

		UNION 
		/* SUMMARIZE THROUGH ALL BUS_UNITS */
		SELECT company, fund, reg, mh, market, lob,  max(Level1) Level1, max(Level2) Level2,segment, product, yr, '<All-Combine>' as bus_unit 
				,Sum(target_doll) AS target_doll,Sum(le_doll) AS le_doll,max(med_memmos) med_memmos, max(rx_memmos) rx_memmos
		FROM sub
		GROUP BY company, fund, reg, mh, market, lob, segment, product, yr
		
 







GO
/****** Object:  View [dbo].[zzbakxl_savings_pivot]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO








CREATE VIEW [dbo].[zzbakxl_savings_pivot]
AS


SELECT m.*, isnull(le.med_doll,0.00) + isnull(le.rx_doll,0.00) as le
from (
		SELECT t.company, t.fund, t.reg, t.market, t.lob, Level1, Level2, t.segment, t.product,  t.yr, t.bus_unit
				,Sum(t.target_doll) AS target_doll,sum(t.mktmed_memmos) med_memmos, sum(t.mktrx_memmos) rx_memmos

		FROM dbo.q_targets_reporting t
		GROUP BY t.company, t.fund, t.reg, t.market, t.lob, Level1, Level2, t.segment, t.product,  t.yr, t.bus_unit
	
	) m left join (
		SELECT r.company, r.fund, r.reg, r.market, r.lob, r.segment, r.product, r.yr, '<All-Combine>' AS bus_unit, 
				Sum(r.med_doll) AS med_doll, Sum(r.rx_doll) AS rx_doll
		FROM q_Reporting r 
		WHERE r.Active_or_Idea=1 and r.yr >=2017
		GROUP BY r.company, r.fund, r.reg, r.market, r.lob, r.segment, r.product, r.yr
		UNION
		SELECT r.company, r.fund, r.reg, r.market, r.lob, r.segment, r.product, r.yr, r.bus_unit, 
				Sum(r.med_doll) AS med_doll, Sum(r.rx_doll) AS rx_doll
		FROM q_Reporting r 
		WHERE r.Active_or_Idea=1 and r.yr >=2017
		GROUP BY r.company, r.fund, r.reg, r.market, r.lob, r.segment, r.product, r.yr, r.bus_unit
	) le 
  
     ON m.company = le.company AND m.fund = le.fund AND m.market = le.market AND m.lob = le.lob
	  AND m.segment = le.segment AND m.product = le.product AND m.yr = le.yr AND m.bus_unit = le.bus_unit 










GO
/****** Object:  View [dbo].[zz not used anymore adm_ExecDB]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO








CREATE VIEW [dbo].[zz not used anymore adm_ExecDB]
AS
with tsub as (
		SELECT  doll.rnk, doll.sai_nm, doll.bus_unit,
		 doll.doll/mm.mm AS pmpm, mm.Fund, mm.mkt, mm.period, mm.seg, doll.doll, mm.mm,
			case 
					when mm.mkt = '_cons' then 'cons'
					when len(mm.mkt)=2 then substring(mm.mkt,3,99)  
					when charindex('_mh_',mm.mkt) = 0 then substring(mm.mkt,4,len(mm.mkt)-6)
					else substring(mm.mkt,charindex('_mh_',mm.mkt)+4,99) 
			end as mkt_real
		FROM adm_ExecDB_doll doll INNER JOIN adm_ExecDB_mem mm 
				ON doll.seg = mm.seg AND doll.period = mm.period AND doll.mkt = mm.mkt AND doll.Fund = mm.Fund
		WHERE doll.rnk <= 10
--ORDER BY doll.ukey, doll.rnk;
)
SELECT bus_unit + ';' + Fund + ';' + mkt_real + ';' + cast(period as char(4)) + ';' + Seg + ';' AS ukey
		,rnk, sai_nm, pmpm, Fund, mkt_real AS market,
	   IIf(period=s.execdb_current_year,'cur','prior') AS per, seg, doll,mm,
	    lku_market.plan_mkt_cd, 
		case when lku_market.market is null then mkt_real
		     when seg in ('<All>','meGrp','meInd') then lku_market.MajMkt_Nm_Medicare
			 else lku_market.MajMkt_Nm_Commercial end AS MH ,bus_unit
FROM tsub inner join  [dbo].[lku_System] s on 1=1 LEFT JOIN dbo.lku_market lku_market ON tsub.mkt_real = lku_market.market






GO
/****** Object:  View [dbo].[xl_savings_pivot_CP]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO















CREATE VIEW [dbo].[xl_savings_pivot_CP]
AS

with sub as (
SELECT m.company,m.fund,m.reg,m.mh,m.[state],m.market,m.lob,m.Level1,m.Level2,m.segment,m.product,m.yr,m.bus_unit_nm as bus_unit,
					m.target_doll, Isnull(le.doll,0.00) as le_doll,Isnull(le.doll_i,0.00) as le_doll_i,m.med_memmos,m.rx_memmos
		from (
				SELECT t.company, t.fund, max(t.reg_cp) reg, max(t.mh_cp) mh, max(t.[state]) [state], t.market, t.lob, max(Level1) Level1, max(Level2) Level2,
				        t.segment, t.product,  t.yr, t.bus_unit, max(t.bus_unit_nm) as bus_unit_nm
						,Sum(t.target_doll) AS target_doll,sum(t.med_memmos) med_memmos, sum(t.rx_memmos) rx_memmos

				FROM dbo.q_targets_reporting t
				where t.yr >= 2016
				GROUP BY t.company, t.fund, t.market, t.lob,  t.segment, t.product,  t.yr, t.bus_unit
	
			) m left join (
				SELECT r.company, r.fund, r.market, r.lob, r.segment, r.product, r.yr, r.bus_unit, 
						Sum(r.doll) AS doll, sum(case when r.status='Implemented' then r.doll else 0.00 end) as doll_i
				FROM q_Rptg r 
				WHERE r.Active_or_Idea=1 and r.yr>=2016
				GROUP BY r.company, r.fund, r.market, r.lob, r.segment, r.product, r.yr, r.bus_unit
			) le 
  
			 ON m.company = le.company AND m.fund = le.fund AND m.market = le.market AND m.lob = le.lob
			  AND m.segment = le.segment AND m.product = le.product AND m.yr = le.yr AND m.bus_unit = le.bus_unit 
  )
   /* get the detail */
		SELECT company, fund, reg, mh,state, market, lob, segment, product, yr, Level1, Level2, bus_unit 
				,med_memmos, rx_memmos, med_memmos as target_med_memmos, rx_memmos as target_rx_memmos, le_doll,target_doll,le_doll_i 
		FROM sub
		UNION
	/* summarize without LNMEU */
		SELECT company, fund, reg, mh,state, market, lob, segment, product, yr, Level1, Level2, '<All-ex LM>' as bus_unit 
				,max(med_memmos) med_memmos, max(rx_memmos) rx_memmos,max(med_memmos) target_med_memmos, max(rx_memmos) target_rx_memmos
				,Sum(le_doll) AS le_doll,Sum(target_doll) AS target_doll,sum(le_doll_i) AS le_doll_i
		FROM sub
		where bus_unit not in ('LM','LNMEU') 
		GROUP BY company, fund, reg, mh, state, market, lob, segment, product, yr, Level1, Level2

		UNION 
		/* SUMMARIZE THROUGH ALL BUS_UNITS */
		SELECT company, fund, reg, mh, state,market, lob, segment, product, yr, Level1, Level2, '<All-Combine>' as bus_unit 
				,max(med_memmos) med_memmos, max(rx_memmos) rx_memmos,max(med_memmos) target_med_memmos, max(rx_memmos) target_rx_memmos
				,Sum(le_doll) AS le_doll,Sum(target_doll) AS target_doll,sum(le_doll_i) AS le_doll_i
		FROM sub
		GROUP BY company, fund, reg, mh, state,market, lob,segment, product, yr, Level1, Level2
		
 












GO
/****** Object:  View [dbo].[q_reports_daily_targets1]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO





CREATE VIEW [dbo].[q_reports_daily_targets1]
AS
SELECT t.company, t.Level1 , bu.Business_Unit_Alt_Name AS bus_unit, t.yr, CAST( Sum(t.target_doll) AS decimal(12,2) ) AS doll, Sum(t.med_memmos) AS med_memmo,

 CAST( Sum(t.target_doll)/Sum(t.med_memmos) as decimal(12,5) ) AS target_pmpm_med
FROM q_targets_reporting t LEFT JOIN [dbo].[q_bus_units] bu ON t.bus_unit = bu.bus_unit
GROUP BY t.company, t.Level1, bu.Business_Unit_Alt_Name, t.yr

;









GO
/****** Object:  View [dbo].[q_reports_daily_targets2]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[q_reports_daily_targets2]
AS
SELECT        t.company, t.Level2, bu.Business_Unit_Alt_Name AS bus_unit, t.yr, CAST(SUM(t.target_doll) AS decimal(12, 2)) AS doll, SUM(t.med_memmos) AS med_memmo, 
                         CAST(SUM(t.target_doll) / SUM(t.med_memmos) AS decimal(12, 5)) AS target_pmpm_med
FROM            dbo.q_targets_reporting AS t LEFT OUTER JOIN
                         dbo.q_bus_units AS bu ON t.bus_unit = bu.bus_unit
GROUP BY t.company, t.Level2, bu.Business_Unit_Alt_Name, t.yr

GO
/****** Object:  View [dbo].[q_std_001_mem]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE VIEW [dbo].[q_std_001_mem]
AS
  SELECT mm.company, lku_months.yr, Sum(IIf(mm.lob='CP' And mm.segment='Core',[med_mems],0)) AS med_mems_CP,
				    Sum(IIf(mm.[lob]='ME',[med_mems],0)) AS med_mems_ME, Sum(IIf(mm.[segment]='meGrp',[med_mems],0)) AS med_mems_meGrp,
				    Sum(IIf(mm.[segment]='meInd',[med_mems],0)) AS med_mems_meInd,
				    Sum(IIf(mm.[segment]='Hix',[med_mems],0)) AS med_mems_Hix,
				    Sum(IIf(mm.[segment]='cb',[med_mems],0)) AS med_mems_cb
				FROM q_membership mm inner join lku_months on lku_months.yrmo = mm.yrmo
				WHERE mm.fund='fi' 
				GROUP BY mm.company, lku_months.yr





GO
/****** Object:  View [dbo].[q_std_001_doll]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO











CREATE VIEW [dbo].[q_std_001_doll]
AS
 		SELECT
					 max(r.company) AS company, r.sai_id , r.yr , max(r.Active_or_Idea) Active_or_Idea , max([bus_unit]) AS BusUnit, max(r.sai_name_and_no) AS sai_name_and_no, 
					max(r.sai_description) AS sai_description, max(r.Status) AS Status, max(IIf([Affects_Gross_Trend]=1,'Y','N')) AS aff_gr_trnd, 
					max(r.Confidence_Level) AS Confidence_Level, max(r.Implementation_Date_Target) AS Implementation_Date_Target,
					max(r.Savings_Realization_Start_Date) AS Savings_Realization_Start_Date, Sum(IIf([carryover_ind]='Y' And [lob]='ME',[med_doll]+[rx_doll],0)) AS doll_ME_CO,
					Sum(IIf([carryover_ind]='N' And [lob]='ME',[med_doll]+[rx_doll],0)) AS doll_ME_CY,
					Sum(IIf([carryover_ind]='Y' And [lob]='CP' And [segment]='Core',[med_doll]+[rx_doll],0)) AS doll_CP_CO,
					Sum(IIf([carryover_ind]='N' And [lob]='CP' And [segment]='Core',[med_doll]+[rx_doll],0)) AS doll_CP_CY, 
					max(r.Last_Updated_dt) AS Last_Updated_dt, max(r.last_updated_by) AS last_updated_by, max(r.le_last_updated_dt) AS le_last_updated_dt,
					max(r.le_last_updated_by) AS le_last_updated_by, Sum(IIf([carryover_ind]='Y' And [segment]='meGrp',[med_doll]+[rx_doll],0)) AS doll_meGrp_CO,
					Sum(IIf([carryover_ind]='Y' And [segment]='meInd',[med_doll]+[rx_doll],0)) AS doll_meInd_CO,
					Sum(IIf([carryover_ind]='N' And [segment]='meGrp',[med_doll]+[rx_doll],0)) AS doll_meGrp_CY,
					sum(IIf([carryover_ind]='N' And [segment]='meInd',[med_doll]+[rx_doll],0)) AS doll_meInd_CY,
					Sum(IIf([carryover_ind]='Y' And [lob]='CP' And [segment]='Hix',[med_doll]+[rx_doll],0)) AS doll_Hix_CO, 
					Sum(IIf([carryover_ind]='N' And [lob]='CP' And [segment]='Hix',[med_doll]+[rx_doll],0)) AS doll_Hix_CY,
					Sum(IIf([carryover_ind]='Y' And [lob]='CP' And [segment]='cb',[med_doll]+[rx_doll],0)) AS doll_cb_CO, 
					Sum(IIf([carryover_ind]='N' And [lob]='CP' And [segment]='cb',[med_doll]+[rx_doll],0)) AS doll_cb_CY,
					max(r.Business_Unit_Alt_Name) Business_Unit_Alt_Name ,max(r.sai_mos) sai_mos
			FROM q_reporting r
			WHERE r.Active_or_Idea=1 AND r.fund='fi' 
			GROUP BY r.sai_id, r.yr 
 







GO
/****** Object:  View [dbo].[q_reports_daily_Detail]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


CREATE VIEW [dbo].[q_reports_daily_Detail]
AS

Select 
	 BusUnit, sai_name_and_no, sai_description, Status, le_Last_Updated_dt, le_last_updated_by,
	  aff_gr_trnd, Confidence_Level, Implementation_Date_Target, Savings_Realization_Start_Date, 
	cp_co, cp_cy, [cp_co]+[cp_cy] AS cp_tot, 
	cp_co_ny,  cit_co, cit_cy, [cit_co]+[cit_cy] AS cit_tot, 
	cit_co_ny, cb_co, cb_cy, [cb_co]+[cb_cy] AS cb_tot,
	cb_co_ny,  Hix_co,  Hix_cy, [Hix_co]+[Hix_cy] AS Hix_tot,
	Hix_co_ny, me_co, me_cy, [me_co]+[me_cy] AS me_tot,
	me_co_ny,  me_co_grp,	[me_cy_grp], [me_co_grp]+[me_cy_grp] AS me_grp_tot,		 
	me_co_ny_grp,  me_co_ind, me_cy_ind, [me_co_ind]+[me_cy_ind] AS me_ind_tot, 
	me_co_ny_ind,
	company, yr
From (
		SELECT 
			Business_Unit_Alt_Name AS BusUnit, sai_name_and_no, sai_description, Status, le_Last_Updated_dt, le_last_updated_by, aff_gr_trnd, Confidence_Level,
			 Implementation_Date_Target, Savings_Realization_Start_Date,
			case when med_mems_cp > 0 then doll_CP_CO/med_mems_CP else 0 end  AS cp_co,
			case when med_mems_cp > 0 then [doll_CP_CY]/[med_mems_CP] else 0 end AS cp_cy,
			case when med_mems_cp > 0 then ([doll_CP_CY]/[med_mems_CP])*((12-[sai_mos]) /[sai_mos] ) else 0 end AS cp_co_ny, 
			case when [med_mems_Hix]+[med_mems_CB] > 0 then ([doll_Hix_CO]+[doll_CB_CO])/([med_mems_Hix]+[med_mems_CB]) else 0 end AS cit_co,
			case when [med_mems_Hix]+[med_mems_CB] > 0 then ([doll_Hix_CY]+[doll_CB_CY])/([med_mems_Hix]+[med_mems_CB]) else 0 end AS cit_cy, 
			case when [med_mems_Hix]+[med_mems_CB] > 0 then ([doll_Hix_CY]+[doll_CB_CY])/([med_mems_Hix]+[med_mems_CB])*((12-[sai_mos]) /[sai_mos]) else 0 end AS cit_co_ny,
			case when [med_mems_CB]  > 0 then [doll_cb_CO]/[med_mems_cb] else 0 end AS cb_co, 
			case when [med_mems_CB]  > 0 then [doll_cb_CY]/[med_mems_cb] else 0 end AS cb_cy,
			case when [med_mems_CB]  > 0 then ([doll_cb_CY]/[med_mems_cb])*((12-[sai_mos])/[sai_mos]) else 0 end AS cb_co_ny,
			case when [med_mems_Hix] > 0 then [doll_Hix_CO]/[med_mems_Hix] else 0 end AS Hix_co,  
			case when [med_mems_Hix] > 0 then [doll_Hix_CY]/[med_mems_Hix] else 0 end AS Hix_cy,  
			case when [med_mems_Hix] > 0 then ([doll_Hix_CY]/[med_mems_Hix])*((12-[sai_mos])/[sai_mos]) else 0 end AS Hix_co_ny,
			case when [med_mems_Me]  > 0 then [doll_ME_CO]/[med_mems_ME] else 0 end AS me_co, 
			case when [med_mems_Me]  > 0 then [doll_ME_CY]/[med_mems_ME] else 0 end AS me_cy, 
			case when [med_mems_Me]  > 0 then ([doll_ME_CY]/[med_mems_ME])*((12-[sai_mos]) /[sai_mos]) else 0 end AS me_co_ny,
			case when [med_mems_MeGrp] > 0 then [doll_meGrp_CO]/[med_mems_meGrp] else 0 end AS me_co_grp,
			case when [med_mems_MeGrp] > 0 then [doll_meGrp_CY]/[med_mems_meGrp] else 0 end AS me_cy_grp,
			case when [med_mems_MeGrp] > 0 then ([doll_meGrp_CY]/[med_mems_meGrp])*((12-[sai_mos]) /[sai_mos] ) else 0 end AS me_co_ny_grp,
			case when [med_mems_MeInd] > 0 then [doll_meInd_CO]/[med_mems_meInd] else 0 end AS me_co_ind,
			case when [med_mems_MeInd] > 0 then [doll_meInd_CY]/[med_mems_meInd] else 0 end AS me_cy_ind, 
			case when [med_mems_MeInd] > 0 then ([doll_meInd_CY]/[med_mems_meInd])*((12-[sai_mos]) /[sai_mos]) else 0 end AS me_co_ny_ind,
			q_std_001_mem.company, q_std_001_mem.yr
		FROM q_std_001_mem INNER JOIN q_std_001_doll ON q_std_001_mem.yr = q_std_001_doll.yr AND q_std_001_mem.company = q_std_001_doll.company

		) tt

 




	
		







GO
/****** Object:  View [dbo].[zzzq_sai]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO







CREATE VIEW [dbo].[zzzq_sai]
AS
SELECT        t.*, 
                      IsNull(sai_users.DisplayName , t.sai_owner) AS sai_owner_name, 
                      IsNull(lastupdate_users.DisplayName, t.last_updated_by) AS last_updated_by_name, 
                         q_le_last_updated.le_last_updated_dt, q_le_last_updated.le_last_updated_by
FROM   (
		SELECT        dbo.t_SAI.sai_id, dbo.t_SAI.Company, dbo.t_SAI.QB_SAI_ID, dbo.t_SAI.sai_name, 
		dbo.t_SAI.Implementation_Date_Target, YEAR(dbo.t_SAI.Implementation_Date_Target) AS implement_year, 
								 dbo.t_SAI.Savings_Realization_Start_Date, 
								 RTRIM(LTRIM(REPLACE(REPLACE(REPLACE(dbo.t_sai.sai_description, char(10), ' '), char(13), ' '),char(9),' '))) 	 AS sai_description,
								 
								 cast (substring(dbo.t_SAI.Savings_Realization_Start_Date,1, 4) as smallint) AS savings_start_year, dbo.t_SAI.work_grp,
								  dbo.t_SAI.Status, 
								 dbo.t_SAI.sai_owner, dbo.t_SAI.Confidence_Level, dbo.t_SAI.SGA_Funding_Required, dbo.t_SAI.SR_IT_Required, dbo.t_SAI.Affects_Gross_Trend, dbo.t_SAI.Synergy, 
								 dbo.t_SAI.fi, dbo.t_SAI.si, dbo.t_SAI.medicare_ind, dbo.t_SAI.Projected_FI_ACAS_PMPM, dbo.t_SAI.Projected_FI_HMO_PMPM, dbo.t_SAI.Projected_SI_ACAS_PMPM, 
								 dbo.t_SAI.Projected_SI_HMO_PMPM, dbo.t_SAI.Projected_Medicare_Group_PMPM, dbo.t_SAI.Projected_Medicare_Retiree_PMPM, 
								 dbo.t_SAI.SAI_Sizing_Supplement_Document, dbo.t_SAI.original_create_dt, dbo.t_SAI.Last_Updated_dt, dbo.t_SAI.last_updated_by, dbo.t_SAI.Comments, 

								 substring(IIf([Business_Unit_Alt_Name]='N&CS',IIf([lku_work_grp].[work_grp]='NCM','CS',
								 dbo.lku_work_grp.[work_grp]),[Business_Unit_Alt_Name]) + 
								 '-' + cast(dbo.t_SAI.[sai_id] as varchar(9)) + ' - ' + [sai_name],1,253) as SAI_Name_and_No , 
								 dbo.lku_work_grp.bus_unit, dbo.lku_work_grp.bus_unit_lead, 
								 dbo.t_SAI.Medical_Cost_Category, dbo.t_SAI.Unit_Cost_or_Utilization, IIF(Status = 'Active' OR
								 Status = 'Implemented', 1, 0) AS Active, IIF(Status = 'Ideation', 1, 0) AS Pipeline, 
								 IIF(Status in ('Ideation','Active','Implemented'), 1, 0) AS Active_or_Idea,
								 IIF(Status in ('Active', 'Implemented'), 'Y', 'N') AS ActiveYN, 
								 IIF(Status = 'Ideation', 'Y', 'N') AS PipelineYN, 
								 IIF(Status in ('Ideation','Active','Implemented'), 'Y', 'N') AS Active_or_IdeaYN,
								  lku_work_grp.Business_Unit_Alt_Name, lku_work_grp.bus_unit_display_name
		FROM            dbo.t_SAI INNER JOIN
								 dbo.lku_work_grp ON t_SAI.work_grp = dbo.lku_work_grp.work_grp
		) t
 LEFT OUTER JOIN
                         dbo.lku_users AS sai_users ON t.sai_owner = sai_users.AetnaId LEFT OUTER JOIN
                         dbo.lku_users AS lastupdate_users ON t.last_updated_by = lastupdate_users.AetnaId LEFT OUTER JOIN
                         q_le_last_updated ON t.sai_id = q_le_last_updated.sai_id








GO
/****** Object:  View [dbo].[zzadm_115_mem]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO





CREATE VIEW [dbo].[zzadm_115_mem]
AS

with mkt as (
	SELECT Company, reg, mh, market ,  yr AS period, 
	lob,IIf([lob]  = 'ME' Or [segment] in ('Hix' ,'cb'),[segment],[Product]) AS LobSeg, Sum(med_mems) AS med_mems, Sum(rx_mems) AS rx_mems
	FROM q_membership
	WHERE fund = 'FI'
	GROUP BY Company, reg,mh, market,  yr, lob,IIf([lob]  = 'ME' Or [segment] in ('Hix' ,'cb'),[segment],[Product])  
)

	SELECT Company, reg + '_' + market AS Mkt,  period, lob, lobseg, Sum(med_mems) AS med_mems, Sum(rx_mems) AS rx_mems
	FROM mkt
	GROUP BY Company, reg + '_' + market,   period,  lob, lobseg
 
UNION
	SELECT Company, reg + '__' + mh AS Mkt,  period, lob, lobseg, Sum(med_mems) AS med_mems, Sum(rx_mems) AS rx_mems
	FROM mkt
	GROUP BY Company, reg + '__' + mh,   period,  lob, lobseg
UNION
	SELECT Company, reg  AS Mkt,  period, lob, lobseg, Sum(med_mems) AS med_mems, Sum(rx_mems) AS rx_mems
	FROM mkt
	GROUP BY Company, reg,   period,  lob, lobseg
UNION
	SELECT Company,  '_cons' AS Mkt, period, lob, lobseg, Sum(med_mems) AS med_mems, Sum(rx_mems) AS rx_mems
	FROM mkt
	GROUP BY Company,   period,  lob, lobseg


GO
/****** Object:  View [dbo].[adm_ExecDB_mem_w_Company]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO





CREATE VIEW [dbo].[adm_ExecDB_mem_w_Company]
AS
/* commercial first */
SELECT t.Company,t.Fund, t.mkt, t.period, 
case when t.lobseg In ('HMO_PPO') then 'Core' when t.LobSeg in ('IVL') then 'IVL' else t.LobSeg end AS seg, Sum(t.med_mems) AS mm
FROM dbo.q_reports_market_xtab_mem_CP t inner join  lku_System s on t.period in (s.execdb_current_year -1, s.execdb_current_year)
WHERE t.lobseg In ('HMO_PPO')
GROUP BY t.Company,t.Fund, t.mkt, t.period, case when t.lobseg In ('HMO_PPO') then 'Core' when t.LobSeg in ('IVL') then 'IVL' else t.LobSeg end 
having Sum(t.med_mems) > 0 

UNION  /* Medicare */

SELECT t.Company,t.Fund, t.mkt, t.period, t.LobSeg AS seg, Sum(t.med_mems) AS mm
FROM dbo.q_reports_market_xtab_mem_ME t inner join  lku_System s on t.period in (s.execdb_current_year -1, s.execdb_current_year)
WHERE t.lob = 'ME'
GROUP BY t.Company,t.Fund, t.mkt, t.period, t.LobSeg 
having Sum(t.med_mems) > 0 
;





GO
/****** Object:  View [dbo].[adm_ExecDB_doll_w_Company]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO












CREATE VIEW [dbo].[adm_ExecDB_doll_w_Company]
AS
/* commercial first */
with tsub as (
		SELECT t.sai_id, t.Company,'allbu' as bus_unit, t.Fund, t.mkt, t.period, 
			   case when t.lobseg In ('HMO_PPO') then 'Core' when t.LobSeg in ('IVL') then 'IVL' else t.LobSeg end AS seg,
				Sum(t.doll) AS doll,  
				max(t.SAI_Name_and_No) AS sai_nm
		FROM dbo.q_reports_market_xtab_sub_CP t inner join  lku_System s on t.period in (s.execdb_current_year -1, s.execdb_current_year)
		WHERE Len(mkt)>2 And t.lobseg In ('HMO_PPO')
		GROUP BY t.sai_id,t.Company, t.Fund, t.mkt, t.period,t.LobSeg 
		having Sum(t.doll) >0 

		UNION  /* Medicare */
		SELECT t.sai_id, t.Company,'allbu' as bus_unit, t.Fund, t.mkt, t.period,  t.LobSeg  AS seg,
				Sum(t.doll) AS doll,  
				max(t.SAI_Name_and_No) AS sai_nm 
		FROM dbo.q_reports_market_xtab_sub_ME t inner join  lku_System s on t.period in (s.execdb_current_year -1, s.execdb_current_year)  
		WHERE Len(mkt)>2 And t.lob In ('ME')
		GROUP BY t.sai_id,t.Company, t.Fund, t.mkt, t.period,t.LobSeg 
		having Sum(t.doll) >0 

		UNION
		/* LNMEU business unit */
		SELECT t.sai_id,t.Company,t.bus_unit, t.Fund, t.mkt, t.period, 
			   case when t.lobseg In ('HMO_PPO') then 'Core' when t.LobSeg in ('IVL') then 'IVL' else t.LobSeg end AS seg,
				Sum(t.doll) AS doll, 
				max(t.SAI_Name_and_No) AS sai_nm
		FROM dbo.q_reports_market_xtab_sub_CP t inner join  lku_System s on t.period in (s.execdb_current_year -1, s.execdb_current_year)
		WHERE Len(mkt)>2 And t.lobseg In ('HMO_PPO') and t.bus_unit='LNMEU'
		GROUP BY t.sai_id,t.Company,t.bus_unit, t.Fund, t.mkt, t.period,t.LobSeg 
		having Sum(t.doll) >0 

		UNION
		SELECT t.sai_id, t.Company,t.bus_unit, t.Fund, t.mkt, t.period,  t.LobSeg  AS seg,
				Sum(t.doll) AS doll,  
				max(t.SAI_Name_and_No) AS sai_nm
		FROM dbo.q_reports_market_xtab_sub_ME t inner join  lku_System s on t.period in (s.execdb_current_year -1, s.execdb_current_year)  
		WHERE Len(mkt)>2 And t.lob In ('ME') and t.bus_unit='LNMEU'
		GROUP BY t.sai_id,t.Company, t.bus_unit,t.Fund, t.mkt, t.period,t.LobSeg 
		having Sum(t.doll) >0
)

select trnk.* 
from  ( 
		select tsub.*
		,ROW_NUMBER() over(partition by  company,bus_unit, fund, mkt, period, seg ORDER BY doll desc) as rnk
		,ROW_NUMBER() over(partition by  bus_unit, fund, mkt, period, seg ORDER BY doll desc) as rnk_wo_Src		
		from tsub) trnk

where trnk.rnk <= 10 






GO
/****** Object:  View [dbo].[zzadm_115_doll]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO









CREATE VIEW [dbo].[zzadm_115_doll]
AS
 
with mkt_doll as (
	SELECT t.Company, t.market , market.reg,market.MajMkt_Nm as mh,  t.yr AS period, 
	t.savings_start_yr,t.sai_Id, t.SAI_Name_and_No, t.lob ,  IIf(t.lob='ME' Or t.segment in ('Hix','cb'),t.segment,t.Product) AS LobSeg,
	t.fund,t.savings_start_mo,t.sai_owner_name,
	t.bus_unit, t.Business_Unit_Alt_Name,
	/*CASE WHEN [segment] = 'Hix' THEN 'hx' WHEN [segment] = 'CB' THEN 'CB' WHEN [lob] = 'cp' THEN 'cp' ELSE 'me' END  AS Level1, 
    CASE WHEN [segment] = 'Hix' THEN 'hx_hix' WHEN [segment] = 'CB' THEN 'cb_cb' WHEN [lob] = 'cp' THEN CONCAT('cp_', [product]) 
                  ELSE CONCAT('me_', [segment]) END  AS Level2,*/

	 Sum(t.doll) AS doll
	FROM q_Rptg t inner JOIN  dbo.lku_market market ON t.market = market.market and sai_id>7000
	WHERE fund = 'FI'
	GROUP BY  t.Company, t.market , market.reg,market.MajMkt_Nm,  t.yr , 
	t.savings_start_yr,t.sai_Id, t.SAI_Name_and_No, t.lob ,  IIf(t.lob='ME' Or t.segment in ('Hix','cb'),t.segment,t.Product) ,
	t.fund,t.savings_start_mo,t.sai_owner_name,
	t.bus_unit, t.Business_Unit_Alt_Name

)
	SELECT
		 t.Company, t.reg + '_' + t.market as mkt,  t.period, 
		 t.savings_start_yr,t.sai_Id, t.SAI_Name_and_No, t.lob , t.LobSeg,
		 t.fund,t.savings_start_mo,t.sai_owner_name,
		 t.bus_unit, t.Business_Unit_Alt_Name,
		 Sum(t.doll) AS doll
	FROM mkt_doll t 
	GROUP BY
		  t.Company, t.reg + '_' + t.market ,  t.period, 
		  t.savings_start_yr,t.sai_Id, t.SAI_Name_and_No, t.lob ,  t.LobSeg,
	      t.fund,t.savings_start_mo,t.sai_owner_name,
	      t.bus_unit, t.Business_Unit_Alt_Name

	UNION 

	SELECT
		 t.Company, t.reg + '__' + t.mh as mkt,  t.period, 
		 t.savings_start_yr,t.sai_Id, t.SAI_Name_and_No, t.lob , t.LobSeg,
		 t.fund,t.savings_start_mo,t.sai_owner_name,
		 t.bus_unit, t.Business_Unit_Alt_Name,
		 Sum(t.doll) AS doll
	FROM mkt_doll t 
	GROUP BY
		  t.Company, t.reg + '__' + t.mh ,  t.period, 
		  t.savings_start_yr,t.sai_Id, t.SAI_Name_and_No, t.lob ,  t.LobSeg,
	      t.fund,t.savings_start_mo,t.sai_owner_name,
	      t.bus_unit, t.Business_Unit_Alt_Name

	UNION 
		SELECT
		 t.Company, t.reg  as mkt,  t.period, 
		 t.savings_start_yr,t.sai_Id, t.SAI_Name_and_No, t.lob , t.LobSeg,
		 t.fund,t.savings_start_mo,t.sai_owner_name,
		 t.bus_unit, t.Business_Unit_Alt_Name,
		 Sum(t.doll) AS doll
	FROM mkt_doll t 
	GROUP BY
		  t.Company, t.reg  ,  t.period, 
		  t.savings_start_yr,t.sai_Id, t.SAI_Name_and_No, t.lob ,  t.LobSeg,
	      t.fund,t.savings_start_mo,t.sai_owner_name,
	      t.bus_unit, t.Business_Unit_Alt_Name

	UNION 
		SELECT
		 t.Company, '_cons' as mkt,  t.period, 
		 t.savings_start_yr,t.sai_Id, t.SAI_Name_and_No, t.lob , t.LobSeg,
		 t.fund,t.savings_start_mo,t.sai_owner_name,
		 t.bus_unit, t.Business_Unit_Alt_Name,
		 Sum(t.doll) AS doll
	FROM mkt_doll t 
	GROUP BY
		  t.Company,  t.period, 
		  t.savings_start_yr,t.sai_Id, t.SAI_Name_and_No, t.lob ,  t.LobSeg,
	      t.fund,t.savings_start_mo,t.sai_owner_name,
	      t.bus_unit, t.Business_Unit_Alt_Name






GO
/****** Object:  View [dbo].[q_std_009_dollars]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO






CREATE VIEW [dbo].[q_std_009_dollars]
AS
SELECT t.yr,t.lob,t.sai_id, max(t.SAI_Name_and_No) SAI_Name_and_No, max(t.sai_description) sai_description, 
		max(t.carryover_ind) carryover_ind, max(t_LE.med_pmpm) med_pmpm,
		max(t_LE.rx_pmpm) rx_pmpm, max(t.Company) Company, 
		max(t.reg) reg, max(t.mh) mh, max(t.market) market, max(t.State) State, 
		max(t.bus_unit) bus_unit, max(t.work_grp) work_grp, max(iif(t.affects_gross_trend=1,1,0)) affects_gross_trend, 
		max(iif(t.synergy=1,1,0)) synergy, max(t.status) status,
		max(t.Implementation_Date_Target) Implementation_Date_Target, 
		max(t.Savings_Realization_Start_Date) Savings_Realization_Start_Date, max(t.Confidence_Level) Confidence_Level, 
		max(t.sai_owner_name) sai_owner_name, max(t.Last_Updated_dt) Last_Updated_dt, 
		max(t.last_updated_by) last_updated_by, max(t.le_Last_Updated_dt) le_Last_Updated_dt, 
		max(t.le_last_updated_by) le_last_updated_by, max(t.Medical_Cost_Category) Medical_Cost_Category,
		 max(t.Unit_Cost_or_Utilization) Unit_Cost_or_Utilization, 
		Sum(IIf(t.lob='CP' And t.Segment='Core',[doll],0)) AS doll_CP, 
		Sum(IIf(t.[lob]='ME',[doll],0)) AS doll_ME,
		 Sum(IIf(t.lob='CP' And t.product='HMO',[doll],0)) AS doll_CP_HMO, 
		 Sum(IIf(t.lob='CP' And t.Segment='Core' And t.product='PPO',[doll],0)) AS doll_CP_PPO,
		  Sum(IIf(t.[segment]='meGrp',[doll],0)) AS doll_meGrp, 
		  Sum(IIf(t.[segment]='meInd',[doll],0)) AS doll_meInd, 
		  Sum(IIf([t].[lob]='ME' And [t].[Segment]='meGrp',[med_pmpm],0)) AS input_pmpm_meGrp_PMPM, 
		  Sum(IIf([t].[lob]='ME' And [t].[Segment]='meInd',[med_pmpm],0)) AS input_pmpm_meInd_PMPM
		
	FROM q_reporting AS t INNER JOIN t_LE ON t.product = t_LE.Product AND t.segment = t_LE.Segment
		 AND t.lob = t_LE.LOB AND t.market = t_LE.market AND t.fund = t_LE.Fund		  AND t.sai_id = t_LE.sai_id
	group by t.yr,t.lob,t.sai_id 



GO
/****** Object:  View [dbo].[zzJUNKq_reports_market_xtab_doll]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO











CREATE VIEW [dbo].[zzJUNKq_reports_market_xtab_doll]
AS
 
	SELECT t.Company, t.market , market.reg,market.MajMkt_Nm as mh,  t.yr AS period, 
	t.savings_start_yr,t.sai_Id, t.SAI_Name_and_No, t.lob ,  IIf(t.lob='ME' Or t.segment in ('Hix','cb'),t.segment,t.Product) AS LobSeg,
	t.fund,t.savings_start_mo,t.sai_owner_name,
	t.bus_unit, t.Business_Unit_Alt_Name,t.Status,
	/*CASE WHEN [segment] = 'Hix' THEN 'hx' WHEN [segment] = 'CB' THEN 'CB' WHEN [lob] = 'cp' THEN 'cp' ELSE 'me' END  AS Level1, 
    CASE WHEN [segment] = 'Hix' THEN 'hx_hix' WHEN [segment] = 'CB' THEN 'cb_cb' WHEN [lob] = 'cp' THEN CONCAT('cp_', [product]) 
                  ELSE CONCAT('me_', [segment]) END  AS Level2,*/

	 Sum(t.doll) AS doll,
	 sum(t.med_memmo) as med_memmo, sum(t.rx_memmo) rx_memmo
	FROM q_Rptg t inner JOIN  dbo.lku_market market ON t.market = market.market and t.sai_id=3240
	GROUP BY  t.Company, t.market , market.reg,market.MajMkt_Nm,  t.yr , 
	t.savings_start_yr,t.sai_Id, t.SAI_Name_and_No, t.lob ,  IIf(t.lob='ME' Or t.segment in ('Hix','cb'),t.segment,t.Product) ,
	t.fund,t.savings_start_mo,t.sai_owner_name,
	t.bus_unit, t.Business_Unit_Alt_Name,t.Status






GO
/****** Object:  View [dbo].[q_std_009]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO














CREATE VIEW [dbo].[q_std_009]
AS

with q_std_009_mm AS (
		SELECT t.yr,t.Company, t.reg, t.mh, t.market, t.State, t.lob,
		Sum(IIf(t.lob='CP' And t.Segment='Core',[med_mems],0)) AS med_mems_CP,
		 Sum(IIf(t.[lob]='ME',[med_mems],0)) AS med_mems_ME, 
		 Sum(IIf(t.lob='CP' And t.product='HMO',[med_mems],0)) AS med_mems_CP_HMO, 
		 Sum(IIf(t.lob='CP' And t.Segment='Core' And t.product='PPO',[med_mems],0)) AS med_mems_CP_PPO,
		  Sum(IIf(t.[segment]='meGrp',[med_mems],0)) AS med_mems_meGrp,
		   Sum(IIf(t.[segment]='meInd',[med_mems],0)) AS med_mems_meInd, 
		   Sum(IIf(t.lob='CP' And t.Segment='Core',[rx_mems],0)) AS rx_mems_CP, 
		   Sum(IIf(t.[lob]='ME',[rx_mems],0)) AS rx_mems_ME, 
		   Sum(IIf(t.lob='CP' And t.product='HMO',[rx_mems],0)) AS rx_mems_CP_HMO, 
		   Sum(IIf(t.lob='CP' And t.Segment='Core' And t.product='PPO',[rx_mems],0)) AS rx_mems_CP_PPO, 
		   Sum(IIf(t.[segment]='meGrp',[rx_mems],0)) AS rx_mems_meGrp, Sum(IIf(t.[segment]='meInd',[rx_mems],0)) AS rx_mems_meInd
		FROM q_membership AS t 
		WHERE t.fund = 'FI' 
		GROUP BY t.yr,t.Company,  t.reg, t.MH, t.market, t.State,t.lob
)

,q_std_009_mm_con as (
		SELECT t.yr,t.Company AS Company, t.lob,max('con') as mem_level,
		 Sum(IIf([t].[lob]='CP' and [t].[lob]='Core',[med_mems],0)) AS con_med_mems_CP, Sum(IIf([t].[lob]='ME',[med_mems],0)) AS con_med_mems_ME, Sum(IIf([t].[lob]='CP' And [t].[product]='HMO',[med_mems],0)) AS con_med_mems_CP_HMO, Sum(IIf([t].[lob]='CP' and [t].[lob]='Core' And [t].[product]='PPO',[med_mems],0)) AS con_med_mems_CP_PPO, Sum(IIf([t].[segment]='meGrp',[med_mems],0)) AS con_med_mems_meGrp, Sum(IIf([t].[segment]='meInd',[med_mems],0)) AS con_med_mems_meInd, Sum(IIf([t].[lob]='CP' and [t].[lob]='Core',[rx_mems],0)) AS con_rx_mems_CP, Sum(IIf([t].[lob]='ME',[rx_mems],0)) AS con_rx_mems_ME, Sum(IIf([t].[lob]='CP' And [t].[product]='HMO',[rx_mems],0)) AS con_rx_mems_CP_HMO, Sum(IIf([t].[lob]='CP' and [t].[lob]='Core' And [t].[product]='PPO',[rx_mems],0)) AS con_rx_mems_CP_PPO, Sum(IIf([t].[segment]='meGrp',[rx_mems],0)) AS con_rx_mems_meGrp, Sum(IIf([t].[segment]='meInd',[rx_mems],0)) AS con_rx_mems_meInd
		FROM q_membership AS t
		WHERE t.fund = 'FI' 
		GROUP BY t.yr, t.Company,t.lob
)


SELECT q_std_009_mm.yr,q_std_009_mm.lob,q_std_009_mm.Company, q_std_009_dollars.sai_id, q_std_009_dollars.med_pmpm, q_std_009_dollars.rx_pmpm,
	q_std_009_dollars.carryover_ind, q_std_009_dollars.SAI_Name_and_No, q_std_009_dollars.Savings_Realization_Start_Date,
	q_std_009_mm.reg, q_std_009_mm.MH, q_std_009_mm.market, q_std_009_mm.State, q_std_009_dollars.status,
	q_std_009_dollars.bus_unit, q_std_009_dollars.work_grp, q_std_009_dollars.doll_CP AS doll_CP, 
	q_std_009_mm.med_mems_CP AS med_mems_CP, q_std_009_mm.rx_mems_CP AS rx_mems_CP, 
	q_std_009_mm_con.con_med_mems_CP AS con_med_mems_CP, q_std_009_mm_con.con_rx_mems_CP AS con_rx_mems_CP,
    q_std_009_dollars.doll_CP_HMO AS doll_CP_HMO, q_std_009_mm.med_mems_CP_HMO AS med_mems_CP_HMO, 
	q_std_009_mm.rx_mems_CP_HMO AS rx_mems_CP_HMO, q_std_009_mm_con.con_med_mems_CP_HMO AS con_med_mems_CP_HMO,
	 q_std_009_mm_con.con_rx_mems_CP_HMO AS con_rx_mems_CP_HMO, q_std_009_dollars.doll_CP_PPO AS doll_CP_PPO,
	  q_std_009_mm.med_mems_CP_PPO AS med_mems_CP_PPO, q_std_009_mm.rx_mems_CP_PPO AS rx_mems_CP_PPO, 
	  q_std_009_mm_con.con_med_mems_CP_PPO AS con_med_mems_CP_PPO, 
	  q_std_009_mm_con.con_rx_mems_CP_PPO AS con_rx_mems_CP_PPO, q_std_009_dollars.doll_ME AS doll_ME,
	   q_std_009_mm.med_mems_ME AS med_mems_ME, q_std_009_mm.rx_mems_ME AS rx_mems_ME, 
	   q_std_009_mm_con.con_med_mems_ME AS con_med_mems_ME, q_std_009_mm_con.con_rx_mems_ME AS con_rx_mems_ME,
	    q_std_009_dollars.doll_meGrp AS doll_meGrp, q_std_009_mm.med_mems_meGrp AS med_mems_meGrp, 
		q_std_009_mm.rx_mems_meGrp AS rx_mems_meGrp, q_std_009_mm_con.con_med_mems_meGrp AS con_med_mems_meGrp,
		 q_std_009_mm_con.con_rx_mems_meGrp AS con_rx_mems_meGrp, q_std_009_dollars.doll_meInd AS doll_meInd,
		  q_std_009_mm.med_mems_meInd AS med_mems_meInd, q_std_009_mm.rx_mems_meInd AS rx_mems_meInd, 
		  q_std_009_mm_con.con_med_mems_meInd AS con_med_mems_meInd, 
		  q_std_009_mm_con.con_rx_mems_meInd AS con_rx_mems_meInd, Null AS qb_sai_id,
		   q_std_009_dollars.input_pmpm_meGrp_PMPM, q_std_009_dollars.input_pmpm_meInd_PMPM
FROM q_std_009_mm INNER JOIN dbo.q_std_009_dollars q_std_009_dollars 
	ON q_std_009_mm.market = q_std_009_dollars.market AND q_std_009_mm.Company = q_std_009_dollars.Company
	and q_std_009_mm.yr = q_std_009_dollars.yr and q_std_009_mm.lob = q_std_009_dollars.lob
 INNER JOIN q_std_009_mm_con ON q_std_009_mm.Company = q_std_009_mm_con.Company
    and q_std_009_mm_con.yr = q_std_009_dollars.yr and q_std_009_mm.lob = q_std_009_mm_con.lob
 where q_std_009_mm.yr >= 2017






GO
/****** Object:  View [dbo].[zzzqry_Tableau_lobseg_xlat]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[zzzqry_Tableau_lobseg_xlat]
AS
SELECT        dbo.q_membership.Level2, concat(concat(IIf([segment] IN ('CB', 'Hix'), 'Individual', IIf([lob] = 'ME', 'Medicare', 'Commercial')), ' - '), IIf([segment] = 'meGrp', 'Group', 
                         IIf([segment] = 'meInd', 'Individual', IIf([segment] = 'Core', [product], IIf([segment] = 'CB', 'Consumer', 'IVL'))))) AS Level2_
FROM            dbo.q_membership
GROUP BY dbo.q_membership.Level2, dbo.q_membership.lob, dbo.q_membership.segment, dbo.q_membership. product, concat(concat(IIf([segment] IN ('CB', 'Hix'), 'Individual',
                          IIf([lob] = 'ME', 'Medicare', 'Commercial')), ' - '), IIf([segment] = 'meGrp', 'Group', IIf([segment] = 'meInd', 'Individual', IIf([segment] = 'Core', [product], 
                         IIf([segment] = 'CB', 'Consumer', 'IVL')))))
;

GO
/****** Object:  View [dbo].[zzzt_targets_membership]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


CREATE VIEW [dbo].[zzzt_targets_membership]
AS
SELECT        q_membership.company, q_membership.fund, q_membership.market, q_membership.lob, q_membership.segment, q_membership.product,yr, SUM(q_membership.med_mems) AS med_memmos, SUM(q_membership.rx_mems) AS rx_memmos
FROM            dbo.q_membership
WHERE        q_membership.Category = 'mkt'
GROUP BY q_membership.company, q_membership.fund, q_membership.market, q_membership.lob, q_membership.segment, q_membership.product, yr, 
                         q_membership.Category




GO
/****** Object:  View [dbo].[q_reports_daily_targets1_rcw]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[q_reports_daily_targets1_rcw]
AS
SELECT        TOP (2) company, Level1, bus_unit, yr, doll, med_memmo, target_pmpm_med
FROM            dbo.q_reports_daily_targets1

GO
/****** Object:  View [dbo].[zzzzq_membership_with_target]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[zzzzq_membership_with_target]
AS
SELECT        dbo.q_membership_yr.company, dbo.q_membership_yr.fund, dbo.q_membership_yr.market, dbo.q_membership_yr.lob, dbo.q_membership_yr.segment, 
                         dbo.q_membership_yr.product, dbo.q_membership_yr.yr, dbo.q_membership_yr.MH, dbo.q_membership_yr.State, dbo.q_membership_yr.reg, 
                         dbo.q_membership_yr.Level1, dbo.q_membership_yr.Level2, dbo.q_membership_yr.med_memmos, dbo.q_membership_yr.rx_memmos, 
                         IIf(t_targets_membership.med_memmos IS NULL, 0, t_targets_membership.med_memmos) AS target_med_memmos, 
                         IIf(t_targets_membership.rx_memmos IS NULL, 0, t_targets_membership.rx_memmos) AS target_rx_memmos
FROM            dbo.q_membership_yr LEFT OUTER JOIN
                         t_targets_membership ON q_membership_yr.product = t_targets_membership.product AND q_membership_yr.segment = t_targets_membership.segment AND 
                         q_membership_yr.lob = t_targets_membership.lob AND q_membership_yr.market = t_targets_membership.market AND 
                         q_membership_yr.fund = t_targets_membership.fund AND q_membership_yr.company = t_targets_membership.company AND 
                         q_membership_yr.yr = t_targets_membership.yr


GO
/****** Object:  View [dbo].[zzzq_membership_with_target_x_bu]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[zzzq_membership_with_target_x_bu]
AS
SELECT        q_membership_with_target.company, q_membership_with_target.fund, q_membership_with_target.reg, q_membership_with_target.MH, 
                         q_membership_with_target.State, q_membership_with_target.market, q_membership_with_target.lob, q_membership_with_target.segment, 
                         q_membership_with_target.product, q_membership_with_target.yr, q_membership_with_target.Level1, q_membership_with_target.Level2, q_bus_units.bus_unit, 
                         q_membership_with_target.med_memmos, q_membership_with_target.rx_memmos, q_membership_with_target.target_med_memmos, 
                         q_membership_with_target.target_rx_memmos
FROM            dbo.q_membership_with_target CROSS JOIN
                         q_bus_units

GO
/****** Object:  View [dbo].[q_reports_market_xtab_CP]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO













CREATE VIEW [dbo].[q_reports_market_xtab_CP]
AS
 
select *
    ---sai_owner,Company,sai_id,period,LobSeg,Fund,SAI_Name_and_No,bus_unit,Status, savings_start 

from (
		SELECT 
		t.Company,t.period,t.lob,t.LobSeg,t.Fund,
		t.sai_id,t.SAI_Name_and_No,t.sai_owner_name as sai_owner,
		t.Business_Unit_Alt_Name as bus_unit,
		t.Status,t.savings_start_mo as savings_start,t.mkt,
		cast(sum(t.doll)/max(mm.med_mems) as decimal(15,5)) as doll2
		FROM [dbo].[q_reports_market_xtab_sub_CP] t 
		INNER JOIN dbo.q_reports_market_xtab_mem_CP mm 
		    on t.company = mm.company and t.mkt=mm.mkt and t.period=mm.period and t.lob=mm.lob and t.lobseg=mm.lobseg and t.fund=mm.fund 
		GROUP BY  
		t.sai_owner_name ,t.Company,t.sai_id,t.period,t.lob,t.LobSeg,t.Fund,t.SAI_Name_and_No,t.Business_Unit_Alt_Name ,
		t.Status,t.savings_start_mo,t.mkt

      ) tsub

		pivot
		(
		  sum(tsub.doll2)
		  for tsub.mkt in (
[_cons],
[ce],
[ce_EMO_IA_SD_SIL_mh],
[ce_EMO_IA_SD_SIL_mh_Iowa],
[ce_EMO_IA_SD_SIL_mh_South Dakota],
[ce_EMO_IA_SD_SIL_mh_St. Louis],
[ce_KS_ND_NE_WMO_mh],
[ce_KS_ND_NE_WMO_mh_Kansas City],
[ce_KS_ND_NE_WMO_mh_Nebraska],
[ce_KS_ND_NE_WMO_mh_North Dakota],
[ce_OK_TX_mh],
[ce_OK_TX_mh_Austin],
[ce_OK_TX_mh_Corpus Christi],
[ce_OK_TX_mh_Dallas],
[ce_OK_TX_mh_El Paso],
[ce_OK_TX_mh_Houston],
[ce_OK_TX_mh_Oklahoma],
[ce_OK_TX_mh_San Antonio],
[ma],
[ma_DC_MD_VA_mh],
[ma_DC_MD_VA_mh_DC],
[ma_DC_MD_VA_mh_Maryland],
[ma_DC_MD_VA_mh_Virginia],
[ma_DE_PA_WV_mh],
[ma_DE_PA_WV_mh_Delaware],
[ma_DE_PA_WV_mh_Harrisburg],
[ma_DE_PA_WV_mh_Philadelphia],
[ma_DE_PA_WV_mh_Pittsburgh],
[ma_DE_PA_WV_mh_West Virginia],
[ma_KY_OH_mh],
[ma_KY_OH_mh_Cincinnati],
[ma_KY_OH_mh_Cleveland],
[ma_KY_OH_mh_Columbus],
[ma_KY_OH_mh_Louisville],
[ne],
[ne_CT_MA_ME_NH_RI_VT_mh],
[ne_CT_MA_ME_NH_RI_VT_mh_Connecticut],
[ne_CT_MA_ME_NH_RI_VT_mh_Maine],
[ne_CT_MA_ME_NH_RI_VT_mh_Massachusetts],
[ne_CT_MA_ME_NH_RI_VT_mh_New Hampshire],
[ne_CT_MA_ME_NH_RI_VT_mh_Rhode Island],
[ne_CT_MA_ME_NH_RI_VT_mh_Vermont],
[ne_IN_MI_MN_NIL_WI_mh],
[ne_IN_MI_MN_NIL_WI_mh_Illinois],
[ne_IN_MI_MN_NIL_WI_mh_Indianapolis],
[ne_IN_MI_MN_NIL_WI_mh_Michigan],
[ne_IN_MI_MN_NIL_WI_mh_Minnesota],
[ne_IN_MI_MN_NIL_WI_mh_Wisconsin],
[ne_NY_NJ_mh],
[ne_NY_NJ_mh_New York],
[ne_NY_NJ_mh_Northern New Jersey],
[ne_NY_NJ_mh_Southern New Jersey],
[ne_NY_NJ_mh_Upstate NY],
[se],
[se_AL_GA_LA_MS_mh],
[se_AL_GA_LA_MS_mh_Alabama],
[se_AL_GA_LA_MS_mh_Atlanta],
[se_AL_GA_LA_MS_mh_Augusta],
[se_AL_GA_LA_MS_mh_Louisiana],
[se_AL_GA_LA_MS_mh_Mississippi],
[se_AR_NC_SC_TN_mh],
[se_AR_NC_SC_TN_mh_Little Rock],
[se_AR_NC_SC_TN_mh_Memphis],
[se_AR_NC_SC_TN_mh_N Carolina],
[se_AR_NC_SC_TN_mh_Nashville],
[se_AR_NC_SC_TN_mh_S Carolina],
[se_FL_mh],
[se_FL_mh_Jacksonville],
[se_FL_mh_Orlando],
[se_FL_mh_South Florida],
[se_FL_mh_Tampa],
[we],
[we_AK_ID_OR_WA_mh],
[we_AK_ID_OR_WA_mh_Alaska],
[we_AK_ID_OR_WA_mh_Idaho],
[we_AK_ID_OR_WA_mh_Oregon],
[we_AK_ID_OR_WA_mh_Washington],
[we_AZ_NM_mh],
[we_AZ_NM_mh_Arizona],
[we_AZ_NM_mh_New Mexico],
[we_CO_MT_NV_UT_WY_mh],
[we_CO_MT_NV_UT_WY_mh_Colorado],
[we_CO_MT_NV_UT_WY_mh_Montana],
[we_CO_MT_NV_UT_WY_mh_Nevada],
[we_CO_MT_NV_UT_WY_mh_Utah],
[we_CO_MT_NV_UT_WY_mh_Wyoming],
[we_NCA_mh],
[we_NCA_mh_Central Valley],
[we_NCA_mh_Hawaii],
[we_NCA_mh_Northern California],
[we_SCA_mh],
[we_SCA_mh_Los Angeles],
[we_SCA_mh_San Diego]

			)
		) piv




GO
/****** Object:  View [dbo].[zzq_sai]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[zzq_sai]
AS
SELECT        dbo.q_sai_sub.*, 
                      IIf(sai_users.DisplayName IS NULL, dbo.q_sai_sub.sai_owner, sai_users.DisplayName) AS sai_owner_name, 
                      IIf(lastupdate_users.DisplayName IS NULL, dbo.q_sai_sub.last_updated_by, lastupdate_users.DisplayName) AS last_updated_by_name, 
                         q_le_last_updated.le_last_updated_dt, q_le_last_updated.le_last_updated_by
FROM            dbo.q_sai_sub LEFT OUTER JOIN
                         dbo.lku_users AS sai_users ON q_sai_sub.sai_owner = sai_users.AetnaId LEFT OUTER JOIN
                         dbo.lku_users AS lastupdate_users ON q_sai_sub.last_updated_by = lastupdate_users.AetnaId LEFT OUTER JOIN
                         q_le_last_updated ON q_sai_sub.sai_id = q_le_last_updated.sai_id

GO
/****** Object:  View [dbo].[zzq_Reporting_sub]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[zzq_Reporting_sub]
AS
SELECT t_reporting.company, t_reporting.fund, t_reporting.reg, t_reporting.state, t_reporting.mh, t_reporting.market, t_reporting.lob, t_reporting.segment, t_reporting.product, t_reporting.yrmo, 
CAST(Left([yrmo],4) AS int) AS yr, 
t_reporting.sai_id, q_SAI.SAI_Name_and_No, q_SAI.QB_SAI_ID, [med_doll]+[rx_doll] AS doll, t_reporting.med_doll, t_reporting.rx_doll, 
IIf([q_SAI].[work_grp]='Pharmacy',[rx_mems],[med_mems]) AS mems, 
t_reporting.med_mems, t_reporting.rx_mems, t_reporting.plan_mkt_cd, q_SAI.Status, q_SAI.work_grp, q_SAI.bus_unit, q_SAI.bus_unit_lead, 
IIf(CAST(Left([t_reporting].[yrmo],4) AS int)>([Savings_Start_year]),
CAST(Right([Savings_Realization_Start_Date],2) AS int)-1,
13-CAST(Right([Savings_Realization_Start_Date],2) AS int)) AS sai_mos, 
IIf(CAST(Left([t_reporting].[yrmo],4) AS int)>([Savings_Start_year]),'Y','N') AS carryover_ind, 
q_SAI.savings_start_year, q_SAI.Active_or_Idea, q_SAI.Active, q_SAI.Pipeline, q_SAI.ActiveYN, q_SAI.pipelineYN, q_SAI.Active_or_IdeaYN, q_SAI.Implementation_Date_Target, q_SAI.Savings_Realization_Start_Date, q_SAI.Confidence_Level, q_SAI.SR_IT_Required, q_SAI.SGA_Funding_Required, q_SAI.Affects_Gross_Trend, q_SAI.sai_description, q_SAI.sai_owner, q_SAI.sai_owner_name, q_SAI.Projected_FI_ACAS_PMPM, q_SAI.Projected_FI_HMO_PMPM, q_SAI.Projected_SI_ACAS_PMPM, q_SAI.Projected_SI_HMO_PMPM, q_SAI.Projected_Medicare_Group_PMPM, q_SAI.Projected_Medicare_Retiree_PMPM, q_SAI.synergy, q_SAI.Medical_Cost_Category, q_SAI.Unit_Cost_or_Utilization, q_SAI.Last_Updated_dt, q_SAI.last_updated_by_name AS last_updated_by, q_SAI.le_last_updated_dt, q_SAI.le_last_updated_by, q_SAI.fi, q_SAI.si, q_SAI.medicare_ind, t_reporting.Level1, t_reporting.Level2, lku_work_grp.Business_Unit_Alt_Name, lku_work_grp.bus_unit_display_name
FROM (t_reporting INNER JOIN q_SAI ON t_reporting.sai_id = q_SAI.sai_id) 
INNER JOIN lku_work_grp ON q_SAI.work_grp = lku_work_grp.work_grp;

GO
/****** Object:  View [dbo].[xl_savings_pivot_ME]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO




CREATE VIEW [dbo].[xl_savings_pivot_ME]
AS

with sub as (
SELECT m.company,m.fund,m.reg,m.mh,m.state,m.market,m.lob,m.Level1,m.Level2,m.segment,m.product,m.yr,m.bus_unit_nm as bus_unit,
					m.target_doll, Isnull(le.doll,0.00) as le_doll,Isnull(le.doll_i,0.00) as le_doll_i,m.med_memmos,m.rx_memmos 
					

		from (
				SELECT t.company, t.fund, max(t.reg_me) reg, max(t.mh_me) mh,max(t.state) state, t.market, t.lob, max(Level1) Level1, max(Level2) Level2,
				        t.segment, t.product,  t.yr, t.bus_unit, max(t.bus_unit_nm) as bus_unit_nm
						,Sum(t.target_doll) AS target_doll,sum(t.med_memmos) med_memmos, sum(t.rx_memmos) rx_memmos

				FROM dbo.q_targets_reporting t
				where t.yr >= 2016
				GROUP BY t.company, t.fund, t.market, t.lob,  t.segment, t.product,  t.yr, t.bus_unit
	
			) m left join (
				SELECT r.company, r.fund, r.market, r.lob, r.segment, r.product, r.yr, r.bus_unit, 
						Sum(r.doll) AS doll, sum(case when r.status='Implemented' then r.doll else 0.00 end) as doll_i
				FROM q_Rptg r 
				WHERE r.Active_or_Idea=1 and r.yr>=2016
				GROUP BY r.company, r.fund, r.market, r.lob, r.segment, r.product, r.yr, r.bus_unit
			) le 
  
			 ON m.company = le.company AND m.fund = le.fund AND m.market = le.market AND m.lob = le.lob
			  AND m.segment = le.segment AND m.product = le.product AND m.yr = le.yr AND m.bus_unit = le.bus_unit 
  )
   /* get the detail */
		SELECT company, fund, reg, mh,state, market, lob,segment, product, yr,Level1, Level2, bus_unit 
				,med_memmos, rx_memmos, med_memmos as target_med_memmos, rx_memmos as target_rx_memmos, le_doll,target_doll,le_doll_i 
		FROM sub
		UNION
	/* summarize without LNMEU */
		SELECT company, fund, reg, mh,state, market, lob,segment, product, yr,  Level1,  Level2, '<All-ex LM>' as bus_unit 
				,max(med_memmos) med_memmos, max(rx_memmos) rx_memmos,max(med_memmos) target_med_memmos, max(rx_memmos) target_rx_memmos
				,Sum(le_doll) AS le_doll,Sum(target_doll) AS target_doll,sum(le_doll_i) AS le_doll_i
		FROM sub
		where bus_unit not in ('LM','LNMEU') 
		GROUP BY company, fund, reg, mh,state, market, lob,segment, product, yr, Level1, Level2

		UNION 
		/* SUMMARIZE THROUGH ALL BUS_UNITS */
		SELECT company, fund, reg, mh,state, market, lob,segment, product, yr,  Level1, Level2, '<All-Combine>' as bus_unit 
				,max(med_memmos) med_memmos, max(rx_memmos) rx_memmos,max(med_memmos) target_med_memmos, max(rx_memmos) target_rx_memmos
				,Sum(le_doll) AS le_doll,Sum(target_doll) AS target_doll,sum(le_doll_i) AS le_doll_i
		FROM sub
		GROUP BY company, fund, reg, mh,state, market, lob,segment, product, yr, Level1, Level2
		
 













GO
/****** Object:  View [dbo].[q_reports_market_xtab_ME]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO







CREATE VIEW [dbo].[q_reports_market_xtab_ME]
AS
 
select *
    ---sai_owner,Company,sai_id,period,LobSeg,Fund,SAI_Name_and_No,bus_unit,Status, savings_start 

from (
		SELECT 
		t.Company,t.period,t.lob,t.LobSeg,t.Fund,
		t.sai_id,t.SAI_Name_and_No,t.sai_owner_name as sai_owner,
		t.Business_Unit_Alt_Name as bus_unit,
		t.Status,t.savings_start_mo as savings_start,t.mkt,
		cast(sum(t.doll)/max(mm.med_mems) as decimal(15,5)) as doll2
		FROM [dbo].[q_reports_market_xtab_sub_ME] t 
		INNER JOIN dbo.q_reports_market_xtab_mem_ME mm 
		    on t.company = mm.company and t.mkt=mm.mkt and t.period=mm.period and t.lob=mm.lob and t.lobseg=mm.lobseg and t.fund=mm.fund 
		GROUP BY  
		t.sai_owner_name ,t.Company,t.sai_id,t.period,t.lob,t.LobSeg,t.Fund,t.SAI_Name_and_No,t.Business_Unit_Alt_Name ,
		t.Status,t.savings_start_mo,t.mkt

      ) tsub

		pivot
		(
		  sum(tsub.doll2)
		  for tsub.mkt in (
 
 [_cons],
[ce],
[ce_AR_KS_OK_WMO_mh],
[ce_AR_KS_OK_WMO_mh_Kansas City],
[ce_AR_KS_OK_WMO_mh_Little Rock],
[ce_AR_KS_OK_WMO_mh_Oklahoma],
[ce_EMO_SIL_mh],
[ce_EMO_SIL_mh_St. Louis],
[ce_IA_NE_ND_SD_mh],
[ce_IA_NE_ND_SD_mh_Iowa],
[ce_IA_NE_ND_SD_mh_Nebraska],
[ce_IA_NE_ND_SD_mh_North Dakota],
[ce_IA_NE_ND_SD_mh_South Dakota],
[ce_TX_mh],
[ce_TX_mh_Austin],
[ce_TX_mh_Corpus Christi],
[ce_TX_mh_Dallas],
[ce_TX_mh_El Paso],
[ce_TX_mh_Houston],
[ce_TX_mh_San Antonio],
[ma],
[ma_DC_MD_VA_mh],
[ma_DC_MD_VA_mh_DC],
[ma_DC_MD_VA_mh_Maryland],
[ma_DC_MD_VA_mh_Virginia],
[ma_DE_PA_WV_mh],
[ma_DE_PA_WV_mh_Delaware],
[ma_DE_PA_WV_mh_Harrisburg],
[ma_DE_PA_WV_mh_Philadelphia],
[ma_DE_PA_WV_mh_Pittsburgh],
[ma_DE_PA_WV_mh_West Virginia],
[ma_KY_OH_mh],
[ma_KY_OH_mh_Cincinnati],
[ma_KY_OH_mh_Cleveland],
[ma_KY_OH_mh_Columbus],
[ma_KY_OH_mh_Louisville],
[ne],
[ne_CT_MA_ME_NH_RI_VT_mh],
[ne_CT_MA_ME_NH_RI_VT_mh_Connecticut],
[ne_CT_MA_ME_NH_RI_VT_mh_Maine],
[ne_CT_MA_ME_NH_RI_VT_mh_Massachusetts],
[ne_CT_MA_ME_NH_RI_VT_mh_New Hampshire],
[ne_CT_MA_ME_NH_RI_VT_mh_Rhode Island],
[ne_CT_MA_ME_NH_RI_VT_mh_Vermont],
[ne_IN_MI_MN_NIL_WI_mh],
[ne_IN_MI_MN_NIL_WI_mh_Illinois],
[ne_IN_MI_MN_NIL_WI_mh_Indianapolis],
[ne_IN_MI_MN_NIL_WI_mh_Michigan],
[ne_IN_MI_MN_NIL_WI_mh_Minnesota],
[ne_IN_MI_MN_NIL_WI_mh_Wisconsin],
[ne_NJ_mh],
[ne_NJ_mh_Northern New Jersey],
[ne_NJ_mh_Southern New Jersey],
[ne_NY_mh],
[ne_NY_mh_New York],
[ne_NY_mh_Upstate NY],
[se],
[se_AL_GA_LA_MS_mh],
[se_AL_GA_LA_MS_mh_Alabama],
[se_AL_GA_LA_MS_mh_Atlanta],
[se_AL_GA_LA_MS_mh_Augusta],
[se_AL_GA_LA_MS_mh_Louisiana],
[se_AL_GA_LA_MS_mh_Mississippi],
[se_FL_mh],
[se_FL_mh_Jacksonville],
[se_FL_mh_Orlando],
[se_FL_mh_South Florida],
[se_FL_mh_Tampa],
[se_NC_SC_TN_mh],
[se_NC_SC_TN_mh_Memphis],
[se_NC_SC_TN_mh_N Carolina],
[se_NC_SC_TN_mh_Nashville],
[se_NC_SC_TN_mh_S Carolina],
[we],
[we_AK_ID_OR_WA_mh],
[we_AK_ID_OR_WA_mh_Alaska],
[we_AK_ID_OR_WA_mh_Idaho],
[we_AK_ID_OR_WA_mh_Oregon],
[we_AK_ID_OR_WA_mh_Washington],
[we_AZ_NM_mh],
[we_AZ_NM_mh_Arizona],
[we_AZ_NM_mh_New Mexico],
[we_CO_MT_NV_UT_WY_mh],
[we_CO_MT_NV_UT_WY_mh_Colorado],
[we_CO_MT_NV_UT_WY_mh_Montana],
[we_CO_MT_NV_UT_WY_mh_Nevada],
[we_CO_MT_NV_UT_WY_mh_Utah],
[we_CO_MT_NV_UT_WY_mh_Wyoming],
[we_NCA_mh],
[we_NCA_mh_Central Valley],
[we_NCA_mh_Hawaii],
[we_NCA_mh_Northern California],
[we_SCA_mh],
[we_SCA_mh_Los Angeles],
[we_SCA_mh_San Diego]

			)
		) piv







GO
/****** Object:  View [dbo].[99_test_membership]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[99_test_membership]
AS

SELECT sum([med_mems]) as med
      ,sum([rx_mems]) as rx 
  FROM [SAIP001].[dbo].[t_membership]
  where category='mkt'
  UNION  
  SELECT  sum([med_mems_con]) as med_con
      ,sum([rx_mems_con]) as rx_con 
  FROM [SAIP001].[dbo].[q_mem_year_con]
  UNION   
   SELECT sum([med_mems_reg]) as med_reg
      ,sum([rx_mems_reg]) as rx_reg
  FROM [SAIP001].[dbo].[q_mem_year_reg]

GO
/****** Object:  View [dbo].[q_mems_year_con]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO











CREATE VIEW [dbo].[q_mems_year_con]
AS
SELECT [company]
      ,[fund]
      ,[lob]
      ,[segment]
      ,substring(yrmo,1,4) as yr 
      ,sum([med_mems]) as med_mems_con
      ,sum([rx_mems]) as rx_mems_con
  FROM [SAIP001].[dbo].[n_membership] t 
  where yrmo >= '201700'
  group by 
  [company]
      ,[fund]
      ,[lob]
      ,[segment]
      ,substring(yrmo,1,4) 













GO
/****** Object:  View [dbo].[q_mems_year_reg]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO











CREATE VIEW [dbo].[q_mems_year_reg]
AS
SELECT [company]
      ,[fund]
	       ,mkt.[reg]
      ,[lob]
      ,[segment]
      ,substring(yrmo,1,4) as yr 
      ,sum([med_mems]) as med_mems_reg
      ,sum([rx_mems]) as rx_mems_reg
  FROM [SAIP001].[dbo].[n_membership] t inner join [dbo].[lku_market] mkt on mkt.market = t.market 
  group by 
  [company]
      ,[fund]
	       ,mkt.[reg]
      ,[lob]
      ,[segment]
      ,substring(yrmo,1,4) 












GO
/****** Object:  View [dbo].[qlku_Cartesian_mkt_prod_etc]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[qlku_Cartesian_mkt_prod_etc]
AS
SELECT        dbo.lku_market.market, dbo.lku_market.plan_mkt_cd, dbo.lku_product.LOB, dbo.lku_product.Product, dbo.lku_segment.Segment, 
                         dbo.lku_product.LOB + ';' + dbo.lku_product.Product + ';' + dbo.lku_segment.Segment AS Lob_Product_Segment
FROM            dbo.lku_segment CROSS JOIN
                         dbo.lku_product CROSS JOIN
                         dbo.lku_market

GO
/****** Object:  View [dbo].[validate_not_on_lookup_table]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[validate_not_on_lookup_table]
       AS 
select distinct 't_LE.market' as tbl, TRY_CONVERT(varchar(100), a.market) as valu from t_LE a left join lku_market b 
         on a.market = b.market where b.market is null 
               UNION
select distinct 't_mem.market' as tbl, TRY_CONVERT(varchar(100),a.market) as valu from t_membership a left join lku_market b 
         on a.market = b.market where b.market is null  and a.market != '<All>'
              UNION
select distinct 't_LE.product' as tbl, TRY_CONVERT(varchar(100),a.product) as valu from t_LE a left join lku_product b 
         on a.product = b.product where b.product is null 
UNION
select distinct 't_LE.segment' as tbl, TRY_CONVERT(varchar(100),a.segment) as valu from t_LE a left join lku_segment b 
         on a.segment = b.segment where b.segment is null 
UNION
select distinct 't_LE.sai' as tbl, TRY_CONVERT(varchar(100),a.sai_id) as valu from t_LE a left join t_SAI b 
         on a.sai_id = b.sai_id where b.sai_id is null 
UNION
select distinct 't_SAI.status' as tbl, TRY_CONVERT(varchar(100),a.status) as valu from t_SAI a left join lku_status b 
         on a.status = b.status where b.status is null 
UNION
select distinct 't_SAI_work_grp' as tbl, TRY_CONVERT(varchar(100),a.work_grp) as valu from t_SAI a left join lku_work_grp b 
         on a.work_grp = b.work_grp where b.work_grp is null
              UNION
SELECT distinct 'lku_work_grp.wg_lead' AS tbl, TRY_CONVERT(varchar(100),a.wg_lead) as valu
FROM lku_work_grp a LEFT JOIN lku_users b ON a.wg_lead = b.AetnaId and lower( a.wg_lead) like 'a%'
WHERE b.AetnaId Is Null
UNION

SELECT distinct 't_sai.sai_owner' AS tbl, TRY_CONVERT(varchar(100),a.sai_owner) as valu
FROM t_SAI a LEFT JOIN lku_users b ON a.sai_owner = b.AetnaId and lower(a.sai_owner) like 'a%'
WHERE b.AetnaId Is Null
UNION
SELECT distinct 'lku_work_grp.bus_unit_lead' AS tbl, TRY_CONVERT(varchar(100),a.bus_unit_lead) as valu
FROM lku_work_grp a LEFT JOIN lku_users b ON a.bus_unit_lead = b.AetnaId and lower(a.bus_unit_lead) like 'a%'
WHERE b.AetnaId Is Null 



GO
/****** Object:  View [dbo].[zzadm_015_doll_lob]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO






CREATE VIEW [dbo].[zzadm_015_doll_lob]
AS

SELECT adm_015_doll.sai_id , adm_015_doll.SAI_Name_and_No , adm_015_doll.QB_SAI_ID , adm_015_doll.Status , adm_015_doll.bus_unit , adm_015_doll.Business_Unit_Alt_Name , adm_015_doll.Company , adm_015_doll.Fund , adm_015_doll.mkt , adm_015_doll.period , adm_015_doll.lob , 

Case When adm_015_doll.LobSeg='cb' then 'cb'
     when adm_015_doll.LobSeg='Hix' then 'Hix'
     when adm_015_doll.lob='CP' then 'HMO_PPO'
else '<All>'

End AS LobSeg, 

Sum(adm_015_doll.doll) AS doll

FROM adm_015_doll

GROUP BY adm_015_doll.sai_id, adm_015_doll.SAI_Name_and_No, adm_015_doll.QB_SAI_ID, adm_015_doll.Status, adm_015_doll.bus_unit, adm_015_doll.Business_Unit_Alt_Name, adm_015_doll.Company, adm_015_doll.Fund, adm_015_doll.mkt, adm_015_doll.period, adm_015_doll.lob, 
Case When adm_015_doll.LobSeg='cb' then 'cb'
     when adm_015_doll.LobSeg='Hix' then 'Hix'
     when adm_015_doll.lob='CP' then 'HMO_PPO'
else '<All>'

End;



GO
/****** Object:  View [dbo].[zzadm_015_mem_lob]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO






CREATE VIEW [dbo].[zzadm_015_mem_lob]
AS

SELECT adm_015_mem.Company, adm_015_mem.Fund, adm_015_mem.Mkt, adm_015_mem.period, adm_015_mem.lob, 

Case When adm_015_mem.LobSeg='cb' then 'cb'
     when adm_015_mem.LobSeg='Hix' then 'Hix'
     when adm_015_mem.lob='CP' then 'HMO_PPO'
else '<All>'

End AS LobSeg, 

adm_015_mem.mem_level, Sum(adm_015_mem.med_mems) AS med_mems, Sum(adm_015_mem.rx_mems) AS rx_mems

FROM adm_015_mem

GROUP BY adm_015_mem.Company, adm_015_mem.Fund, adm_015_mem.Mkt, adm_015_mem.period, adm_015_mem.lob, 
Case When adm_015_mem.LobSeg='cb' then 'cb'
     when adm_015_mem.LobSeg='Hix' then 'Hix'
     when adm_015_mem.lob='CP' then 'HMO_PPO'
else '<All>'

End, adm_015_mem.mem_level;







GO
/****** Object:  View [dbo].[zzJUNKq_membership_with_levels]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO








CREATE VIEW [dbo].[zzJUNKq_membership_with_levels]
AS

select tt.*
	  ,sum(med_mems) over (partition by company ,fund,reg, mh,lob,segment,product,yrmo) as med_mem_mh 
	  ,sum(rx_mems) over (partition by company ,fund,reg, mh,lob,segment,product,yrmo) as rx_mem_mh 
	  ,sum(med_mems) over (partition by company ,fund,reg, lob,segment,product,yrmo) as med_mem_reg 
	  ,sum(rx_mems) over (partition by company ,fund,reg, lob,segment,product,yrmo) as rx_mem_reg
	  ,sum(med_mems) over (partition by company ,fund, lob,segment,product,yrmo) as med_mem_con 
	  ,sum(rx_mems) over (partition by company ,fund, lob,segment,product,yrmo) as rx_mem_con	
	  
	  ,sum(med_mems) over (partition by company ,fund,reg_me, mh_me,lob,segment,product,yrmo) as med_mem_mh_me 
	  ,sum(rx_mems) over (partition by company ,fund,reg_me, mh_me,lob,segment,product,yrmo) as rx_mem_mh_me
	  ,sum(med_mems) over (partition by company ,fund,reg_me, lob,segment,product,yrmo) as med_mem_reg_me 
	  ,sum(rx_mems) over (partition by company ,fund,reg_me, lob,segment,product,yrmo) as rx_mem_reg_me
   
   	  ,sum(med_mems) over (partition by company ,fund,reg_cp, mh_me,lob,segment,product,yrmo) as med_mem_mh_cp
	  ,sum(rx_mems) over (partition by company ,fund,reg_cp, mh_me,lob,segment,product,yrmo) as rx_mem_mh_cp 
	  ,sum(med_mems) over (partition by company ,fund,reg_cp, lob,segment,product,yrmo) as med_mem_reg_cp
	  ,sum(rx_mems) over (partition by company ,fund,reg_cp, lob,segment,product,yrmo) as rx_mem_reg_cp

from (
		SELECT          t.company, t.fund, 

		case when t.lob='CP' then dbo.lku_market.reg_Commercial else dbo.lku_market.reg_Medicare end as reg, 
		case when t.lob='CP' then dbo.lku_market.MajMkt_Nm_Commercial else lku_market.MajMkt_Nm_Medicare end as MH, 
 
		lku_market.MajMkt_Nm_Medicare as MH_ME,lku_market.reg_Medicare as reg_ME,
		dbo.lku_market.MajMkt_Nm_Commercial as MH_CP,dbo.lku_market.reg_Commercial as reg_CP,
		t.market,
								 t.lob, t.segment, t.product, t.yrmo, t.med_mems, 
								 t.rx_mems, t.plan_mkt_cd, lku_months.mo_seq, lku_market.State, 
								 CASE WHEN [segment] = 'Hix' THEN 'hx' WHEN [segment] = 'CB' THEN 'CB' WHEN [lob] = 'cp' THEN 'cp' ELSE 'me' END AS Level1, 
								 CASE WHEN [segment] = 'Hix' THEN 'hx_hix' WHEN [segment] = 'CB' THEN 'cb_cb' WHEN [lob] = 'cp' THEN CONCAT('cp_', [product]) 
								 ELSE CONCAT('me_', [segment]) END AS Level2,

						 			case when [segment]='Hix' then 'hx' when [lob]='cp' then 'cp' else 'me' end AS Level1a,
			case when [segment]='Hix' then 'hx_hix' when [lob]='cp' then 'cp_' + [product] else 'me_' + [segment] end AS Level2a
			,lku_months.yr
		FROM            dbo.n_membership t inner JOIN
								 dbo.lku_market ON t.plan_mkt_cd = lku_market.plan_mkt_cd LEFT OUTER JOIN
								 dbo.lku_months ON t.yrmo = lku_months.yrmo
   ) tt









GO
/****** Object:  View [dbo].[zzq_adm_015]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO






CREATE VIEW [dbo].[zzq_adm_015]
AS

SELECT *
FROM (SELECT * FROM q_adm_015_lob
UNION 
SELECT * FROM q_adm_015_lobseg
)  AS [%$##@_Alias];



GO
/****** Object:  View [dbo].[zzq_adm_015_lob]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO






CREATE VIEW [dbo].[zzq_adm_015_lob]
AS

SELECT q_adm_015_lob_manual_crosstab.Company, q_adm_015_lob_manual_crosstab.sai_id, q_adm_015_lob_manual_crosstab.period, q_adm_015_lob_manual_crosstab.lob, q_adm_015_lob_manual_crosstab.LobSeg, q_adm_015_lob_manual_crosstab.Fund, q_adm_015_lob_manual_crosstab.SAI_Name_and_No, q_adm_015_lob_manual_crosstab.QB_SAI_ID, q_adm_015_lob_manual_crosstab.bus_unit, q_adm_015_lob_manual_crosstab.Status, q_adm_015_lob_manual_crosstab.savings_start, Sum(q_adm_015_lob_manual_crosstab.[_con]) AS _con, Sum(q_adm_015_lob_manual_crosstab.ce) AS ce, Sum(q_adm_015_lob_manual_crosstab.ce__EMO_IA_SD_SIL_mh) AS ce__EMO_IA_SD_SIL_mh, Sum(q_adm_015_lob_manual_crosstab.ce_Iowa) AS ce_Iowa, Sum(q_adm_015_lob_manual_crosstab.ce_SouthDakota) AS ce_SouthDakota, Sum(q_adm_015_lob_manual_crosstab.ce_StLouis) AS ce_StLouis, Sum(q_adm_015_lob_manual_crosstab.ce__KS_ND_NE_WMO_mh) AS ce__KS_ND_NE_WMO_mh, Sum(q_adm_015_lob_manual_crosstab.ce_KansasCity) AS ce_KansasCity, Sum(q_adm_015_lob_manual_crosstab.ce_Nebraska) AS ce_Nebraska, Sum(q_adm_015_lob_manual_crosstab.ce_NorthDakota) AS ce_NorthDakota, Sum(q_adm_015_lob_manual_crosstab.ce__OK_TX_mh) AS ce__OK_TX_mh, Sum(q_adm_015_lob_manual_crosstab.ce_Austin) AS ce_Austin, Sum(q_adm_015_lob_manual_crosstab.ce_CorpusChristi) AS ce_CorpusChristi, Sum(q_adm_015_lob_manual_crosstab.ce_Dallas) AS ce_Dallas, Sum(q_adm_015_lob_manual_crosstab.ce_ElPaso) AS ce_ElPaso, Sum(q_adm_015_lob_manual_crosstab.ce_Houston) AS ce_Houston, Sum(q_adm_015_lob_manual_crosstab.ce_Oklahoma) AS ce_Oklahoma, Sum(q_adm_015_lob_manual_crosstab.ce_SanAntonio) AS ce_SanAntonio, Sum(q_adm_015_lob_manual_crosstab.ma) AS ma, Sum(q_adm_015_lob_manual_crosstab.ma__DC_MD_VA_mh) AS ma__DC_MD_VA_mh, Sum(q_adm_015_lob_manual_crosstab.ma_DC) AS ma_DC, Sum(q_adm_015_lob_manual_crosstab.ma_Maryland) AS ma_Maryland, Sum(q_adm_015_lob_manual_crosstab.ma_Virginia) AS ma_Virginia, Sum(q_adm_015_lob_manual_crosstab.ma__DE_PA_WV_mh) AS ma__DE_PA_WV_mh, Sum(q_adm_015_lob_manual_crosstab.ma_Delaware) AS ma_Delaware, Sum(q_adm_015_lob_manual_crosstab.ma_Harrisburg) AS ma_Harrisburg, Sum(q_adm_015_lob_manual_crosstab.ma_Philadelphia) AS ma_Philadelphia, Sum(q_adm_015_lob_manual_crosstab.ma_Pittsburgh) AS ma_Pittsburgh, Sum(q_adm_015_lob_manual_crosstab.ma_WestVirginia) AS ma_WestVirginia, Sum(q_adm_015_lob_manual_crosstab.ma__KY_OH_mh) AS ma__KY_OH_mh, Sum(q_adm_015_lob_manual_crosstab.ma_Cincinnati) AS ma_Cincinnati, Sum(q_adm_015_lob_manual_crosstab.ma_Cleveland) AS ma_Cleveland, Sum(q_adm_015_lob_manual_crosstab.ma_Columbus) AS ma_Columbus, Sum(q_adm_015_lob_manual_crosstab.ma_Louisville) AS ma_Louisville, Sum(q_adm_015_lob_manual_crosstab.ne) AS ne, Sum(q_adm_015_lob_manual_crosstab.ne__CT_MA_ME_NH_RI_VT_mh) AS ne__CT_MA_ME_NH_RI_VT_mh, Sum(q_adm_015_lob_manual_crosstab.ne_Connecticut) AS ne_Connecticut, Sum(q_adm_015_lob_manual_crosstab.ne_Maine) AS ne_Maine, Sum(q_adm_015_lob_manual_crosstab.ne_Massachusetts) AS ne_Massachusetts, Sum(q_adm_015_lob_manual_crosstab.ne_NewHampshire) AS ne_NewHampshire, Sum(q_adm_015_lob_manual_crosstab.ne_RhodeIsland) AS ne_RhodeIsland, Sum(q_adm_015_lob_manual_crosstab.ne_Vermont) AS ne_Vermont, Sum(q_adm_015_lob_manual_crosstab.ne__IN_MI_MN_NIL_WI_mh) AS ne__IN_MI_MN_NIL_WI_mh, Sum(q_adm_015_lob_manual_crosstab.ne_Illinois) AS ne_Illinois, Sum(q_adm_015_lob_manual_crosstab.ne_Indianapolis) AS ne_Indianapolis, Sum(q_adm_015_lob_manual_crosstab.ne_Michigan) AS ne_Michigan, Sum(q_adm_015_lob_manual_crosstab.ne_Minnesota) AS ne_Minnesota, Sum(q_adm_015_lob_manual_crosstab.ne_Wisconsin) AS ne_Wisconsin, Sum(q_adm_015_lob_manual_crosstab.ne__NY_NJ_mh) AS ne__NY_NJ_mh, Sum(q_adm_015_lob_manual_crosstab.ne_NewYork) AS ne_NewYork, Sum(q_adm_015_lob_manual_crosstab.ne_NorthernNewJersey) AS ne_NorthernNewJersey, Sum(q_adm_015_lob_manual_crosstab.ne_SouthernNewJersey) AS ne_SouthernNewJersey, Sum(q_adm_015_lob_manual_crosstab.ne_UpstateNY) AS ne_UpstateNY, Sum(q_adm_015_lob_manual_crosstab.se) AS se, Sum(q_adm_015_lob_manual_crosstab.se__AL_GA_LA_MS_mh) AS se__AL_GA_LA_MS_mh, Sum(q_adm_015_lob_manual_crosstab.se_Alabama) AS se_Alabama, Sum(q_adm_015_lob_manual_crosstab.se_Atlanta) AS se_Atlanta, Sum(q_adm_015_lob_manual_crosstab.se_Augusta) AS se_Augusta, Sum(q_adm_015_lob_manual_crosstab.se_Louisiana) AS se_Louisiana, Sum(q_adm_015_lob_manual_crosstab.se_Mississippi) AS se_Mississippi, Sum(q_adm_015_lob_manual_crosstab.se__AR_NC_SC_TN_mh) AS se__AR_NC_SC_TN_mh, Sum(q_adm_015_lob_manual_crosstab.se_LittleRock) AS se_LittleRock, Sum(q_adm_015_lob_manual_crosstab.se_Memphis) AS se_Memphis, Sum(q_adm_015_lob_manual_crosstab.se_NCarolina) AS se_NCarolina, Sum(q_adm_015_lob_manual_crosstab.se_Nashville) AS se_Nashville, Sum(q_adm_015_lob_manual_crosstab.se_SCarolina) AS se_SCarolina, Sum(q_adm_015_lob_manual_crosstab.se__FL_mh) AS se__FL_mh, Sum(q_adm_015_lob_manual_crosstab.se_Jacksonville) AS se_Jacksonville, Sum(q_adm_015_lob_manual_crosstab.se_Orlando) AS se_Orlando, Sum(q_adm_015_lob_manual_crosstab.se_SouthFlorida) AS se_SouthFlorida, Sum(q_adm_015_lob_manual_crosstab.se_Tampa) AS se_Tampa, Sum(q_adm_015_lob_manual_crosstab.we) AS we, Sum(q_adm_015_lob_manual_crosstab.we__AK_ID_OR_WA_mh) AS we__AK_ID_OR_WA_mh, Sum(q_adm_015_lob_manual_crosstab.we_Alaska) AS we_Alaska, Sum(q_adm_015_lob_manual_crosstab.we_Idaho) AS we_Idaho, Sum(q_adm_015_lob_manual_crosstab.we_Oregon) AS we_Oregon, Sum(q_adm_015_lob_manual_crosstab.we_Washington) AS we_Washington, Sum(q_adm_015_lob_manual_crosstab.we__AZ_NM_mh) AS we__AZ_NM_mh, Sum(q_adm_015_lob_manual_crosstab.we_Arizona) AS we_Arizona, Sum(q_adm_015_lob_manual_crosstab.we_NewMexico) AS we_NewMexico, Sum(q_adm_015_lob_manual_crosstab.we__CO_MT_NV_UT_WY_mh) AS we__CO_MT_NV_UT_WY_mh, Sum(q_adm_015_lob_manual_crosstab.we_Colorado) AS we_Colorado, Sum(q_adm_015_lob_manual_crosstab.we_Montana) AS we_Montana, Sum(q_adm_015_lob_manual_crosstab.we_Nevada) AS we_Nevada, Sum(q_adm_015_lob_manual_crosstab.we_Utah) AS we_Utah, Sum(q_adm_015_lob_manual_crosstab.we_Wyoming) AS we_Wyoming, Sum(q_adm_015_lob_manual_crosstab.we__NCA_mh) AS we__NCA_mh, Sum(q_adm_015_lob_manual_crosstab.we_CentralValley) AS we_CentralValley, Sum(q_adm_015_lob_manual_crosstab.we_Hawaii) AS we_Hawaii, Sum(q_adm_015_lob_manual_crosstab.we_NorthernCalifornia) AS we_NorthernCalifornia, Sum(q_adm_015_lob_manual_crosstab.we__SCA_mh) AS we__SCA_mh, Sum(q_adm_015_lob_manual_crosstab.we_LosAngeles) AS we_LosAngeles, Sum(q_adm_015_lob_manual_crosstab.we_SanDiego) AS we_SanDiego
FROM q_adm_015_lob_manual_crosstab
GROUP BY q_adm_015_lob_manual_crosstab.Company, q_adm_015_lob_manual_crosstab.sai_id, q_adm_015_lob_manual_crosstab.period, q_adm_015_lob_manual_crosstab.lob, q_adm_015_lob_manual_crosstab.LobSeg, q_adm_015_lob_manual_crosstab.Fund, q_adm_015_lob_manual_crosstab.SAI_Name_and_No, q_adm_015_lob_manual_crosstab.QB_SAI_ID, q_adm_015_lob_manual_crosstab.bus_unit, q_adm_015_lob_manual_crosstab.Status, q_adm_015_lob_manual_crosstab.savings_start;



GO
/****** Object:  View [dbo].[zzq_adm_015_lobseg]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO






CREATE VIEW [dbo].[zzq_adm_015_lobseg]
AS

SELECT q_adm_015_lobseg_manual_crosstab.Company, q_adm_015_lobseg_manual_crosstab.sai_id, q_adm_015_lobseg_manual_crosstab.period, q_adm_015_lobseg_manual_crosstab.lob, q_adm_015_lobseg_manual_crosstab.LobSeg, q_adm_015_lobseg_manual_crosstab.Fund, q_adm_015_lobseg_manual_crosstab.SAI_Name_and_No, q_adm_015_lobseg_manual_crosstab.QB_SAI_ID, q_adm_015_lobseg_manual_crosstab.bus_unit, q_adm_015_lobseg_manual_crosstab.Status, q_adm_015_lobseg_manual_crosstab.savings_start, Sum(q_adm_015_lobseg_manual_crosstab.[_con]) AS _con, Sum(q_adm_015_lobseg_manual_crosstab.ce) AS ce, Sum(q_adm_015_lobseg_manual_crosstab.ce__EMO_IA_SD_SIL_mh) AS ce__EMO_IA_SD_SIL_mh, Sum(q_adm_015_lobseg_manual_crosstab.ce_Iowa) AS ce_Iowa, Sum(q_adm_015_lobseg_manual_crosstab.ce_SouthDakota) AS ce_SouthDakota, Sum(q_adm_015_lobseg_manual_crosstab.ce_StLouis) AS ce_StLouis, Sum(q_adm_015_lobseg_manual_crosstab.ce__KS_ND_NE_WMO_mh) AS ce__KS_ND_NE_WMO_mh, Sum(q_adm_015_lobseg_manual_crosstab.ce_KansasCity) AS ce_KansasCity, Sum(q_adm_015_lobseg_manual_crosstab.ce_Nebraska) AS ce_Nebraska, Sum(q_adm_015_lobseg_manual_crosstab.ce_NorthDakota) AS ce_NorthDakota, Sum(q_adm_015_lobseg_manual_crosstab.ce__OK_TX_mh) AS ce__OK_TX_mh, Sum(q_adm_015_lobseg_manual_crosstab.ce_Austin) AS ce_Austin, Sum(q_adm_015_lobseg_manual_crosstab.ce_CorpusChristi) AS ce_CorpusChristi, Sum(q_adm_015_lobseg_manual_crosstab.ce_Dallas) AS ce_Dallas, Sum(q_adm_015_lobseg_manual_crosstab.ce_ElPaso) AS ce_ElPaso, Sum(q_adm_015_lobseg_manual_crosstab.ce_Houston) AS ce_Houston, Sum(q_adm_015_lobseg_manual_crosstab.ce_Oklahoma) AS ce_Oklahoma, Sum(q_adm_015_lobseg_manual_crosstab.ce_SanAntonio) AS ce_SanAntonio, Sum(q_adm_015_lobseg_manual_crosstab.ma) AS ma, Sum(q_adm_015_lobseg_manual_crosstab.ma__DC_MD_VA_mh) AS ma__DC_MD_VA_mh, Sum(q_adm_015_lobseg_manual_crosstab.ma_DC) AS ma_DC, Sum(q_adm_015_lobseg_manual_crosstab.ma_Maryland) AS ma_Maryland, Sum(q_adm_015_lobseg_manual_crosstab.ma_Virginia) AS ma_Virginia, Sum(q_adm_015_lobseg_manual_crosstab.ma__DE_PA_WV_mh) AS ma__DE_PA_WV_mh, Sum(q_adm_015_lobseg_manual_crosstab.ma_Delaware) AS ma_Delaware, Sum(q_adm_015_lobseg_manual_crosstab.ma_Harrisburg) AS ma_Harrisburg, Sum(q_adm_015_lobseg_manual_crosstab.ma_Philadelphia) AS ma_Philadelphia, Sum(q_adm_015_lobseg_manual_crosstab.ma_Pittsburgh) AS ma_Pittsburgh, Sum(q_adm_015_lobseg_manual_crosstab.ma_WestVirginia) AS ma_WestVirginia, Sum(q_adm_015_lobseg_manual_crosstab.ma__KY_OH_mh) AS ma__KY_OH_mh, Sum(q_adm_015_lobseg_manual_crosstab.ma_Cincinnati) AS ma_Cincinnati, Sum(q_adm_015_lobseg_manual_crosstab.ma_Cleveland) AS ma_Cleveland, Sum(q_adm_015_lobseg_manual_crosstab.ma_Columbus) AS ma_Columbus, Sum(q_adm_015_lobseg_manual_crosstab.ma_Louisville) AS ma_Louisville, Sum(q_adm_015_lobseg_manual_crosstab.ne) AS ne, Sum(q_adm_015_lobseg_manual_crosstab.ne__CT_MA_ME_NH_RI_VT_mh) AS ne__CT_MA_ME_NH_RI_VT_mh, Sum(q_adm_015_lobseg_manual_crosstab.ne_Connecticut) AS ne_Connecticut, Sum(q_adm_015_lobseg_manual_crosstab.ne_Maine) AS ne_Maine, Sum(q_adm_015_lobseg_manual_crosstab.ne_Massachusetts) AS ne_Massachusetts, Sum(q_adm_015_lobseg_manual_crosstab.ne_NewHampshire) AS ne_NewHampshire, Sum(q_adm_015_lobseg_manual_crosstab.ne_RhodeIsland) AS ne_RhodeIsland, Sum(q_adm_015_lobseg_manual_crosstab.ne_Vermont) AS ne_Vermont, Sum(q_adm_015_lobseg_manual_crosstab.ne__IN_MI_MN_NIL_WI_mh) AS ne__IN_MI_MN_NIL_WI_mh, Sum(q_adm_015_lobseg_manual_crosstab.ne_Illinois) AS ne_Illinois, Sum(q_adm_015_lobseg_manual_crosstab.ne_Indianapolis) AS ne_Indianapolis, Sum(q_adm_015_lobseg_manual_crosstab.ne_Michigan) AS ne_Michigan, Sum(q_adm_015_lobseg_manual_crosstab.ne_Minnesota) AS ne_Minnesota, Sum(q_adm_015_lobseg_manual_crosstab.ne_Wisconsin) AS ne_Wisconsin, Sum(q_adm_015_lobseg_manual_crosstab.ne__NY_NJ_mh) AS ne__NY_NJ_mh, Sum(q_adm_015_lobseg_manual_crosstab.ne_NewYork) AS ne_NewYork, Sum(q_adm_015_lobseg_manual_crosstab.ne_NorthernNewJersey) AS ne_NorthernNewJersey, Sum(q_adm_015_lobseg_manual_crosstab.ne_SouthernNewJersey) AS ne_SouthernNewJersey, Sum(q_adm_015_lobseg_manual_crosstab.ne_UpstateNY) AS ne_UpstateNY, Sum(q_adm_015_lobseg_manual_crosstab.se) AS se, Sum(q_adm_015_lobseg_manual_crosstab.se__AL_GA_LA_MS_mh) AS se__AL_GA_LA_MS_mh, Sum(q_adm_015_lobseg_manual_crosstab.se_Alabama) AS se_Alabama, Sum(q_adm_015_lobseg_manual_crosstab.se_Atlanta) AS se_Atlanta, Sum(q_adm_015_lobseg_manual_crosstab.se_Augusta) AS se_Augusta, Sum(q_adm_015_lobseg_manual_crosstab.se_Louisiana) AS se_Louisiana, Sum(q_adm_015_lobseg_manual_crosstab.se_Mississippi) AS se_Mississippi, Sum(q_adm_015_lobseg_manual_crosstab.se__AR_NC_SC_TN_mh) AS se__AR_NC_SC_TN_mh, Sum(q_adm_015_lobseg_manual_crosstab.se_LittleRock) AS se_LittleRock, Sum(q_adm_015_lobseg_manual_crosstab.se_Memphis) AS se_Memphis, Sum(q_adm_015_lobseg_manual_crosstab.se_NCarolina) AS se_NCarolina, Sum(q_adm_015_lobseg_manual_crosstab.se_Nashville) AS se_Nashville, Sum(q_adm_015_lobseg_manual_crosstab.se_SCarolina) AS se_SCarolina, Sum(q_adm_015_lobseg_manual_crosstab.se__FL_mh) AS se__FL_mh, Sum(q_adm_015_lobseg_manual_crosstab.se_Jacksonville) AS se_Jacksonville, Sum(q_adm_015_lobseg_manual_crosstab.se_Orlando) AS se_Orlando, Sum(q_adm_015_lobseg_manual_crosstab.se_SouthFlorida) AS se_SouthFlorida, Sum(q_adm_015_lobseg_manual_crosstab.se_Tampa) AS se_Tampa, Sum(q_adm_015_lobseg_manual_crosstab.we) AS we, Sum(q_adm_015_lobseg_manual_crosstab.we__AK_ID_OR_WA_mh) AS we__AK_ID_OR_WA_mh, Sum(q_adm_015_lobseg_manual_crosstab.we_Alaska) AS we_Alaska, Sum(q_adm_015_lobseg_manual_crosstab.we_Idaho) AS we_Idaho, Sum(q_adm_015_lobseg_manual_crosstab.we_Oregon) AS we_Oregon, Sum(q_adm_015_lobseg_manual_crosstab.we_Washington) AS we_Washington, Sum(q_adm_015_lobseg_manual_crosstab.we__AZ_NM_mh) AS we__AZ_NM_mh, Sum(q_adm_015_lobseg_manual_crosstab.we_Arizona) AS we_Arizona, Sum(q_adm_015_lobseg_manual_crosstab.we_NewMexico) AS we_NewMexico, Sum(q_adm_015_lobseg_manual_crosstab.we__CO_MT_NV_UT_WY_mh) AS we__CO_MT_NV_UT_WY_mh, Sum(q_adm_015_lobseg_manual_crosstab.we_Colorado) AS we_Colorado, Sum(q_adm_015_lobseg_manual_crosstab.we_Montana) AS we_Montana, Sum(q_adm_015_lobseg_manual_crosstab.we_Nevada) AS we_Nevada, Sum(q_adm_015_lobseg_manual_crosstab.we_Utah) AS we_Utah, Sum(q_adm_015_lobseg_manual_crosstab.we_Wyoming) AS we_Wyoming, Sum(q_adm_015_lobseg_manual_crosstab.we__NCA_mh) AS we__NCA_mh, Sum(q_adm_015_lobseg_manual_crosstab.we_CentralValley) AS we_CentralValley, Sum(q_adm_015_lobseg_manual_crosstab.we_Hawaii) AS we_Hawaii, Sum(q_adm_015_lobseg_manual_crosstab.we_NorthernCalifornia) AS we_NorthernCalifornia, Sum(q_adm_015_lobseg_manual_crosstab.we__SCA_mh) AS we__SCA_mh, Sum(q_adm_015_lobseg_manual_crosstab.we_LosAngeles) AS we_LosAngeles, Sum(q_adm_015_lobseg_manual_crosstab.we_SanDiego) AS we_SanDiego
FROM q_adm_015_lobseg_manual_crosstab
GROUP BY q_adm_015_lobseg_manual_crosstab.Company, q_adm_015_lobseg_manual_crosstab.sai_id, q_adm_015_lobseg_manual_crosstab.period, q_adm_015_lobseg_manual_crosstab.lob, q_adm_015_lobseg_manual_crosstab.LobSeg, q_adm_015_lobseg_manual_crosstab.Fund, q_adm_015_lobseg_manual_crosstab.SAI_Name_and_No, q_adm_015_lobseg_manual_crosstab.QB_SAI_ID, q_adm_015_lobseg_manual_crosstab.bus_unit, q_adm_015_lobseg_manual_crosstab.Status, q_adm_015_lobseg_manual_crosstab.savings_start;


GO
/****** Object:  View [dbo].[zzq_membership_all_months]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[zzq_membership_all_months]
	AS SELECT t_membership.*, cast(substring([yrmo],1,4) as smallint) AS yr, 
	LOWER(case when [segment]='Hix' then 'hx' when [lob]='cp' then 'cp' else 'me' end) AS Level1,
    LOWER(case when [segment]='Hix' then 'hx_hix' when [lob]='cp' then 'cp_' + [product] else 'me_' + [segment] end) AS Level2
FROM t_membership;
GO
/****** Object:  View [dbo].[zzq_Reporting]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[zzq_Reporting]
AS
SELECT        q_reporting_sub.company, q_reporting_sub.fund, q_reporting_sub.reg, q_reporting_sub.state, q_reporting_sub.mh, q_reporting_sub.market, q_reporting_sub.lob, 
                         q_reporting_sub.segment, q_reporting_sub.product, q_reporting_sub.yrmo, q_reporting_sub.yr, q_reporting_sub.sai_id, q_reporting_sub.SAI_Name_and_No, 
                         q_reporting_sub.QB_SAI_ID, q_reporting_sub.doll, q_reporting_sub.med_doll, q_reporting_sub.rx_doll, q_reporting_sub.mems, q_reporting_sub.med_mems, 
                         q_reporting_sub.rx_mems, q_reporting_sub.plan_mkt_cd, q_reporting_sub.Status, q_reporting_sub.work_grp, q_reporting_sub.bus_unit, 
                         q_reporting_sub.bus_unit_lead, q_reporting_sub.sai_mos, q_reporting_sub.carryover_ind, q_reporting_sub.savings_start_year, q_reporting_sub.Active_or_Idea, 
                         q_reporting_sub.Active, q_reporting_sub.Pipeline, q_reporting_sub.ActiveYN, q_reporting_sub.pipelineYN, q_reporting_sub.Active_or_IdeaYN, 
                         q_reporting_sub.Implementation_Date_Target, q_reporting_sub.Savings_Realization_Start_Date, q_reporting_sub.Confidence_Level, 
                         q_reporting_sub.SR_IT_Required, q_reporting_sub.SGA_Funding_Required, q_reporting_sub.Affects_Gross_Trend, q_reporting_sub.sai_description, 
                         q_reporting_sub.sai_owner, q_reporting_sub.sai_owner_name, q_reporting_sub.Projected_FI_ACAS_PMPM, q_reporting_sub.Projected_FI_HMO_PMPM, 
                         q_reporting_sub.Projected_SI_ACAS_PMPM, q_reporting_sub.Projected_SI_HMO_PMPM, q_reporting_sub.Projected_Medicare_Group_PMPM, 
                         q_reporting_sub.Projected_Medicare_Retiree_PMPM, q_reporting_sub.synergy, q_reporting_sub.Medical_Cost_Category, q_reporting_sub.Unit_Cost_or_Utilization, 
                         q_reporting_sub.Last_Updated_dt, q_reporting_sub.last_updated_by, q_reporting_sub.le_last_updated_dt, q_reporting_sub.le_last_updated_by, q_reporting_sub.fi, 
                         q_reporting_sub.si, q_reporting_sub.medicare_ind, q_reporting_sub.Level1, q_reporting_sub.Level2, q_reporting_sub.Business_Unit_Alt_Name, 
                         q_reporting_sub.bus_unit_display_name, lku_System.Start_YYYYMM_Report AS rpt_start, lku_System.Stop_YYYYMM_Report AS rpt_stop
FROM            q_reporting_sub CROSS JOIN
                         lku_System
WHERE        (q_reporting_sub.yrmo BETWEEN lku_System.Start_YYYYMM_Report AND lku_System.Stop_YYYYMM_Report)

GO
/****** Object:  View [dbo].[zzq_Reporting_all_months]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[zzq_Reporting_all_months]
AS
SELECT        company, fund, reg, state, mh, market, lob, segment, product, yrmo, yr, sai_id, SAI_Name_and_No, QB_SAI_ID, doll, med_doll, rx_doll, mems, med_mems, 
                         rx_mems, plan_mkt_cd, Status, work_grp, bus_unit, bus_unit_lead, sai_mos, carryover_ind, savings_start_year, Active_or_Idea, Active, Pipeline, ActiveYN, 
                         pipelineYN, Active_or_IdeaYN, Implementation_Date_Target, Savings_Realization_Start_Date, Confidence_Level, SR_IT_Required, SGA_Funding_Required, 
                         Affects_Gross_Trend, sai_description, sai_owner, sai_owner_name, Projected_FI_ACAS_PMPM, Projected_FI_HMO_PMPM, Projected_SI_ACAS_PMPM, 
                         Projected_SI_HMO_PMPM, Projected_Medicare_Group_PMPM, Projected_Medicare_Retiree_PMPM, synergy, Medical_Cost_Category, Unit_Cost_or_Utilization, 
                         Last_Updated_dt, last_updated_by, le_last_updated_dt, le_last_updated_by, fi, si, medicare_ind, Level1, Level2, Business_Unit_Alt_Name, 
                         bus_unit_display_name
FROM            dbo.q_Reporting_sub

GO
/****** Object:  View [dbo].[zzq_Rptg_Doll_w_SAI]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO












create VIEW [dbo].[zzq_Rptg_Doll_w_SAI]
AS
SELECT					 le.sai_id, le.work_grp,Savings_Realization_Start_Date,
						mm.company, mm.fund, mm.market, mm.lob, mm.segment, mm.product, mon_w_dosyr.yr as dosyr, mm.plan_mkt_cd,
						max(case when mon_w_dosyr.yr > mon.yr then 'Y' else 'N' end) AS carryover_ind, 
                         min(mon.yr) as sai_start_yr, count(mon.yrmo) as sai_mos,
						 sum(mm.med_mems) as med_memmo, sum(mm.rx_mems) rx_memmo, max(le.med_pmpm) med_pmpm, max(le.rx_pmpm) rx_pmpm,
						 sum(case when le.work_grp='Pharmacy' then le.rx_pmpm*mm.rx_mems else le.med_pmpm*mm.med_mems end) as doll
FROM                    (
							select t_LE.sai_id,t_LE.fund,t_LE.market,t_LE.lob,t_LE.segment,t_LE.product,
									t_LE.med_pmpm, t_LE.rx_pmpm,t_LE.Last_Updated_dt, t_LE.last_updated_by, 
									t_SAI.Savings_Realization_Start_Date,
									t_SAI.company, t_SAI.work_grp
							FROM dbo.t_LE t_LE inner join dbo.t_SAI t_SAI on t_LE.sai_id = t_SAI.sai_id
							---WHERE t_SAI.Savings_Realization_Start_Date >= '201602' 
						) le 
						
	
						INNER JOIN dbo.lku_months AS mon ON mon.yrmo = le.Savings_Realization_Start_Date 	
						INNER JOIN dbo.lku_months AS mon_w_dosyr ON mon_w_dosyr.yrmo between mon.yrmo and mon.stop_mo
						INNER JOIN dbo.n_membership mm 
						ON mm.Company = le.Company AND mm.fund = le.Fund AND mm.market = le.market AND mm.lob = le.LOB AND 
                        mm.segment = le.Segment AND mm.product = le.Product and mm.yrmo = mon_w_dosyr.yrmo
						and mm.med_mems + mm.rx_mems > 0 
						---where le.sai_id<3977 and le.market='Houston' and le.product='HMO'
GROUP BY			 le.sai_id, le.work_grp,Savings_Realization_Start_Date,
						mm.company, mm.fund, mm.market, mm.lob, mm.segment, mm.product, mon_w_dosyr.yr, mm.plan_mkt_cd			










GO
/****** Object:  View [dbo].[zzq_sai_sub]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[zzq_sai_sub]
AS
SELECT        dbo.t_SAI.sai_id, dbo.t_SAI.Company, dbo.t_SAI.QB_SAI_ID, dbo.t_SAI.sai_name, RTRIM(LTRIM(REPLACE(REPLACE(t_sai.sai_description, 10, '""'), 13, '""'))) 
                         AS sai_description, dbo.t_SAI.Implementation_Date_Target, YEAR(dbo.t_SAI.Implementation_Date_Target) AS implement_year, 
                         dbo.t_SAI.Savings_Realization_Start_Date, LEFT(dbo.t_SAI.Savings_Realization_Start_Date, 4) AS savings_start_year, dbo.t_SAI.work_grp, dbo.t_SAI.Status, 
                         dbo.t_SAI.sai_owner, dbo.t_SAI.Confidence_Level, dbo.t_SAI.SGA_Funding_Required, dbo.t_SAI.SR_IT_Required, dbo.t_SAI.Affects_Gross_Trend, dbo.t_SAI.Synergy, 
                         dbo.t_SAI.fi, dbo.t_SAI.si, dbo.t_SAI.medicare_ind, dbo.t_SAI.Projected_FI_ACAS_PMPM, dbo.t_SAI.Projected_FI_HMO_PMPM, dbo.t_SAI.Projected_SI_ACAS_PMPM, 
                         dbo.t_SAI.Projected_SI_HMO_PMPM, dbo.t_SAI.Projected_Medicare_Group_PMPM, dbo.t_SAI.Projected_Medicare_Retiree_PMPM, 
                         dbo.t_SAI.SAI_Sizing_Supplement_Document, dbo.t_SAI.original_create_dt, dbo.t_SAI.Last_Updated_dt, dbo.t_SAI.last_updated_by, dbo.t_SAI.Comments, 
                         substring([bus_unit] + '-' +  cast (sai_id as varchar(8)) + '-' + [sai_name], 1,253) AS SAI_Name_and_No, dbo.lku_work_grp.bus_unit, dbo.lku_work_grp.bus_unit_lead, 
                         dbo.t_SAI.Medical_Cost_Category, dbo.t_SAI.Unit_Cost_or_Utilization, IIF(Status = 'Active' OR
                         Status = 'Implemented', 1, 0) AS Active, IIF(Status = 'Ideation', 1, 0) AS Pipeline, IIF(Status = 'Ideation' OR Status = 'Active' OR Status = 'Implemented', 1, 0) AS Active_or_Idea,
                         IIF(Status = 'Active' OR Status = 'Implemented', 'Y', 'N') AS ActiveYN, IIF(Status = 'Ideation', 'Y', 'N') AS PipelineYN, IIF(Status = 'Ideation' OR Status = 'Active' OR Status = 'Implemented', 'Y', 'N') AS Active_or_IdeaYN
FROM            dbo.t_SAI INNER JOIN
                         dbo.lku_work_grp ON dbo.t_SAI.work_grp = dbo.lku_work_grp.work_grp


GO
/****** Object:  View [dbo].[zzzadm_bus_unit_aliases]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO







CREATE VIEW [dbo].[zzzadm_bus_unit_aliases]
AS

SELECT lku_work_grp.bus_unit, lku_work_grp.Business_Unit_Description, lku_work_grp.Business_Unit_Alt_Name, lku_work_grp.bus_unit_display_name
FROM lku_work_grp
GROUP BY lku_work_grp.bus_unit, lku_work_grp.Business_Unit_Description, lku_work_grp.Business_Unit_Alt_Name, lku_work_grp.bus_unit_display_name



GO
/****** Object:  View [dbo].[zzzappend_Dollars_data_for_Tableau]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[zzzappend_Dollars_data_for_Tableau]
AS
SELECT        TOP (100) PERCENT qry_lookup_geo_for_Tableau.ZIP_CD, t.plan_mkt_cd AS PLAN_MKT_CD, qry_lookup_geo_for_Tableau.Plan_Market, 
                         qry_lookup_geo_for_Tableau.Market_Head, qry_lookup_geo_for_Tableau.Market_Head_Medicare, qry_lookup_geo_for_Tableau.Territory, 
                         qry_lookup_geo_for_Tableau.Territory_Medicare, t.company, t.Medical_or_Rx, t.Business_Unit, UPPER(t.LOB_Seg_Prod) AS LOB_Seg_Prod, t.monthly_membership,
                          SUM(t.Dollars) AS Dollars, MIN(0) AS Dollars_Target, t.SAI_Name_and_No
FROM            dbo.pull_Dollars_data_for_Tableau AS t LEFT OUTER JOIN
                         dbo.qry_lookup_geo_for_Tableau ON t.plan_mkt_cd = qry_lookup_geo_for_Tableau.PLAN_MKT_CD
GROUP BY qry_lookup_geo_for_Tableau.ZIP_CD, t.plan_mkt_cd, qry_lookup_geo_for_Tableau.Plan_Market, qry_lookup_geo_for_Tableau.Market_Head, 
                         qry_lookup_geo_for_Tableau.Market_Head_Medicare, qry_lookup_geo_for_Tableau.Territory, qry_lookup_geo_for_Tableau.Territory_Medicare, t.company, 
                         t.Medical_or_Rx, t.Business_Unit, UPPER(t.LOB_Seg_Prod), t.monthly_membership, t.SAI_Name_and_No
ORDER BY t.SAI_Name_and_No

GO
/****** Object:  View [dbo].[zzzget_SAI_data_for_Tableau]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[zzzget_SAI_data_for_Tableau]
AS
SELECT        dbo.get_SAI_data_for_Tableau_sub.as_of_date, dbo.get_SAI_data_for_Tableau_sub.ZIP_CD, dbo.get_SAI_data_for_Tableau_sub.PLAN_MKT_CD, 
                         dbo.get_SAI_data_for_Tableau_sub.Plan_Market, dbo.get_SAI_data_for_Tableau_sub.Market_Head, dbo.get_SAI_data_for_Tableau_sub.Market_Head_Medicare, 
                         dbo.get_SAI_data_for_Tableau_sub.Territory, dbo.get_SAI_data_for_Tableau_sub.Territory_Medicare, dbo.get_SAI_data_for_Tableau_sub.Company, 
                         dbo.get_SAI_data_for_Tableau_sub.Medical_or_Rx, dbo.get_SAI_data_for_Tableau_sub.Business_Unit, 
                         IIf(dbo.get_SAI_data_for_Tableau_sub.LOB_Seg_Prod = '_Always Pick Me Also', '_Always Pick Me Also', [Level2_]) AS LOB_Seg_Prod, 
                         dbo.get_SAI_data_for_Tableau_sub.monthly_membership, dbo.get_SAI_data_for_Tableau_sub.Dollars, dbo.get_SAI_data_for_Tableau_sub.Dollars_Target, 
                         dbo.get_SAI_data_for_Tableau_sub.SAI_Name_and_No
FROM            dbo.get_SAI_data_for_Tableau_sub LEFT JOIN
                         dbo.qry_Tableau_lobseg_xlat ON dbo.get_SAI_data_for_Tableau_sub.LOB_Seg_Prod = dbo.qry_Tableau_lobseg_xlat.Level2

GO
/****** Object:  View [dbo].[zzzORIGINGALq_membership]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO






CREATE VIEW [dbo].[zzzORIGINGALq_membership]
AS
SELECT        dbo.t_membership.Category, dbo.t_membership.company, dbo.t_membership.fund, 

case when dbo.t_membership.Category<>'mkt' then dbo.t_membership.MH  when dbo.t_membership.lob='CP' then dbo.lku_market.reg_Commercial else dbo.lku_market.reg_Medicare end as reg, 
case when dbo.t_membership.Category<>'mkt' then dbo.t_membership.reg when dbo.t_membership.lob='CP' then dbo.lku_market.MajMkt_Nm_Commercial else lku_market.MajMkt_Nm_Medicare end as MH, 
lku_market.MajMkt_Nm_Medicare as MH_ME,lku_market.reg_Medicare as reg_ME,
dbo.lku_market.MajMkt_Nm_Commercial as MH_CP,dbo.lku_market.reg_Commercial as reg_CP,
dbo.t_membership.market, 
                         dbo.t_membership.lob, dbo.t_membership.segment, dbo.t_membership.product, dbo.t_membership.yrmo, dbo.t_membership.med_mems, 
                         dbo.t_membership.rx_mems, dbo.t_membership.plan_mkt_cd, lku_months.mo_seq, lku_market.NatDb_Nm, lku_market.State, 
                         CASE WHEN [segment] = 'Hix' THEN 'hx' WHEN [segment] = 'CB' THEN 'CB' ELSE CASE WHEN [lob] = 'cp' THEN 'cp' ELSE 'me' END END AS Level1, 
                         CASE WHEN [segment] = 'Hix' THEN 'hx_hix' WHEN [segment] = 'CB' THEN 'cb_cb' ELSE CASE WHEN [lob] = 'cp' THEN CONCAT('cp_', [product]) 
                         ELSE CONCAT('me_', [segment]) END END AS Level2,

						 	LOWER(case when [segment]='Hix' then 'hx' when [lob]='cp' then 'cp' else 'me' end) AS Level1a,
    LOWER(case when [segment]='Hix' then 'hx_hix' when [lob]='cp' then 'cp_' + [product] else 'me_' + [segment] end) AS Level2a
	,lku_months.yr
FROM            dbo.t_membership LEFT OUTER JOIN
                         dbo.lku_market ON t_membership.plan_mkt_cd = lku_market.plan_mkt_cd LEFT OUTER JOIN
                         dbo.lku_months ON t_membership.yrmo = lku_months.yrmo







GO
/****** Object:  View [dbo].[zzzq_Reporting_sub_with_Plan_Mkt_Cd_for_Tableau]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[zzzq_Reporting_sub_with_Plan_Mkt_Cd_for_Tableau]
AS
SELECT        dbo.append_t_reporting.Company, dbo.append_t_reporting.Fund, dbo.append_t_reporting.market, dbo.append_t_reporting.yrmo, 
                         dbo.append_t_reporting.med_doll + dbo.append_t_reporting.rx_doll AS doll, dbo.append_t_reporting.med_doll, dbo.append_t_reporting.rx_doll, 
                         dbo.append_t_reporting.plan_mkt_cd, lku_work_grp.bus_unit, CASE (dbo.t_sai.Status) 
                         WHEN 'Ideation' THEN 'True' WHEN 'Active' THEN 'True' WHEN 'Implemented' THEN 'True' ELSE 'False' END AS Active_or_Idea, dbo.append_t_reporting.Level2, 
                         LEFT({ fn CONCAT(dbo.lku_work_grp.Business_Unit_Alt_Name, { fn CONCAT('-', { fn CONCAT(CAST(t_SAI.sai_id AS VARCHAR), { fn CONCAT(' - ', dbo.t_SAI.sai_name) }) 
                         }) }) }, 253) AS SAI_Name_and_No
FROM            dbo.append_t_reporting INNER JOIN
                         dbo.t_SAI ON dbo.append_t_reporting.sai_id = t_SAI.sai_id INNER JOIN
                         dbo.lku_work_grp ON t_SAI.work_grp = lku_work_grp.work_grp

GO
/****** Object:  View [dbo].[zzzqry_lookup_geo_for_Tableau]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[zzzqry_lookup_geo_for_Tableau]
AS
SELECT        MIN(tbl_Tableau_Chunk_Geographic.ZIP_CD) AS ZIP_CD, tbl_Tableau_Chunk_Geographic.PLAN_MKT_CD, tbl_Tableau_Chunk_Geographic.Plan_Market, 
                         tbl_Tableau_Chunk_Geographic.Market_Head, tbl_Tableau_Chunk_Geographic.Market_Head_Medicare, tbl_Tableau_Chunk_Geographic.Territory, 
                         tbl_Tableau_Chunk_Geographic.Territory_Medicare
FROM            dbo.tbl_Tableau_Chunk_Geographic
GROUP BY tbl_Tableau_Chunk_Geographic.PLAN_MKT_CD, tbl_Tableau_Chunk_Geographic.Plan_Market, tbl_Tableau_Chunk_Geographic.Market_Head, 
                         tbl_Tableau_Chunk_Geographic.Market_Head_Medicare, tbl_Tableau_Chunk_Geographic.Territory, tbl_Tableau_Chunk_Geographic.Territory_Medicare

GO
/****** Object:  View [dbo].[zzzt_reporting]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[zzzt_reporting]
AS
SELECT        Company AS company, Fund AS fund, reg, State AS state, market, LOB AS lob, Segment AS segment, Product AS product, yrmo, sai_id, med_mems, rx_mems, 
                         '' AS NatDb_Nm, MH AS mh, med_doll, rx_doll, plan_mkt_cd, Level1, Level2
FROM            dbo.append_t_reporting

GO
/****** Object:  View [dbo].[zzztablo_training]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


CREATE VIEW [dbo].[zzztablo_training]
	AS SELECT Company, Fund, reg,
 market, lob, Level1, Level2, segment, product,
  yr, yrmo, max('A') as work_grp,
  Sum(ABS(CONVERT(BIGINT,CONVERT(BINARY(8), NEWID()))) % 400 *q.med_mems) AS med_doll, Sum(q.med_mems) AS med_mems,
  sum(ABS(CONVERT(BIGINT,CONVERT(BINARY(8), NEWID()))) % 50 *q.rx_mems) AS rx_doll, Sum(q.rx_mems) AS rx_mems 
FROM q_membership_all_months q
WHERE fund In ('FI') AND Category='mkt' AND yr>=2015
GROUP BY Company, Fund, reg,
 market, lob, Level1, Level2, segment, product,
  yr, yrmo
  UNION
  SELECT Company, Fund, reg,
 market, lob, Level1, Level2, segment, product,
  yr, yrmo, max('B') as work_grp,
  Sum(ABS(CONVERT(BIGINT,CONVERT(BINARY(8), NEWID()))) % 400  *q.med_mems) AS med_doll, Sum(q.med_mems) AS med_mems,
  sum(ABS(CONVERT(BIGINT,CONVERT(BINARY(8), NEWID()))) % 50  *q.rx_mems) AS rx_doll, Sum(q.rx_mems) AS rx_mems 
FROM q_membership_all_months q
WHERE fund In ('FI') AND Category='mkt' AND yr>=2015
GROUP BY Company, Fund, reg,
 market, lob, Level1, Level2, segment, product,
  yr, yrmo
  
  ;


GO
/****** Object:  View [dbo].[zzztLE_w_UpdaterName]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[zzztLE_w_UpdaterName]
AS
SELECT        dbo.t_LE.sai_id, dbo.t_SAI.Company, dbo.t_SAI.sai_name, dbo.t_LE.Fund, dbo.t_LE.market, dbo.t_LE.LOB, dbo.t_LE.Segment, dbo.t_LE.Product, dbo.t_LE.med_pmpm, dbo.t_LE.rx_pmpm, 
                         dbo.t_LE.original_create_dt, dbo.t_LE.Last_Updated_dt, dbo.t_LE.last_updated_by, dbo.lku_users.DisplayName AS LastUpdater, dbo.t_LE.Comments
FROM            dbo.t_LE inner join dbo.t_SAI on dbo.t_SAI.sai_id = dbo.t_LE.sai_id  
               left JOIN  dbo.lku_users ON dbo.t_LE.last_updated_by = dbo.lku_users.AetnaId
						 


GO
/****** Object:  View [dbo].[zzztSAI_w_UpdaterName]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[zzztSAI_w_UpdaterName]
AS
SELECT        dbo.t_SAI.sai_id, dbo.t_SAI.Company, dbo.t_SAI.sai_name, dbo.t_SAI.sai_description, dbo.t_SAI.Implementation_Date_Target, 
                         dbo.t_SAI.Savings_Realization_Start_Date, dbo.t_SAI.work_grp, dbo.t_SAI.sai_owner, dbo.t_SAI.Status, dbo.t_SAI.Confidence_Level, dbo.t_SAI.Affects_Gross_Trend, 
                         dbo.t_SAI.SR_IT_Required, dbo.t_SAI.SGA_Funding_Required, dbo.t_SAI.Synergy, dbo.t_SAI.Projected_FI_ACAS_PMPM, dbo.t_SAI.Projected_FI_HMO_PMPM, 
                         dbo.t_SAI.Projected_SI_ACAS_PMPM, dbo.t_SAI.Projected_SI_HMO_PMPM, dbo.t_SAI.Projected_Medicare_Group_PMPM, 
                         dbo.t_SAI.Projected_Medicare_Retiree_PMPM, dbo.t_SAI.Projected_HIX_HPO_PMPM, dbo.t_SAI.fi, dbo.t_SAI.si, dbo.t_SAI.medicare_ind, dbo.t_SAI.hix_ind, 
                         dbo.t_SAI.SAI_Sizing_Supplement_Document, dbo.t_SAI.original_create_dt, dbo.t_SAI.Last_Updated_dt, dbo.t_SAI.last_updated_by, 
                         dbo.lku_users.DisplayName AS last_updater
FROM            dbo.t_SAI LEFT OUTER JOIN
                         dbo.lku_users ON dbo.t_SAI.last_updated_by = dbo.lku_users.AetnaId


GO
/****** Object:  View [dbo].[zzzzget_SAI_data_for_Tableau_sub]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[zzzzget_SAI_data_for_Tableau_sub]
AS
SELECT        LEFT(CONVERT(VARCHAR, GETDATE(), 120), 10) AS as_of_date, *
FROM            dbo.tbl_Tableau_Chunk_Geographic
UNION ALL
SELECT        LEFT(CONVERT(VARCHAR, GETDATE(), 120), 10) AS as_of_date, *
FROM            dbo.tbl_Tableau_Chunk_Membership
UNION ALL
SELECT        LEFT(CONVERT(VARCHAR, GETDATE(), 120), 10) AS as_of_date, *
FROM            dbo.append_Dollars_data_for_Tableau
UNION ALL
SELECT        LEFT(CONVERT(VARCHAR, GETDATE(), 120), 10) AS as_of_date, *
FROM            dbo.tbl_Tableau_Chunk_Target_Dollars

GO
/****** Object:  View [dbo].[zzzzpull_Dollars_data_for_Tableau]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[zzzzpull_Dollars_data_for_Tableau]
AS
SELECT        MIN('') AS ZIP_CD, dbo.q_Reporting_sub_with_Plan_Mkt_Cd_for_Tableau.Company, CASE ([med_doll]) 
                         WHEN 0 THEN 'Pharmacy' ELSE 'Medical' END AS Medical_or_Rx, q_Reporting_sub_with_Plan_Mkt_Cd_for_Tableau.plan_mkt_cd, 
                         qry_lku_business_unit.Business_Unit_Description AS Business_Unit, qry_lku_business_unit.bus_unit, 
                         UPPER(dbo.q_Reporting_sub_with_Plan_Mkt_Cd_for_Tableau.Level2) AS LOB_Seg_Prod, SUM(0) AS monthly_membership, 
                         SUM(dbo.q_Reporting_sub_with_Plan_Mkt_Cd_for_Tableau.med_doll + dbo.q_Reporting_sub_with_Plan_Mkt_Cd_for_Tableau.rx_doll) AS Dollars, 
                         q_Reporting_sub_with_Plan_Mkt_Cd_for_Tableau.SAI_Name_and_No, q_Reporting_sub_with_Plan_Mkt_Cd_for_Tableau.Active_or_Idea
FROM            dbo.q_Reporting_sub_with_Plan_Mkt_Cd_for_Tableau LEFT OUTER JOIN
                         dbo.qry_lku_business_unit ON q_Reporting_sub_with_Plan_Mkt_Cd_for_Tableau.bus_unit = qry_lku_business_unit.bus_unit
WHERE        (q_Reporting_sub_with_Plan_Mkt_Cd_for_Tableau.yrmo BETWEEN '201701' AND '201712') AND (q_Reporting_sub_with_Plan_Mkt_Cd_for_Tableau.fund IN ('FI')) AND
                          (q_Reporting_sub_with_Plan_Mkt_Cd_for_Tableau.Active_or_Idea = 'True')
GROUP BY dbo.q_Reporting_sub_with_Plan_Mkt_Cd_for_Tableau.Company, CASE ([med_doll]) WHEN 0 THEN 'Pharmacy' ELSE 'Medical' END, 
                         q_Reporting_sub_with_Plan_Mkt_Cd_for_Tableau.plan_mkt_cd, qry_lku_business_unit.Business_Unit_Description, qry_lku_business_unit.bus_unit, 
                         UPPER(dbo.q_Reporting_sub_with_Plan_Mkt_Cd_for_Tableau.Level2), q_Reporting_sub_with_Plan_Mkt_Cd_for_Tableau.SAI_Name_and_No, 
                         q_Reporting_sub_with_Plan_Mkt_Cd_for_Tableau.Active_or_Idea, dbo.q_Reporting_sub_with_Plan_Mkt_Cd_for_Tableau.Company
HAVING        (NOT (SUM(dbo.q_Reporting_sub_with_Plan_Mkt_Cd_for_Tableau.med_doll + dbo.q_Reporting_sub_with_Plan_Mkt_Cd_for_Tableau.rx_doll) = 0))

GO
/****** Object:  View [dbo].[zzzzq_targets_membership_reporting]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE VIEW [dbo].[zzzzq_targets_membership_reporting]
AS
SELECT t.company, t.fund, t.market, t.lob, t.segment, t.product, t.yr, roll.Level1, roll.Level2, roll.reg, roll.MH, 
 t.med_memmos AS mktmed_memmos, t.rx_memmos AS mktrx_memmos, roll.mhmed_memmos, roll.mhrx_memmos, roll.regmed_memmos, roll.regrx_memmos, roll.conmed_memmos, roll.conrx_memmos
FROM t_targets_membership t INNER JOIN q_targets_membership_rollups roll 
ON t.company = roll.company AND t.fund = roll.fund AND t.lob = roll.lob AND t.segment = roll.segment AND t.product = roll.product AND t.yr = roll.yr



GO
/****** Object:  View [dbo].[zzzzqry_lku_business_unit]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE VIEW [dbo].[zzzzqry_lku_business_unit]
AS
SELECT      bus_unit, Business_Unit_Alt_Name, Business_Unit_Description, bus_unit_display_name
FROM            dbo.lku_work_grp
GROUP BY bus_unit, Business_Unit_Alt_Name, Business_Unit_Description, bus_unit_display_name
 


GO
SET ANSI_PADDING ON

GO
/****** Object:  Index [IX_lku_months]    Script Date: 08/08/2017 12:25:54 PM ******/
CREATE NONCLUSTERED INDEX [IX_lku_months] ON [dbo].[lku_months]
(
	[yrmo] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 80) ON [PRIMARY]
GO
SET ANSI_PADDING ON

GO
/****** Object:  Index [IX_lku_months_stop_mo]    Script Date: 08/08/2017 12:25:54 PM ******/
CREATE NONCLUSTERED INDEX [IX_lku_months_stop_mo] ON [dbo].[lku_months]
(
	[Stop_mo] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 80) ON [PRIMARY]
GO
/****** Object:  Index [IX_lku_months_yr]    Script Date: 08/08/2017 12:25:54 PM ******/
CREATE NONCLUSTERED INDEX [IX_lku_months_yr] ON [dbo].[lku_months]
(
	[yr] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 80) ON [PRIMARY]
GO
SET ANSI_PADDING ON

GO
/****** Object:  Index [IX_lku_work_grp_bus_unit]    Script Date: 08/08/2017 12:25:54 PM ******/
CREATE NONCLUSTERED INDEX [IX_lku_work_grp_bus_unit] ON [dbo].[lku_work_grp]
(
	[bus_unit] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 80) ON [PRIMARY]
GO
SET ANSI_PADDING ON

GO
/****** Object:  Index [<Name of Missing Index, sysname,>]    Script Date: 08/08/2017 12:25:54 PM ******/
CREATE NONCLUSTERED INDEX [<Name of Missing Index, sysname,>] ON [dbo].[n_membership]
(
	[plan_mkt_cd] ASC
)
INCLUDE ( 	[company],
	[fund],
	[market],
	[lob],
	[segment],
	[product],
	[yrmo],
	[med_mems],
	[rx_mems]) WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 80) ON [PRIMARY]
GO
SET ANSI_PADDING ON

GO
/****** Object:  Index [i_t_membership_plan_mkt_cd]    Script Date: 08/08/2017 12:25:54 PM ******/
CREATE NONCLUSTERED INDEX [i_t_membership_plan_mkt_cd] ON [dbo].[n_membership]
(
	[plan_mkt_cd] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 80) ON [PRIMARY]
GO
SET ANSI_PADDING ON

GO
/****** Object:  Index [i_t_membership_yrmo]    Script Date: 08/08/2017 12:25:54 PM ******/
CREATE NONCLUSTERED INDEX [i_t_membership_yrmo] ON [dbo].[n_membership]
(
	[yrmo] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 80) ON [PRIMARY]
GO
SET ANSI_PADDING ON

GO
/****** Object:  Index [IX_t_SAI]    Script Date: 08/08/2017 12:25:54 PM ******/
CREATE NONCLUSTERED INDEX [IX_t_SAI] ON [dbo].[t_SAI]
(
	[Savings_Realization_Start_Date] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 80) ON [PRIMARY]
GO
SET ANSI_PADDING ON

GO
/****** Object:  Index [IX_t_SAI_last_updated_by]    Script Date: 08/08/2017 12:25:54 PM ******/
CREATE NONCLUSTERED INDEX [IX_t_SAI_last_updated_by] ON [dbo].[t_SAI]
(
	[last_updated_by] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 80) ON [PRIMARY]
GO
/****** Object:  Index [IX_t_SAI_last_updated_dt]    Script Date: 08/08/2017 12:25:54 PM ******/
CREATE NONCLUSTERED INDEX [IX_t_SAI_last_updated_dt] ON [dbo].[t_SAI]
(
	[Last_Updated_dt] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 80) ON [PRIMARY]
GO
SET ANSI_PADDING ON

GO
/****** Object:  Index [IX_t_SAI_sai_owner]    Script Date: 08/08/2017 12:25:54 PM ******/
CREATE NONCLUSTERED INDEX [IX_t_SAI_sai_owner] ON [dbo].[t_SAI]
(
	[sai_owner] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 80) ON [PRIMARY]
GO
SET ANSI_PADDING ON

GO
/****** Object:  Index [IX_t_SAI_savings_realiz]    Script Date: 08/08/2017 12:25:54 PM ******/
CREATE NONCLUSTERED INDEX [IX_t_SAI_savings_realiz] ON [dbo].[t_SAI]
(
	[Savings_Realization_Start_Date] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 80) ON [PRIMARY]
GO
SET ANSI_PADDING ON

GO
/****** Object:  Index [IX_t_SAI_Status]    Script Date: 08/08/2017 12:25:54 PM ******/
CREATE NONCLUSTERED INDEX [IX_t_SAI_Status] ON [dbo].[t_SAI]
(
	[Status] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 80) ON [PRIMARY]
GO
SET ANSI_PADDING ON

GO
/****** Object:  Index [IX_t_SAI_work_grp]    Script Date: 08/08/2017 12:25:54 PM ******/
CREATE NONCLUSTERED INDEX [IX_t_SAI_work_grp] ON [dbo].[t_SAI]
(
	[work_grp] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 80) ON [PRIMARY]
GO
SET ANSI_PADDING ON

GO
/****** Object:  Index [dsfsasfsfd]    Script Date: 08/08/2017 12:25:54 PM ******/
CREATE NONCLUSTERED INDEX [dsfsasfsfd] ON [dbo].[zzJul31t_membership]
(
	[Category] ASC
)
INCLUDE ( 	[company],
	[fund],
	[reg],
	[MH],
	[market],
	[lob],
	[segment],
	[product],
	[yrmo],
	[med_mems],
	[rx_mems],
	[plan_mkt_cd]) WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 80) ON [PRIMARY]
GO
SET ANSI_PADDING ON

GO
/****** Object:  Index [mp2]    Script Date: 08/08/2017 12:25:54 PM ******/
CREATE NONCLUSTERED INDEX [mp2] ON [dbo].[zzJul31t_membership]
(
	[Category] ASC,
	[yrmo] ASC
)
INCLUDE ( 	[company],
	[fund],
	[reg],
	[MH],
	[market],
	[lob],
	[segment],
	[product],
	[med_mems],
	[rx_mems],
	[plan_mkt_cd]) WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 80) ON [PRIMARY]
GO
/****** Object:  StoredProcedure [dbo].[DB_MAINT]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		gds
-- Create date: 06.23.2017
-- Description:	DB_Maint
-- =============================================
CREATE PROCEDURE [dbo].[DB_MAINT]
	-- Add the parameters for the stored procedure here
AS
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    -- Insert statements for procedure here
	     -- Insert statements for procedure here
	DECLARE @TableName VARCHAR(255)
	DECLARE @sql NVARCHAR(500)
	DECLARE @fillfactor INT
	SET @fillfactor = 80
	DECLARE TableCursor CURSOR FOR
	SELECT OBJECT_SCHEMA_NAME([object_id])+'.'+name AS TableName
	FROM sys.tables
	OPEN TableCursor
	FETCH NEXT FROM TableCursor INTO @TableName
	WHILE @@FETCH_STATUS = 0
	BEGIN
	print @TableName
	SET @sql = 'ALTER INDEX ALL ON ' + @TableName + ' REBUILD WITH (FILLFACTOR = ' + CONVERT(VARCHAR(3),@fillfactor) + ')'
	EXEC (@sql)
	FETCH NEXT FROM TableCursor INTO @TableName
	END
	CLOSE TableCursor
	DEALLOCATE TableCursor

END

GO
/****** Object:  StoredProcedure [dbo].[JUNKusp_xl_savings_pivot]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


-- =============================================
-- Author:		Mike Martin
-- Create date: 6/1/17
-- Description:	SAI Excel savings Pivot Data Source
-- =============================================


CREATE PROCEDURE [dbo].[JUNKusp_xl_savings_pivot] 
	-- Add the parameters for the stored procedure here
	-- @yr   smallint  ---year
AS
BEGIN
   ---  exec saip001.dbo.usp_xl_savings_pivot 
   /* insert the current records into the history */
   
  

      Create table #sub (
		     Company varchar(15) NOT NULL, 
			 Fund varchar(2) NOT NULL, 
			 reg char(2) NOT NULL,
			 mh varchar(30) NOT NULL,
			 market varchar(30) NOT NULL, 
			 lob char (2) NOT NULL,
			 Level1 varchar(25) NOT NULL, 
			 Level2 varchar(25) NOT NULL, 
			 segment varchar(25) not null,
			 product varchar(25) not null,
			 yr smallint NOT NULL,
			 bus_unit varchar(50) NOT NULL, 
			 target_doll decimal(19,2) NOT NULL, 
			 le_doll decimal(19,2) NOT NULL, 
			 med_memmos int NOT NULL, 
			 rx_memmos int NOT NULL,
         )

   
   /* insert into the sub table which will be used for the remaining queries */
   /* note bus_unit really is bus_unit_nm */
   INSERT INTO #sub  

		SELECT m.company,m.fund,m.reg,m.mh,m.market,m.lob,m.Level1,m.Level2,m.segment,m.product,m.yr,m.bus_unit_nm as bus_unit,
					m.target_doll, Isnull(le.med_doll,0.00) + Isnull(le.rx_doll,0.00) as le_doll,m.med_memmos,m.rx_memmos
		from (
				SELECT t.company, t.fund, max(t.reg) reg, max(t.mh) mh, t.market, t.lob, max(Level1) Level1, max(Level2) Level2,
				        t.segment, t.product,  t.yr, t.bus_unit, max(t.bus_unit_nm) as bus_unit_nm
						,Sum(t.target_doll) AS target_doll,sum(t.med_memmos) med_memmos, sum(t.rx_memmos) rx_memmos

				FROM dbo.q_targets_reporting t
				where t.yr >= 2017
				GROUP BY t.company, t.fund, t.market, t.lob,  t.segment, t.product,  t.yr, t.bus_unit
	
			) m left join (
				SELECT r.company, r.fund, max(r.reg) reg, max(r.mh) mh, r.market, r.lob, r.segment, r.product, r.yr, r.bus_unit, 
						Sum(r.med_doll) AS med_doll, Sum(r.rx_doll) AS rx_doll
				FROM q_Reporting r 
				WHERE r.Active_or_Idea=1 and r.yr>=2017
				GROUP BY r.company, r.fund, r.market, r.lob, r.segment, r.product, r.yr, r.bus_unit
			) le 
  
			 ON m.company = le.company AND m.fund = le.fund AND m.market = le.market AND m.lob = le.lob
			  AND m.segment = le.segment AND m.product = le.product AND m.yr = le.yr AND m.bus_unit = le.bus_unit 
      

		SELECT company, fund, reg, mh, market, lob,Level1, Level2,segment, product, yr, bus_unit 
				,target_doll,le_doll, med_memmos, rx_memmos
		FROM #sub
		UNION
	/* summarize without LNMEU */
		SELECT company, fund, reg, mh, market, lob,  max(Level1) Level1, max(Level2) Level2,segment, product, yr, '<All-ex LM>' as bus_unit 
				,Sum(target_doll) AS target_doll,Sum(le_doll) AS le_doll,max(med_memmos) med_memmos, max(rx_memmos) rx_memmos
		FROM #sub
		where bus_unit not in ('LM','LNMEU') 
		GROUP BY company, fund, reg, mh, market, lob, segment, product, yr

		UNION 
		/* SUMMARIZE THROUGH ALL BUS_UNITS */
		SELECT company, fund, reg, mh, market, lob,  max(Level1) Level1, max(Level2) Level2,segment, product, yr, '<All-Combine>' as bus_unit 
				,Sum(target_doll) AS target_doll,Sum(le_doll) AS le_doll,max(med_memmos) med_memmos, max(rx_memmos) rx_memmos
		FROM #sub
		GROUP BY company, fund, reg, mh, market, lob, segment, product, yr
		
 


	   
  
   /* add consolidated */
 --  INSERT INTO #Adm_015_Doll 
 --       SELECT sai_id, SAI_Name_and_No, Status,  Company, Fund, max('_cons') AS mkt, period, lob, LobSeg, bus_unit,
 --       Sum(doll) AS doll,  max(bus_unit_display_name) as bus_unit_display_name, max(Business_Unit_Alt_Name) as Business_Unit_Alt_Name,max(4) as lvl 
 --       FROM #sub_Adm_015_Doll
 --       GROUP BY sai_id, SAI_Name_and_No, Status, Company, Fund, period, lob, LobSeg, bus_unit
 --   ;  
 --select * from #Adm_015_Doll 
END



GO
/****** Object:  StoredProcedure [dbo].[usp_Adm_015]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

-- =============================================
-- Author:		Mike Martin
-- Create date: 6/1/17
-- Description:	Market Crosstab Data 
-- =============================================


CREATE PROCEDURE [dbo].[usp_Adm_015] 
	-- Add the parameters for the stored procedure here
	 @yr   smallint  ---year
AS
BEGIN
   ---  exec [dbo].[usp_Adm_015] @yr=2017
   /* insert the current records into the history */
   
   Create table #sub_Adm_015_Doll (
             sai_id int NOT NULL,
		     SAI_Name_and_No varchar (255) NOT NULL, 
		     [Status] varchar(25) NOT NULL, 
		     Company varchar(15) NOT NULL, 
			 Fund varchar(2) NOT NULL, 
			 reg  varchar(15) NOT NULL,
			 mh varchar(30) NOT NULL,
			 market varchar(30) NOT NULL,
		     period smallint NOT NULL,
			 lob char (2) NOT NULL,
			 LobSeg varchar(25) NOT NULL, 
			 bus_unit varchar(50) NOT NULL, 
			 doll decimal(19,4) NOT NULL, 
			 bus_unit_display_name varchar (50) NOT NULL, 
			 Business_Unit_Alt_Name varchar(50) NOT NULL
   )

      Create table #Adm_015_Doll (
             sai_id int NOT NULL,
		     SAI_Name_and_No varchar (255) NOT NULL, 
		     [Status] varchar(25) NOT NULL, 
		     Company varchar(15) NOT NULL, 
			 Fund varchar(2) NOT NULL, 
			 mkt varchar(30) NOT NULL, 
		     period smallint NOT NULL,
			 lob char (2) NOT NULL,
			 LobSeg varchar(25) NOT NULL, 
			 bus_unit varchar(50) NOT NULL, 
			 doll decimal(19,4) NOT NULL, 
			 bus_unit_display_name varchar (50) NOT NULL, 
			 Business_Unit_Alt_Name varchar(50) NOT NULL,
			 lvl smallint not null
         )

   
   /* insert into the sub table which will be used for the remaining queries */
   INSERT INTO #sub_Adm_015_Doll 
            SELECT sai_id, SAI_Name_and_No,Status, Company, Fund, 
                   Reg, MH, Market, yr AS period, lob, 
                   IIf([lob]='ME' Or segment in ('Hix','cb'),[segment],[Product]) AS LobSeg, bus_unit, 
                   Sum(doll) AS doll,  max(bus_unit_display_name) as bus_unit_display_name, max(Business_Unit_Alt_Name) as Business_Unit_Alt_Name
			FROM q_Reporting 
			WHERE active_or_idea=1 and yr = @yr ---and sai_id between 1002 and 1500
			GROUP BY sai_id, SAI_Name_and_No, Status, Company, Fund, 
				Reg,  MH, Market, yr, lob, IIf([lob]='ME' Or segment in ('Hix','cb'),[segment],[Product]), bus_unit
 ;
 
    /* add Market (level 1) */
   INSERT INTO #Adm_015_Doll 
            SELECT sai_id, SAI_Name_and_No, Status,  Company, Fund, [Reg] + '_' + [market]  AS mkt, period, lob, LobSeg, bus_unit,
            Sum(doll) AS doll,  max(bus_unit_display_name) as bus_unit_display_name, max(Business_Unit_Alt_Name) as Business_Unit_Alt_Name,max(1) as lvl 
            FROM #sub_Adm_015_Doll
            GROUP BY sai_id, SAI_Name_and_No, Status, Company, Fund, [Reg] + '_' + [market] , period, lob, LobSeg, bus_unit
    ; 
      
     /* add Market Head */
   INSERT INTO #Adm_015_Doll 
        SELECT   sai_id, SAI_Name_and_No, Status, Company, Fund, [Reg] + '__' + [mh] AS mkt, period, lob, LobSeg, bus_unit,
        Sum(doll) AS doll,  max(bus_unit_display_name) as bus_unit_display_name, max(Business_Unit_Alt_Name) as Business_Unit_Alt_Name,max(2) as lvl 
        FROM #sub_Adm_015_Doll
        GROUP BY sai_id, SAI_Name_and_No, Status, Company, Fund, [Reg] + '__' + [mh], period, lob, LobSeg, bus_unit
    ;  
          /* add Region */
   INSERT INTO #Adm_015_Doll 
        SELECT sai_id, SAI_Name_and_No, Status,  Company, Fund, [Reg]  AS mkt, period, lob, LobSeg, bus_unit,
        Sum(doll) AS doll,  max(bus_unit_display_name) as bus_unit_display_name, max(Business_Unit_Alt_Name) as Business_Unit_Alt_Name,max(3) as lvl 
        FROM #sub_Adm_015_Doll
        GROUP BY sai_id, SAI_Name_and_No, Status, Company, Fund, [Reg] , period, lob, LobSeg, bus_unit
    ;  
  
   /* add consolidated */
   INSERT INTO #Adm_015_Doll 
        SELECT sai_id, SAI_Name_and_No, Status,  Company, Fund, max('_cons') AS mkt, period, lob, LobSeg, bus_unit,
        Sum(doll) AS doll,  max(bus_unit_display_name) as bus_unit_display_name, max(Business_Unit_Alt_Name) as Business_Unit_Alt_Name,max(4) as lvl 
        FROM #sub_Adm_015_Doll
        GROUP BY sai_id, SAI_Name_and_No, Status, Company, Fund, period, lob, LobSeg, bus_unit
    ;  
 select * from #Adm_015_Doll 
END


GO
/****** Object:  StoredProcedure [dbo].[usp_build_tReporting]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


-- =============================================
-- Author:		Mike Martin
-- Create date: 6/1/17
-- Description:	Market Crosstab Data 
-- =============================================


CREATE PROCEDURE [dbo].[usp_build_tReporting] 
	-- Add the parameters for the stored procedure here
	 @yr   smallint  ---year
AS
BEGIN
   ---  exec [dbo].[usp_Adm_015] @yr=2017
   /* insert the current records into the history */
   
   Create table #LE (


	[Fund] [varchar](2) NOT NULL,
	[market] [varchar](30) NOT NULL,
	[LOB] [varchar](2) NOT NULL,
	[Segment] [varchar](15) NOT NULL,
	[Product] [varchar](15) NOT NULL,
	[med_pmpm] [float] NOT NULL,
	[rx_pmpm] [float] NOT NULL,
	[le_Last_Updated_dt] [datetime] NULL ,
	[le_last_updated_by] [varchar](50) NULL,


   start_mo char(6) not null,
    stop_mo char(6) not null,
    savings_start_yr smallint not null,
   )
   insert into #LE
   SELECT         dbo.t_LE.Fund, dbo.t_LE.market, dbo.t_LE.LOB, dbo.t_LE.Segment, dbo.t_LE.Product, dbo.t_LE.med_pmpm, dbo.t_LE.rx_pmpm, 
                     
						  q_SAI.*,
                         lku_months.yrmo AS start_mo, lku_months.Stop_mo,lku_months.yr as savings_start_yr
				

FROM            dbo.lku_months INNER JOIN
                         dbo.q_sai q_SAI ON lku_months.yrmo = q_SAI.Savings_Realization_Start_Date INNER JOIN
                         dbo.t_LE ON q_SAI.sai_id = t_LE.sai_id 
      Create table #Adm_015_Doll (
             sai_id int NOT NULL,
		     SAI_Name_and_No varchar (255) NOT NULL, 
		     [Status] varchar(25) NOT NULL, 
		     Company varchar(15) NOT NULL, 
			 Fund varchar(2) NOT NULL, 
			 mkt varchar(30) NOT NULL, 
		     period smallint NOT NULL,
			 lob char (2) NOT NULL,
			 LobSeg varchar(25) NOT NULL, 
			 bus_unit varchar(50) NOT NULL, 
			 doll decimal(19,4) NOT NULL, 
			 bus_unit_display_name varchar (50) NOT NULL, 
			 Business_Unit_Alt_Name varchar(50) NOT NULL,
			 lvl smallint not null
         )

    
END



GO
/****** Object:  StoredProcedure [dbo].[uspBuildHistory]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


-- =============================================
-- Author:		Mike Martin
-- Create date: 6/1/17
-- Description:	Add record to the History table 
-- =============================================


CREATE PROCEDURE [dbo].[uspBuildHistory] 
	-- Add the parameters for the stored procedure here
	@DataVersion varchar(15)
AS
BEGIN
    ---exec uspBuildHistory @DataVersion = ''
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	/* default to today's date in yymmdd format */
  declare @DefaultDataVersion varchar(15) = convert(varchar(15),getdate(),112)
  if @DataVersion='' set @DataVersion=@DefaultDataVersion

   /* remove any old records with this @DataVersion */
   DELETE FROM [dbo].[history_LE] where DataVersion = @DataVersion

  /****************************  LEs ***********************************************************/
   INSERT INTO [dbo].[history_LE]
           ([DataVersion]
           ,[sai_id]
           ,[Fund]
           ,[market]
           ,[LOB]
           ,[Segment]
           ,[Product]
           ,[med_pmpm]
           ,[rx_pmpm]
           ,[original_create_dt]
           ,[Last_Updated_dt]
           ,[last_updated_by]
           ,[Comments]
           ,[qb_record_id]
           )
					SELECT 
						@DataVersion as DataVersion
					   ,[sai_id]
					  ,[Fund]
					  ,[market]
					  ,[LOB]
					  ,[Segment]
					  ,[Product]
					  ,[med_pmpm]
					  ,[rx_pmpm]
					  ,[original_create_dt]
					  ,[Last_Updated_dt]
					  ,[last_updated_by]
					  ,[Comments]
					  ,[qb_record_id]
				  FROM [SAIP001].[dbo].[t_LE] 


  /****************************  targets ***********************************************************/
  INSERT INTO [dbo].[history_targets]
           ([DataVersion]
           ,[market]
           ,[bus_unit]
           ,[company]
           ,[fund]
           ,[lob]
           ,[segment]
           ,[product]
           ,[yr]
           ,[target_based_on_med_mem]
           ,[target_based_on_rx_mem]
		   )
					select 
							@DataVersion as DataVersion
						   ,[market]
						   ,[bus_unit]
						   ,[company]
						   ,[fund]
						   ,[lob]
						   ,[segment]
						   ,[product]
						   ,[yr]
						   ,[target_based_on_med_mem]
						   ,[target_based_on_rx_mem]
					from [dbo].[t_targets]
  /*  end targets */



    /****************************  membership ***********************************************************/

	INSERT INTO [dbo].[history_membership]
           ([DataVersion]
           ,[company]
           ,[fund]
           ,[market]
           ,[lob]
           ,[segment]
           ,[product]
           ,[yrmo]
           ,[med_mems]
           ,[rx_mems]
           ,[plan_mkt_cd])
					SELECT 
					       @DataVersion as DataVersion
						  ,[company]
						  ,[fund]
						  ,[market]
						  ,[lob]
						  ,[segment]
						  ,[product]
						  ,[yrmo]
						  ,[med_mems]
						  ,[rx_mems]
						  ,[plan_mkt_cd]
					  FROM [SAIP001].[dbo].[n_membership]


/* output summary */
  Select * from (
  SELECT 'LEs' as cat, [DataVersion]  ,count(*) as cnt 
  FROM [SAIP001].[dbo].[history_LE] 
  group by DataVersion
  UNION
  SELECT  'mems' as cat, [DataVersion]  ,count(*) as cnt 
  FROM [SAIP001].[dbo].[history_Membership] 
  group by DataVersion
  UNION
  SELECT  'targets' as cat, [DataVersion]  ,count(*) as cnt 
  FROM [SAIP001].[dbo].[history_targets] 
  group by DataVersion
  ) t where t.DataVersion = @DataVersion 
  order by 1 asc, 2 desc
END

GO
/****** Object:  StoredProcedure [dbo].[uspHistoryCheckLoad]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



-- =============================================
-- Author:		Mike Martin
-- Create date: 6/1/17
-- Description:	Add record to the History table 
-- =============================================


CREATE PROCEDURE [dbo].[uspHistoryCheckLoad] 
	-- Add the parameters for the stored procedure here
	@DataVersion varchar(15)
AS
BEGIN
    ---exec uspBuildHistory @DataVersion = ''
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	/* default to today's date in yymmdd format */
  declare @DefaultDataVersion varchar(15) = convert(varchar(15),getdate(),112)
  if @DataVersion='' set @DataVersion=@DefaultDataVersion

 

  /****************************  LEs ***********************************************************/
 delete from [dbo].[history_check_le] where DataVersion = @DataVersion ;
INSERT INTO [dbo].[history_check_le]
           ([DataVersion]
           ,[sai_id]
           ,[Fund]
           ,[market]
           ,[LOB]
           ,[Segment]
           ,[Product]
           ,[yr]
		   ,[bus_unit]
           ,[active_or_idea]
           ,[doll_le]
		   ,DateAdded
            )
				SELECT
					@DataVersion as DataVersion ,
					[sai_id] ,
					[Fund] ,
					[market] ,
					[LOB] ,
					[Segment] ,
					[Product] ,
					yr ,
					max(bus_unit) as bus_unit,
					max(Active_or_Idea) Active_or_Idea  ,
					sum(med_doll + rx_doll) as le_doll ,
					max(getdate()) as DateAdded
	 
				  FROM [SAIP001].[dbo].[q_Reporting] 
				  where yr >= 2016  
				  group by 
					  [sai_id] ,
					[Fund] ,
					[market] ,
					[LOB] ,
					[Segment] ,
					[Product] ,
					yr   
				  ;
				 
				
  /****************************  targets ***********************************************************/
  delete from [dbo].[history_check_targets] where DataVersion = @DataVersion ;
  INSERT INTO [dbo].[history_check_targets] 
				([DataVersion]
				,[Fund]
				,[market]
				,[LOB]
				,[Segment]
				,[Product]
				,[yr]
				,bus_unit
				,doll_target
				, memmo
				,DateAdded
				)

						select 
						@DataVersion as DataVersion,
						[Fund] ,
						[market] ,
						[LOB] ,
						[Segment] ,
						[Product] ,
						yr ,
						bus_unit,
						sum([target_doll]) as doll_target,
						 max([med_memmos])  as memmos,
						 max(getdate()) as DateAdded
	 
					FROM [SAIP001].[dbo].[q_targets_reporting]
					where target_doll > 0 and med_memmos >0
					  group by 
  						[Fund] ,
						[market] ,
						[LOB] ,
						[Segment] ,
						[Product] ,
						yr ,
						bus_unit
						;

 
/* output summary */
  Select * from (
	  SELECT 'LEs' as cat, [DataVersion]  ,count(*) as cnt 
	  FROM [SAIP001].[dbo].[history_check_LE] 
	  group by DataVersion
	  UNION
	  SELECT  'targets' as cat, [DataVersion]  ,count(*) as cnt 
	  FROM [SAIP001].[dbo].[history_check_targets] 
	  group by DataVersion
	  ) t 
  where t.DataVersion = @DataVersion 
  order by 1 asc, 2 desc
END


GO
/****** Object:  StoredProcedure [dbo].[uspHistoryCheckLoadCompareLE]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO




-- =============================================
-- Author:		Mike Martin
-- Create date: 6/1/17
-- Description:	Add record to the History table 
-- =============================================


CREATE PROCEDURE [dbo].[uspHistoryCheckLoadCompareLE] 
	-- Add the parameters for the stored procedure here
	@Version1 varchar(15),
	@Version2 varchar(15)
AS
BEGIN
    ---exec uspBuildHistory @DataVersion = ''
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	/* default to today's date in yymmdd format */
  declare @DefaultVersion2 varchar(15) = convert(varchar(15),getdate(),112)
  if @Version2='' set @Version2=@DefaultVersion2

 

  /****************************  Compare @Version1 vs @Version2 ******************************************/
CREATE TABLE #v1 (
	[dv1] [varchar](15) NOT NULL,
	sai_id  int not null,
	[Fund] [varchar](2) NOT NULL,
	[market] [varchar](30) NOT NULL,
	[LOB] [varchar](2) NOT NULL,
	[Segment] [varchar](15) NOT NULL,
	[Product] [varchar](15) NOT NULL,
	[yr] [smallint] NOT NULL,
		bus_unit varchar(50) not null,
	[v1_doll] [decimal](12, 4) NOT NULL
	)

CREATE TABLE #v2 (
	[dv2] [varchar](15) NOT NULL,
	sai_id  int not null,
	[Fund] [varchar](2) NOT NULL,
	[market] [varchar](30) NOT NULL,
	[LOB] [varchar](2) NOT NULL,
	[Segment] [varchar](15) NOT NULL,
	[Product] [varchar](15) NOT NULL,
	[yr] [smallint] NOT NULL,
		bus_unit varchar(50) not null,
	[v2_doll] [decimal](12, 4) NOT NULL
	)

insert into #v1 

					select 
						DataVersion as dv1,
						sai_id  ,
						Fund ,
						market ,
						LOB ,
						Segment ,
						Product ,
						yr ,
						bus_unit,
						 doll_le as v1_doll
	 
					FROM SAIP001.dbo.history_check_le 
					Where DataVersion = @Version1 
	;

	insert into #v2

					select 
						DataVersion as dv2,
						sai_id  ,
						Fund ,
						market ,
						LOB ,
						Segment ,
						Product ,
					     yr ,
						 bus_unit,
						 doll_le as v2_doll
	 
					FROM SAIP001.dbo.history_check_le
					Where DataVersion = @Version2 
	;

select v.*, isnull(v1_doll,0) - isnull(v2_doll,0) as dif_doll 
from  (
			 select
 									dv1,dv2,
									v1.sai_id  ,
									v1.Fund ,
									v1.market ,
									v1.LOB ,
									v1.Segment ,
									v1.Product ,
									v1.yr ,
									v1.bus_unit,
									v1_doll,
									v2_doll
				 from #v1 v1 left join #v2 v2 
						on 		v1.Fund =v2.fund and v1.sai_id = v2.sai_id and v1.market =v2.market and v1.LOB = v2.lob and
								v1.Segment = v2.segment and v1.Product =v2.product and v1.yr =v2.yr
								and v1.bus_unit = v2.bus_unit
			 UNION
			  select
 									dv1,dv2,
									v2.sai_id,
									v2.Fund ,
									v2.market ,
									v2.LOB ,
									v2.Segment ,
									v2.Product ,
									v2.yr ,
									v2.bus_unit,
									v1_doll,
									v2_doll

				 from #v2 v2 left join #v1 v1 
						on 		v1.Fund =v2.fund and v1.sai_id = v2.sai_id and v1.market =v2.market and v1.LOB = v2.lob and
								v1.Segment = v2.segment and v1.Product =v2.product and v1.yr =v2.yr
								and v1.bus_unit = v2.bus_unit
				 where v1.market is null

           )  v



END



GO
/****** Object:  StoredProcedure [dbo].[uspHistoryCheckLoadCompareTarget]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO




-- =============================================
-- Author:		Mike Martin
-- Create date: 6/1/17
-- Description:	Add record to the History table 
-- =============================================


CREATE PROCEDURE [dbo].[uspHistoryCheckLoadCompareTarget] 
	-- Add the parameters for the stored procedure here
	@Version1 varchar(15),
	@Version2 varchar(15)
AS
BEGIN
    ---exec uspBuildHistory @DataVersion = ''
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	/* default to today's date in yymmdd format */
  declare @DefaultVersion2 varchar(15) = convert(varchar(15),getdate(),112)
  if @Version2='' set @Version2=@DefaultVersion2

 

  /****************************  Compare @Version1 vs @Version2 ******************************************/
CREATE TABLE #v1 (
	[dv1] [varchar](15) NOT NULL,
	[Fund] [varchar](2) NOT NULL,
	[market] [varchar](30) NOT NULL,
	[LOB] [varchar](2) NOT NULL,
	[Segment] [varchar](15) NOT NULL,
	[Product] [varchar](15) NOT NULL,
	[yr] [smallint] NOT NULL,
	bus_unit varchar(50) not null,
	[v1_doll] [decimal](14, 5) NOT NULL,
	[v1_memmo] [decimal](14, 4) NOT NULL
	)

CREATE TABLE #v2 (
	[dv2] [varchar](15) NOT NULL,
	[Fund] [varchar](2) NOT NULL,
	[market] [varchar](30) NOT NULL,
	[LOB] [varchar](2) NOT NULL,
	[Segment] [varchar](15) NOT NULL,
	[Product] [varchar](15) NOT NULL,
	[yr] [smallint] NOT NULL,
		bus_unit varchar(50) not null,
	[v2_doll] [decimal](14, 5) NOT NULL,
	[v2_memmo] [decimal](15, 5) NOT NULL
	)
CREATE TABLE #v3 (
	[dv3] [varchar](15) NOT NULL,
	[Fund] [varchar](2) NOT NULL,
	[market] [varchar](30) NOT NULL,
	[LOB] [varchar](2) NOT NULL,
	[Segment] [varchar](15) NOT NULL,
	[Product] [varchar](15) NOT NULL,
	[yr] [smallint] NOT NULL,
		bus_unit varchar(50) not null,
	[v3_pmpm] [decimal](14, 5) NOT NULL
	/* no memmos for #v3 */
	)
insert into #v1 

					select 
						DataVersion as dv1,
						Fund ,
						market ,
						LOB ,
						Segment ,
						Product ,
						yr ,
						bus_unit,
						 doll_target as v1_doll,
						memmo as v1_memmo
	 
					FROM SAIP001.dbo.history_check_targets 
					Where DataVersion = @Version1 
	;

	insert into #v2

					select 
						DataVersion as dv2,
						Fund ,
						market ,
						LOB ,
						Segment ,
						Product ,
					     yr ,
						bus_unit,
						 doll_target as v2_doll,
						memmo as v2_memmo
	 
					FROM SAIP001.dbo.history_check_targets 
					Where DataVersion = @Version2 
	;

	insert into #v3  
					select 
						'target' as dv3,
						Fund ,
						market ,
						LOB ,
						Segment ,
						Product ,
					     yr ,
						bus_unit,
						 avg(isnull(target_based_on_med_mem,target_based_on_rx_mem)) as v3_pmpm
					FROM SAIP001.dbo.t_targets 
					Group BY 
						Fund ,
						market ,
						LOB ,
						Segment ,
						Product ,
					     yr ,
						bus_unit
				
	;
	select v.*
	,v1_doll / nullif(v1_memmo,0) as v1_pmpm
	,v2_doll / nullif(v2_memmo,0) as v2_pmpm
	 ,isnull(v1_doll,0) - nullif(v2_doll,0) as dif12_doll, isnull(v1_memmo,0) - isnull(v2_memmo,0) as dif12_memmo
    , cast(isnull(v2_doll / nullif(v2_memmo,0),0) - isnull(v3_pmpm,0) as decimal(14,4))as dif23_pmpm
from  (
			 select
 									dv1,dv2,dv3,
									v1.Fund ,
									v1.market ,
									v1.LOB ,
									v1.Segment ,
									v1.Product ,
									v1.yr ,
									v1.bus_unit,
									v1_doll,
									v2_doll,
									v3_pmpm,
									v1_memmo,
									v2_memmo
				 from #v1 v1 left join #v2 v2 
						on 		v1.Fund =v2.fund and v1.market =v2.market and v1.LOB = v2.lob and
								v1.Segment = v2.segment and v1.Product =v2.product and v1.yr =v2.yr
								and v1.bus_unit = v2.bus_unit
						left join #v3 v3 
						on 		v1.Fund =v3.fund and v1.market =v3.market and v1.LOB = v3.lob and
								v1.Segment = v3.segment and v1.Product =v3.product and v1.yr =v3.yr
								and v1.bus_unit = v3.bus_unit
			 UNION
			  select
 									dv1,dv2,dv3,
									v2.Fund ,
									v2.market ,
									v2.LOB ,
									v2.Segment ,
									v2.Product ,
									v2.yr ,
									v2.bus_unit,
									v1_doll,
									v2_doll,
									v3_pmpm,
									v1_memmo,
									v2_memmo
				 from #v2 v2 left join #v1 v1 
						on 		v1.Fund =v2.fund and v1.market =v2.market and v1.LOB = v2.lob and
								v1.Segment = v2.segment and v1.Product =v2.product and v1.yr =v2.yr
								and v1.bus_unit = v2.bus_unit
					left join #v3 v3 
						on 		v3.Fund =v2.fund and v3.market =v2.market and v3.LOB = v2.lob and
								v3.Segment = v2.segment and v3.Product =v2.product and v3.yr =v2.yr
								and v3.bus_unit = v2.bus_unit
				 where v3.market is null 
		/*	UNION
			  select
 									dv1,dv2,dv3,
									v3.Fund ,
									v3.market ,
									v3.LOB ,
									v3.Segment ,
									v3.Product ,
									v3.yr ,
									v3.bus_unit,
									v1_doll,
									v2_doll,
									v3_pmpm,
									v1_memmo,
									v2_memmo
				 from #v3 v3 left join #v2 v2 
						on 		v3.Fund =v2.fund and v3.market =v2.market and v3.LOB = v2.lob and
								v3.Segment = v2.segment and v3.Product =v2.product and v3.yr =v2.yr
								and v3.bus_unit = v2.bus_unit
						left join #v1 v1
						on 		v3.Fund =v1.fund and v3.market =v1.market and v3.LOB = v1.lob and
								v3.Segment = v1.segment and v3.Product =v1.product and v3.yr =v1.yr
								and v3.bus_unit = v1.bus_unit
				 where v2.market is null
          */ )  v

 where v.yr >=2017 ---and market = 'Wisconsin' and bus_unit='Rx'

END



GO
/****** Object:  StoredProcedure [dbo].[zzJUNKuspHistoryCheckLoadCompareLE2]    Script Date: 08/08/2017 12:25:54 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO





-- =============================================
-- Author:		Mike Martin
-- Create date: 6/1/17
-- Description:	Add record to the History table 
-- =============================================


CREATE PROCEDURE [dbo].[zzJUNKuspHistoryCheckLoadCompareLE2] 
	-- Add the parameters for the stored procedure here
	@Version1 varchar(15),
	@Version2 varchar(15)
AS
BEGIN
    ---exec uspBuildHistory @DataVersion = ''
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	/* default to today's date in yymmdd format */
  declare @DefaultVersion2 varchar(15) = convert(varchar(15),getdate(),112)
  if @Version2='' set @Version2=@DefaultVersion2

declare @ssql  nvarchar(2000);

set @ssql= N' 

with v1 as ( 

					select 
						DataVersion as dv1,
						Fund ,
						market ,
						LOB ,
						Segment ,
						Product ,
						yr ,
						 doll_le as v1_doll
	 
					FROM SAIP001.dbo.history_check_le 
					Where DataVersion = ' +char(39) + @Version1 + char(39) + '
	)
,v2 as (
 
					select 
						DataVersion as dv2,
						Fund ,
						market ,
						LOB ,
						Segment ,
						Product ,
					     yr ,
						 doll_le as v2_doll
	 
					FROM SAIP001.dbo.history_check_le
					Where DataVersion = ' +char(39) + @Version2  + char(39) + '
	)

select v.*, isnull(v1_doll,0) - isnull(v2_doll,0) as dif_doll 
from  (
			 select
 									dv1,v2.dv2,
									v1.Fund ,
									v1.market ,
									v1.LOB ,
									v1.Segment ,
									v1.Product ,
									v1.yr ,
									v1_doll,
									v2_doll
				 from v1 left join  v2 
						on 		v1.Fund =v2.fund and v1.market =v2.market and v1.LOB = v2.lob and
								v1.Segment = v2.segment and v1.Product =v2.product and v1.yr =v2.yr
			 UNION
			  select
 									dv1,dv2,
									v2.Fund ,
									v2.market ,
									v2.LOB ,
									v2.Segment ,
									v2.Product ,
									v2.yr ,
									v1_doll,
									v2_doll

				 from v2 left join  v1 
						on 		v1.Fund =v2.fund and v1.market =v2.market and v1.LOB = v2.lob and
								v1.Segment = v2.segment and v1.Product =v2.product and v1.yr =v2.yr
								and v1.market is null

           )  v

		   '

 exec sp_executesql @sSql
END




GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "lku_months (dbo)"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 135
               Right = 208
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "t_SAI (dbo)"
            Begin Extent = 
               Top = 6
               Left = 246
               Bottom = 135
               Right = 521
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "t_LE (dbo)"
            Begin Extent = 
               Top = 6
               Left = 559
               Bottom = 135
               Right = 741
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 9
         Width = 284
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'q_LE'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'q_LE'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "t_LE (dbo)"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 135
               Right = 236
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "lku_users (dbo)"
            Begin Extent = 
               Top = 6
               Left = 274
               Bottom = 135
               Right = 539
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "q_le_last_updated_sub"
            Begin Extent = 
               Top = 6
               Left = 577
               Bottom = 67
               Right = 763
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 9
         Width = 284
         Width = 1080
         Width = 1980
         Width = 2100
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 12
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'q_le_last_updated'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'q_le_last_updated'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "t_membership (dbo)"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 335
               Right = 208
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "lku_market (dbo)"
            Begin Extent = 
               Top = 6
               Left = 246
               Bottom = 304
               Right = 437
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "lku_months (dbo)"
            Begin Extent = 
               Top = 6
               Left = 475
               Bottom = 135
               Right = 645
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 18
         Width = 284
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'q_membership'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'q_membership'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "q_membership_all_months (dbo)"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 135
               Right = 224
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "lku_market (dbo)"
            Begin Extent = 
               Top = 6
               Left = 262
               Bottom = 135
               Right = 503
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 9
         Width = 284
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 12
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'q_membership_yr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'q_membership_yr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "q_reports_daily_targets1 (dbo)"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 308
               Right = 420
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 9
         Width = 284
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'q_reports_daily_targets1_rcw'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'q_reports_daily_targets1_rcw'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "t"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 135
               Right = 224
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "bu"
            Begin Extent = 
               Top = 138
               Left = 38
               Bottom = 267
               Right = 280
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 9
         Width = 284
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 12
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'q_reports_daily_targets2'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'q_reports_daily_targets2'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "lku_segment"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 116
               Right = 208
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "lku_product"
            Begin Extent = 
               Top = 6
               Left = 246
               Bottom = 116
               Right = 416
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "lku_market"
            Begin Extent = 
               Top = 6
               Left = 454
               Bottom = 133
               Right = 645
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 9
         Width = 284
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'qlku_Cartesian_mkt_prod_etc'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'qlku_Cartesian_mkt_prod_etc'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "q_reporting_sub"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 135
               Right = 313
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "lku_System"
            Begin Extent = 
               Top = 6
               Left = 351
               Bottom = 135
               Right = 559
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 9
         Width = 284
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'zzq_Reporting'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'zzq_Reporting'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "q_Reporting_sub (dbo)"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 135
               Right = 313
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 9
         Width = 284
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'zzq_Reporting_all_months'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'zzq_Reporting_all_months'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 9
         Width = 284
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'zzq_Reporting_sub'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'zzq_Reporting_sub'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "q_sai_sub (dbo)"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 135
               Right = 313
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "sai_users"
            Begin Extent = 
               Top = 6
               Left = 351
               Bottom = 135
               Right = 600
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "lastupdate_users"
            Begin Extent = 
               Top = 138
               Left = 38
               Bottom = 267
               Right = 287
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "q_le_last_updated"
            Begin Extent = 
               Top = 138
               Left = 325
               Bottom = 199
               Right = 495
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 47
         Width = 284
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'zzq_sai'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane2', @value=N'500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'zzq_sai'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=2 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'zzq_sai'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "t_SAI (dbo)"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 135
               Right = 313
            End
            DisplayFlags = 280
            TopColumn = 29
         End
         Begin Table = "lku_work_grp (dbo)"
            Begin Extent = 
               Top = 6
               Left = 351
               Bottom = 135
               Right = 676
            End
            DisplayFlags = 280
            TopColumn = 11
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 40
         Width = 284
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 6585
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'zzq_sai_sub'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane2', @value=N'400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'zzq_sai_sub'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=2 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'zzq_sai_sub'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "t"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 135
               Right = 260
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "qry_lookup_geo_for_Tableau (dbo)"
            Begin Extent = 
               Top = 6
               Left = 298
               Bottom = 135
               Right = 527
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 9
         Width = 284
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 12
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'zzzappend_Dollars_data_for_Tableau'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'zzzappend_Dollars_data_for_Tableau'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 17
         Width = 284
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 3330
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'zzzget_SAI_data_for_Tableau'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'zzzget_SAI_data_for_Tableau'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "q_membership_with_target (dbo)"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 135
               Right = 243
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "q_bus_units"
            Begin Extent = 
               Top = 6
               Left = 281
               Bottom = 67
               Right = 451
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 9
         Width = 284
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'zzzq_membership_with_target_x_bu'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'zzzq_membership_with_target_x_bu'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "append_t_reporting (dbo)"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 276
               Right = 208
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "t_SAI (dbo)"
            Begin Extent = 
               Top = 131
               Left = 297
               Bottom = 260
               Right = 572
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "lku_work_grp (dbo)"
            Begin Extent = 
               Top = 6
               Left = 559
               Bottom = 135
               Right = 884
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 13
         Width = 284
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'zzzq_Reporting_sub_with_Plan_Mkt_Cd_for_Tableau'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'zzzq_Reporting_sub_with_Plan_Mkt_Cd_for_Tableau'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "tbl_Tableau_Chunk_Geographic (dbo)"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 135
               Right = 267
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 9
         Width = 284
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 12
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'zzzqry_lookup_geo_for_Tableau'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'zzzqry_lookup_geo_for_Tableau'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 9
         Width = 284
         Width = 2745
         Width = 4740
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'zzzqry_Tableau_lobseg_xlat'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'zzzqry_Tableau_lobseg_xlat'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "append_t_reporting (dbo)"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 135
               Right = 208
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 9
         Width = 284
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'zzzt_reporting'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'zzzt_reporting'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "t_membership (dbo)"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 135
               Right = 224
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 9
         Width = 284
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 12
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'zzzt_targets_membership'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'zzzt_targets_membership'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 9
         Width = 284
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'zzzzget_SAI_data_for_Tableau_sub'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'zzzzget_SAI_data_for_Tableau_sub'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "q_Reporting_sub_with_Plan_Mkt_Cd_for_Tableau (dbo)"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 135
               Right = 243
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "qry_lku_business_unit (dbo)"
            Begin Extent = 
               Top = 6
               Left = 281
               Bottom = 235
               Right = 523
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 12
         Width = 284
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 12
         Column = 6240
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'zzzzpull_Dollars_data_for_Tableau'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'zzzzpull_Dollars_data_for_Tableau'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[36] 4[24] 2[21] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "q_membership_yr (dbo)"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 135
               Right = 208
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "t_targets_membership"
            Begin Extent = 
               Top = 6
               Left = 246
               Bottom = 67
               Right = 416
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 9
         Width = 284
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 4650
         Alias = 1965
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'zzzzq_membership_with_target'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'zzzzq_membership_with_target'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "lku_work_grp (dbo)"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 135
               Right = 379
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 9
         Width = 284
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 12
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'zzzzqry_lku_business_unit'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'zzzzqry_lku_business_unit'
GO
USE [master]
GO
ALTER DATABASE [SAIP001] SET  READ_WRITE 
GO
